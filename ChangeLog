2007-08-21  Russell Bryant <russell@digium.com>

	* Asterisk 1.4.11 released.

2007-08-21 18:42 +0000 [r80183]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Don't record SIP dialog history if it's not
	  turned on. Also, put an upper limit on how many history entires
	  will be stored for each SIP dialog. It is currently set to 50,
	  but can be increased if deemed necessary. (closes issue #10421,
	  closes issue #10418, patches suggested by jmoldenhauer, patches
	  updated by me) (Security implications documented in AST-2007-020)

2007-08-21 16:39 +0000 [r80166-80167]  Steve Murphy <murf@digium.com>

	* include/asterisk/alaw.h, include/asterisk/ulaw.h: ugh. removing
	  the diffs from ulaw.h and alaw.h for now; accidentally added them
	  in 80166

	* main/alaw.c, include/asterisk/alaw.h, include/asterisk/ulaw.h:
	  This patch solves problem 1 in 8126; it should not slow down the
	  alaw codec, but should prevent signal degradation via multiple
	  trips thru the codec. Fossil estimates the twice thru this codec
	  will prevent fax from working. 4-6 times thru would result
	  hearable, noticeable, voice degradation.

2007-08-21 15:22 +0000 [r80132]  Russell Bryant <russell@digium.com>

	* channels/chan_mgcp.c: Don't try to dereference the owner channel
	  when it may not exist (issue #10507, maxper)

2007-08-21 15:03 +0000 [r80130]  Jason Parker <jparker@digium.com>

	* configs/cdr.conf.sample: (issue #10510) Reported by: casper
	  Patches: cdr.conf.diff uploaded by casper (license 55) Fix a few
	  errors in sample cdr config file.

2007-08-20 21:57 +0000 [r80088]  Russell Bryant <russell@digium.com>

	* apps/app_queue.c: Fix the build of app_queue

2007-08-20 21:39 +0000 [r80049-80086]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: After a discussion on #asterisk-dev, it was
	  decided that this should be in 1.4 as well. (issue #10424,
	  reported and patched by irroot)

	* apps/app_queue.c: Found a pointless ternary if. member->dynamic
	  was set to 1 and has no opportunity to change between then and
	  this line, so "dynamic" will ALWAYS be output.

2007-08-20 16:08 +0000 [r80047]  Jason Parker <jparker@digium.com>

	* configs/extensions.conf.sample: (issue #10499) Reported by:
	  casper Patches: extensions.conf.sample.diff uploaded by casper
	  (license 55) Update CLI examples in extensions.conf.sample to
	  reflect command changes.

2007-08-20 15:34 +0000 [r80044]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Ukrainian language voicemail support.
	  (closes issue #10458, reported and patched by Oleh)

2007-08-20 02:42 +0000 [r79998]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c: Missing curly braces. Oops. (Reported by
	  snuffy via IRC)

2007-08-18 14:30 +0000 [r79947]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c: Don't allocate vmu for messagecount when we
	  could just use the stack instead (closes issue #10490) Also,
	  remove a useless (and leaky) SQLAllocHandle (closes issue #10480)

2007-08-17 21:01 +0000 [r79912]  Russell Bryant <russell@digium.com>

	* channels/chan_zap.c: Avoid a crash in the handling of DTMF based
	  Caller ID. It is valid for ast_read to return NULL in the case
	  that the channel has been hung up. (crash reported by
	  anonymouz666 on IRC in #asterisk-dev)

2007-08-17 19:14 +0000 [r79906]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Patch allows for more seamless transition
	  from file storage voicemail to ODBC storage voicemail. If a
	  retrieval of a greeting from the database fails, but the file is
	  found on the file system, then we go ahead an insert the greeting
	  into the database. The result of this is that people who switch
	  from file storage to ODBC storage do not need to rerecord their
	  voicemail greetings.

2007-08-17 19:12 +0000 [r79902-79904]  Jason Parker <jparker@digium.com>

	* channels/chan_sip.c, main/utils.c, include/asterisk/strings.h:
	  Don't send a semicolon over the wire in sip notify messages.
	  Caused by fix for issue 9938. I basically took the code that
	  existed before 9938 was fixed, and copied it into a new function
	  - ast_unescape_semicolon There should be very few places this
	  will be needed (pbx_config does NOT need this (see issue 9938 for
	  details)) Issue 10430, patch by me, with help/ideas from murf
	  (thanks murf).

	* channels/chan_local.c: Re-add the setting of callerid name and
	  number. Issue 10485, reported by and fix explained by paradise.

2007-08-17 13:37 +0000 [r79857]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Fix some crashes in chan_sip. This patch
	  changes various places that add items to the scheduler to ensure
	  that they don't overwrite the ID of a previously scheduled item.
	  If there is one, it should be removed. (closes issue #10391,
	  closes issue #10256, probably others, patch by me)

2007-08-17 08:22 +0000 [r79833]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c: sometimes we don't need to signal dtmf
	  tones to asterisk, we just want them to go through as inband.
	  Otherwise they might be generated by the other channel partner
	  and then there is a double tone.

2007-08-16 22:32 +0000 [r79756-79792]  Russell Bryant <russell@digium.com>

	* res/res_musiconhold.c: Fix a little race condition that could
	  cause a crash if two channels had MOH stopped at the same time
	  that were using a class that had been marked for deletion when
	  its use count hits zero.

	* res/res_musiconhold.c: This patch fixes a bug where reloading the
	  module with "module reload" did not delete classes from memory
	  that were no longer in the config. This patch fixes that problem
	  as well as another one. Previously, if you reloaded MOH using the
	  "moh reload" CLI command, which behaved differently than "module
	  reload ...", MOH had to be stopped on every channel and started
	  again immediately. However, there was no way to tell what class
	  was being used, so they would all fall back to the default class.
	  (closes issue #10139) Reported by: blitzrage Patches:
	  asterisk-10139-advanced.diff.txt uploaded by jamesgolovich
	  (license 176) Tested by: jamesgolovich

	* channels/chan_iax2.c: Fix more deadlocks in chan_iax2 that were
	  introduced by making frame handling and scheduling
	  multi-threaded. Unfortunately, we have to do some expensive
	  deadlock avoidance when queueing frames on to the ast_channel
	  owner of the IAX2 pvt struct. This was already handled for
	  regular frames, but ast_queue_hangup and ast_queue_control were
	  still used directly. Making these changes introduced even more
	  places where the IAX2 pvt struct can disappear in the context of
	  a function holding its lock due to calling a function that has to
	  unlock/lock it to avoid deadlocks. I went through and fixed all
	  of these places to account for this possibility. (issue #10362,
	  patch by me)

2007-08-16 21:16 +0000 [r79690-79748]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_agent.c: Fixes a problem where agents would get
	  stuck busy due to their wrapuptime being longer than the queue's
	  wrapuptime and ringinuse=no for the queue. (closes issue #10215,
	  reported by Doug, repaired by me) Special thanks to fkasumovic
	  for pointing out the source of the problem and to bweschke for
	  helping to come up with a solution!

	* apps/app_voicemail.c: base_encode is not trying to open a log
	  file, so we should not call it a log file in the warning.
	  (related to issue #10452, reported by bcnit)

2007-08-16 09:37 +0000 [r79665]  Philippe Sultan <philippe.sultan@gmail.com>

	* res/res_jabber.c: A fix for two critical problems detected while
	  working with Daniel McKeehan in issue #10184. Upon priority
	  change, the resource list is not NULL terminated when moving an
	  item to the end of the list. This makes Asterisk endlessy loop
	  whenever it needs to read the list. Jids with different resource
	  and priority values, like in Gmail's and GoogleTalk's jabber
	  clients put that problem in evidence. Upon reception of a 'from'
	  attribute with an empty resource string, Asterisk crashes when
	  trying to access the found->cap pointer if the resource list for
	  the given buddy is not empty. This situation is perfectly valid
	  and must be handled. The Gizmoproject's jabber client put that
	  problem in evidence. Also added a few comments in the code as
	  well as a handle for the capabilities from Gmail's jabber client,
	  which are stored in a caps:c tag rather than the usual c tag.
	  Closes issue #10184.

2007-08-16 08:21 +0000 [r79642]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/ie.c: 0x80 + protocol is wrong for USERUSER when
	  we want to send IA5 Chars.

2007-08-15 14:40 +0000 [r79553]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: (closes issue #10440) Reported by: irroot (closes
	  issue #10454) Reported by: flo_turc Increase maximum timestamp
	  skew to 120. 20 was apparently far too low.

2007-08-15 14:26 +0000 [r79527]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Fixed an error in the Russian language
	  voicemail intro. (issue #10458, reported and patched by Oleh)

2007-08-15 14:18 +0000 [r79523]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: (closes issue #10456) Reported by: irroot
	  Patches: sip_timeout.patch uploaded by irroot (license 52) Change
	  hardcoded timer value to defined value. I'm doing this in 1.4 as
	  well so if it needs to be changed in the future this place would
	  not have been forgotten.

2007-08-14 18:49 +0000 [r79436-79470]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Fix another spot where an iax2_peer would
	  be leaked if realtime was in use.

	* channels/chan_iax2.c: Fix some memory leaks throughout chan_iax2
	  related to the use of realtime. I found these while working on
	  iax2_peer object reference tracking.

2007-08-14 15:27 +0000 [r79397]  Joshua Colp <jcolp@digium.com>

	* res/res_features.c: (closes issue #10415) Reported by: atis
	  Revert fix for #10327 as it causes more issues then it solves.

2007-08-13 22:40 +0000 [r79363]  Steve Murphy <murf@digium.com>

	* pbx/pbx_ael.c: memset really, really needs to be used here.

2007-08-13 21:57 +0000 [r79334]  Joshua Colp <jcolp@digium.com>

	* res/res_speech.c, apps/app_speech_utils.c,
	  include/asterisk/speech.h: Instead of accepting a single DTMF
	  character accept a full string.

2007-08-13 20:37 +0000 [r79272-79301]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Don't call find_peer in
	  registry_authrequest with the pvt lock held to avoid a deadlock.

	* channels/chan_iax2.c: Release the pvt lock before calling
	  find_peer in register_verify to avoid a deadlock. Also, remove
	  some unnecessary locking in auth_fail that was only done
	  recursively.

	* channels/chan_iax2.c: Don't call find_peer within update_registry
	  with a pvt lock held. This can cause a deadlock as the code will
	  eventually call find_callno.

	* channels/chan_iax2.c: I am fighting deadlocks in chan_iax2. I
	  have tracked them down to a single core issue. You can not call
	  find_callno() while holding a pvt lock as this function has to
	  lock another (every) other pvt lock. Doing so can lead to a
	  classic deadlock. So, I am tracking down all of the code paths
	  where this can happen and fixing them. The fix I committed
	  earlier today was along the same theme. This patch fixes some
	  code down the path of authenticate_reply.

2007-08-13 17:49 +0000 [r79255]  Steve Murphy <murf@digium.com>

	* pbx/ael/ael-test/ref.ael-vtest21 (added),
	  pbx/ael/ael-test/ref.ael-test19,
	  pbx/ael/ael-test/ael-vtest21/extensions.ael (added),
	  pbx/ael/ael-test/ael-vtest21 (added),
	  pbx/ael/ael-test/ref.ael-vtest17,
	  pbx/ael/ael-test/ref.ael-ntest10, pbx/ael/ael-test/ref.ael-test1,
	  pbx/ael/ael-test/ref.ael-test11, pbx/pbx_ael.c,
	  pbx/ael/ael-test/ref.ael-test14, utils/ael_main.c: This patch
	  fixes bug 10411. I added a new regression test, some regression
	  test cleanups

2007-08-13 15:28 +0000 [r79214]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Fix a potential deadlock in socket_process.
	  check_provisioning can eventually call find_callno. You can't
	  hold a pvt lock while calling find_callno because it goes through
	  and locks every single one looking for a match.

2007-08-13 14:51 +0000 [r79174-79207]  Joshua Colp <jcolp@digium.com>

	* res/res_speech.c, apps/app_speech_utils.c,
	  include/asterisk/speech.h: Add an API call to allow the engine to
	  know that DTMF was received.

	* channels/chan_oss.c, channels/chan_mgcp.c, channels/chan_phone.c,
	  channels/chan_local.c, channels/chan_misdn.c,
	  channels/chan_zap.c, channels/chan_sip.c, channels/chan_skinny.c,
	  channels/chan_h323.c, channels/chan_gtalk.c,
	  channels/chan_iax2.c: (closes issue #10437) Reported by: haklin
	  Don't set the callerid name and number a second time on a newly
	  created channel. ast_channel_alloc itself already sets it and
	  setting it twice would cause a memory leak.

2007-08-11 05:23 +0000 [r79142]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* res/res_odbc.c: Ensure the connection gets marked as used at
	  allocation time (closes issue #10429, report and fix by
	  mnicholson)

2007-08-10 20:53 +0000 [r79044-79099]  Steve Murphy <murf@digium.com>

	* main/channel.c, pbx/pbx_spool.c, include/asterisk/channel.h: From
	  a user complaint on #asterisk, I have forced pbx_spool to explain
	  what reason codes mean, when they are logged

	* main/cdr.c: Re bug behavior mentioned in #asterisk, made this
	  tweak to code, to prevent hundreds of log messages from being
	  generated

	* main/cdr.c: This will help debug; from a question asked on
	  #asterisk

2007-08-10  Russell Bryant <russell@digium.com>

	* Asterisk 1.4.10.1 released.
	
2007-08-10 15:20 +0000 [r78995]  Russell Bryant <russell@digium.com>

	* include/asterisk/lock.h: The last set of changes that I made to
	  "core show locks" made it not able to track mutexes unless they
	  were declared using AST_MUTEX_DEFINE_STATIC. Locks initialized
	  with ast_mutex_init() were not tracked. It should work now.

2007-08-10 14:15 +0000 [r78951-78955]  Joshua Colp <jcolp@digium.com>

	* main/file.c: Don't bother having the core pass through or emulate
	  begin DTMF frames when in an ast_waitstream. It only cares about
	  the end of DTMF.

	* configs/queues.conf.sample: (closes issue #10422) Reported by:
	  bhowell Add note to sample configuration about module load order
	  and how it can cause perfectly good queue members to be marked as
	  invalid.

2007-08-10 13:24 +0000 [r78936]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c, channels/misdn/ie.c,
	  channels/misdn/isdn_msg_parser.c: fixed a bug with the useruser
	  information element. We send them now also in the disconnect
	  message.

2007-08-09 23:47 +0000 [r78907]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Improved a bit of logic regarding
	  comma-separated mailboxes in has_voicemail. Also added some
	  braces to some compound if statements since unbraced if
	  statements scare me in general.

2007-08-09 23:10 +0000 [r78891]  Steve Murphy <murf@digium.com>

	* Makefile: This fixes bug 10416; thanks to mvanbaak for the pretty
	  output

2007-08-09 22:03 +0000 [r78826-78860]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Removing some extra debug code I left in my
	  last commit

	* apps/app_voicemail.c: Quite a few changes regarding IMAP storage.
	  1. instead of using inboxcount as the core message counting
	  function, we use messagecount instead. This makes it possible to
	  count messages in folders besides just INBOX and Old. 2.
	  inboxcount and hasvoicemail now use messagecount as their means
	  of determining return values. 3. Added a copy_message function
	  for IMAP storage. Unfortunately I don't have the means to test
	  it, but it seems like a pretty straightforward function. 4.
	  Removed a #ifndef IMAP_STORAGE and matching #endif from
	  leave_voicemail for a couple of reasons. One, we want to support
	  copying mail to multiple IMAP boxes, and two, IMAP was broken
	  because a STORE macro had been moved into this section of code.

	* channels/chan_sip.c: I broke canreinvite...Now I'm fixing it. I
	  put some new code in the wrong place and so I've reverted the
	  canreinvite section to how it was and put my new code where it
	  should be.

2007-08-09 17:58 +0000 [r78717-78778]  Russell Bryant <russell@digium.com>

	* apps/app_voicemail.c: add a comment to indicate that inboxcount
	  for ODBC_STORAGE needs to be fixed to support multiple mailboxes

	* apps/app_voicemail.c: Fix subscriptions to multiple mailboxes for
	  ODBC_STORAGE. Also, leave a comment for this to be fixed for
	  IMAP_STORAGE, as well. I left IMAP alone since I know MarkM was
	  working on this code right now for another reason. This is broken
	  even worse in trunk, but for a different reason. The fact that
	  the mailbox option supported multiple mailboxes is completely not
	  obvious from the code in the channel drivers. Anyway, I will fix
	  that in another commit ...

	* apps/app_meetme.c: Fix a problem with the combination of the 'F'
	  option to pass DTMF through a conference and options that use
	  DTMF to activate various features. The problem was that the BEGIN
	  frame would be passed through, but the END frame would get
	  intercepted to activate a feature. Then, the other conference
	  members would hear DTMF for forever, which they didn't seem to
	  like very much. (closes issue #10400, reported by stevefeinstein,
	  fixed by me)

2007-08-08 19:29 +0000 [r78646]  Jason Parker <jparker@digium.com>

	* doc/jabber.txt: Fix mogs email address.

2007-08-08 18:16 +0000 [r78575-78620]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Fixed some compiler warnings so that
	  compiling with dev-mode and IMAP storage would not have any
	  errors. This section of code may get changed again shortly since
	  my change uncovers a rather silly bit of logic.

	* apps/app_queue.c: Changing a bit of logic so that someone will
	  NEVER exit the queue on timeout unless they have enabled the 'n'
	  option. This commit relates to issue #10320. Thanks to
	  jfitzgibbon for detailing the idea behind this code change.

2007-08-08 13:51 +0000 [r78569]  Joshua Colp <jcolp@digium.com>

	* configs/sip.conf.sample: (closes issue #10335) Reported by:
	  adamgundy Update sip.conf to include another scenario where
	  directrtpsetup will fail.

2007-08-07  Russell Bryant <russell@digium.com>

	* Asterisk 1.4.10 released.
	
2007-08-07 20:57 +0000 [r78488]  Russell Bryant <russell@digium.com>

	* res/res_config_odbc.c: Fix the build of this module on 64-bit
	  platforms

2007-08-07 19:43 +0000 [r78450]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: The logic behind inboxcount's return value
	  was reversed in has_voicemail and message_count. (closes issue
	  #10401, reported by st1710, patched by me)

2007-08-07 19:34 +0000 [r78437]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* res/res_odbc.c: Don't free the environment handle when the
	  connection fails, because other connections might be depending
	  upon it

2007-08-07 19:11 +0000 [r78416]  Jason Parker <jparker@digium.com>

	* channels/chan_sip.c: Allow chan_sip to build in devmode

2007-08-07 19:09 +0000 [r78415]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c, res/res_config_odbc.c,
	  apps/app_directory.c: Reconnection doesn't happen automatically
	  when a DB goes down (fixes issue #9389)

2007-08-07 18:25 +0000 [r78375]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Properly check the capabilities count to
	  avoid a segfault. (ASA-2007-019)

2007-08-07 17:45 +0000 [r78371]  Russell Bryant <russell@digium.com>

	* channels/chan_zap.c, /: Merged revisions 78370 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r78370 | russell | 2007-08-07 12:44:04 -0500 (Tue, 07 Aug 2007) |
	  4 lines Revert patch committed for issue #9660. It broke E&M
	  trunks. (closes issue #10360) (closes issue #10364) ........

2007-08-06 21:41 +0000 [r78275]  Joshua Colp <jcolp@digium.com>

	* main/channel.c: Add additional DTMF log messages to help when
	  debugging issues.

2007-08-06 20:44 +0000 [r78184-78242]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Fix an issue where dynamic threads can get
	  free'd, but still exist in the dynamic thread list. (closes issue
	  #10392, patch from Mihai, with credit to his colleague, Pete)

	* include/asterisk/linkedlists.h: Fix the return value of
	  AST_LIST_REMOVE(). This shouldn't be causing any problems,
	  though, because the only code that uses the return value only
	  checks to see if it is NULL. (closes issue #10390, pointed out by
	  mihai)

2007-08-06 16:32 +0000 [r78182]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: It is possible for a transfer to occur
	  before the remote device has our tag in which case they send none
	  in the transfer. In this case we need to not fail the transfer
	  dialog lookup.

2007-08-06 16:30 +0000 [r78180]  Jason Parker <jparker@digium.com>

	* main/config.c: Fix an issue with using UpdateConfig (manager
	  action) where escaped semicolons in a config would be converted
	  to just semicolons (\; to ;) Issue 9938

2007-08-06 15:27 +0000 [r78166-78172]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: (closes issue #10355) Reported by: wdecarne Now that
	  we pass through RTP timestamp information we need to make the
	  allowed timestamp skew considerably less. There are situations
	  where a source may change and due to the timestamp difference the
	  receiver will experience an audio gap since we did not indicate
	  by setting the marker bit that the source changed.

	* configure, configure.ac: (closes issue #10383) Reported by: rizzo
	  Include stdlib.h so NULL gets defined for gethostbyname_r checks.

2007-08-06 13:33 +0000 [r78164]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: Fixed a mistake I made in realtime_peer
	  which caused it to return NULL every time. Thanks to Jon Fealy
	  for emailing me the correction.

2007-08-05 14:18 +0000 [r78146]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* cdr/cdr_pgsql.c: Portability fix for devmode compiling (closes
	  bug #10382)

2007-08-05 04:15 +0000 [r78143]  Russell Bryant <russell@digium.com>

	* include/asterisk/lock.h: Fix compilation failure when
	  MALLOC_DEBUG is enabled, but DEBUG_THREADS is not

2007-08-05 03:29 +0000 [r78139]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* channels/chan_sip.c: If peer is not found, the error message is
	  misleading (should be peer not found, not ACL failure)

2007-08-03 20:25 +0000 [r78103]  Mark Michelson <mmichelson@digium.com>

	* main/config.c, channels/chan_sip.c, include/asterisk/config.h:
	  Changed the behavior of sip's realtime_peer function to match the
	  corresponding way of matching for non-realtime peers. Now matches
	  are made on both the IP address and port number, or if the
	  insecure setting is set to "port" then just match on the IP
	  address. In order to accomplish this, I also added a new API
	  call, ast_category_root, which returns the first variable of an
	  ast_category struct

2007-08-03 20:14 +0000 [r78028-78101]  Russell Bryant <russell@digium.com>

	* apps/app_voicemail.c: (closes issue #10194) Reported by:
	  blitzrage Patches: bug0010194 uploaded by vovochka Tested by:
	  blitzrage Fix a problem when you call Voicemail() with multiple
	  mailboxes specified and ODBC_STORAGE is in use. The audio part of
	  the message was only given to the first mailbox specified.

	* main/utils.c, include/asterisk/lock.h, main/astmm.c: Add some
	  improvements to lock debugging. These changes take effect with
	  DEBUG_THREADS enabled and provide the following: * This will keep
	  track of which locks are held by which thread as well as which
	  lock a thread is waiting for in a thread-local data structure. A
	  reference to this structure is available on the stack in the
	  dummy_start() function, which is the common entry point for all
	  threads. This information can be easily retrieved using gdb if
	  you switch to the dummy_start() stack frame of any thread and
	  print the contents of the lock_info variable. * All of the
	  thread-local structures for keeping track of this lock
	  information are also stored in a list so that the information can
	  be dumped to the CLI using the "core show locks" CLI command.
	  This introduces a little bit of a performance hit as it requires
	  additional underlying locking operations inside of every
	  lock/unlock on an ast_mutex. However, the benefits of having this
	  information available at the CLI is huge, especially considering
	  this is only done in DEBUG_THREADS mode. It means that in most
	  cases where we debug deadlocks, we no longer have to request
	  access to the machine to analyze the contents of ast_mutex_t
	  structures. We can now just ask them to get the output of "core
	  show locks", which gives us all of the information we needed in
	  most cases. I also had to make some additional changes to astmm.c
	  to make this work when both MALLOC_DEBUG and DEBUG_THREADS are
	  enabled. I disabled tracking of one of the locks in astmm.c
	  because it gets used inside the replacement memory allocation
	  routines, and the lock tracking code allocates memory. This
	  caused infinite recursion.

	* channels/chan_iax2.c: Only pass through HOLD and UNHOLD control
	  frames when the mohinterpret option is set to "passthrough". This
	  was pointed out by Kevin in the middle of a training session.

	* channels/chan_iax2.c: Don't reuse the timespec that was set to 0
	  in the previous timedwait as it will just return immediately.
	  Also, fix some logic so the thread's lock isn't unlocked twice in
	  the weird case of dynamic threads getting acquired right after a
	  timeout. (pointed out by SteveK)

2007-08-02 21:53 +0000 [r77993-77996]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c, configs/skinny.conf.sample: Make sure we
	  actually allow 6 chars to be sent. Also make note of the "A"
	  option of date format. Issue 9779, modifications by DEA, wedhorn,
	  and myself.

	* channels/chan_skinny.c: If a device disconnects, the session will
	  go away. If this happens during call setup, we need to give up.
	  Issue 10325.

2007-08-02 19:25 +0000 [r77949]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Fix the case where a dynamic thread times
	  out waiting for something to do during the first time it runs.
	  This shouldn't ever happen, but we should account for it anyway.
	  (pointed out by pete, who works with mihai)

2007-08-02 18:42 +0000 [r77947]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Make sure we clear the prompt status
	  message on a hangup. Also rearrange messages to better fit with
	  what a wireshark trace shows it should be. Issue 10299, initial
	  patch and solution by sbisker, modified by me to fit with
	  wireshark trace.

2007-08-02 18:21 +0000 [r77945]  Steve Murphy <murf@digium.com>

	* main/fskmodem.c, /: Merged revisions 77942 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r77942 | murf | 2007-08-02 11:56:37 -0600 (Thu, 02 Aug 2007) | 1
	  line This patch hopefully solves 10141; The user is running with
	  it, and it doesn't appear to harm asterisk's operation, and may
	  prevent a crash. I'll store it in 1.2, as we have shut down
	  support on 1.2, but since I developed the patch before support
	  finished, and it might affect 1.4 and trunk, I'm going ahead with
	  it. ........

2007-08-02 18:04 +0000 [r77939-77943]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Fix another race condition in the handling
	  of dynamic threads. If the dynamic thread timed out waiting for
	  something to do, but was acquired to perform an action
	  immediately afterwords, then wait on the condition again to give
	  the other thread a chance to finish setting up the data for what
	  action this thread should perform. Otherwise, if it immediately
	  continues, it will perform the wrong action. (reported on IRC by
	  mihai, patch by me) (related to issue #10289)

	* channels/chan_iax2.c: Add another sanity check to
	  vnak_retransmit(). This check ensures that frames that have
	  already been marked for deletion don't get retransmitted. (closes
	  issue #10361, patch from mihai)

2007-08-02 15:15 +0000 [r77890-77894]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Make sure that we show the correct
	  extension if dialed from a macro "From: 5555" rather than "From:
	  s" Issue 10358, initial patch by DEA, reworked by me to use S_OR,
	  tested by sbisker

	* channels/chan_skinny.c: Put in some additional debug information
	  for softkey/stimulus messages. Issue 10291, patch by DEA.

2007-08-01 22:16 +0000 [r77887]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Fix some race conditions which have been
	  causing weird problems in chan_iax2. The most notable problem is
	  that people have been seeing storms of VNAK frames being sent due
	  to really old frames mysteriously being in the retransmission
	  queue and never getting removed. It was possible that a dynamic
	  thread got created, but did not acquire its lock before the
	  thread that created it signals it to perform an action. When this
	  happens, the thread will sleep until it hits a timeout, and then
	  get destroyed. So, the action never gets performed and in some
	  cases, means a frame doesn't get transmitted and never gets freed
	  since the scheduler never gets a chance to reschedule
	  transmission. Another less severe race condition is in the
	  handling of a timeout for a dynamic thread. It was possible for
	  it to be acquired to perform at action at the same time that it
	  hit a timeout. When this occurs, whatever action it was acquired
	  for would never get performed. (patch contributed by Mihai and
	  SteveK) (closes issue #10289) (closes issue #10248) (closes issue
	  #10232) (possibly related to issue #10359)

2007-08-01 22:14 +0000 [r77886]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c: Voicemail with ODBC_STORAGE defined does
	  not compile cleanly (missing def)

2007-08-01 21:08 +0000 [r77883]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Fix an issue that caused one-way audio on
	  some newer devices (specifically the 7921), due to sending
	  packets in the wrong order during hangup. Also make sure we clear
	  tones/messages on the correct line/instance. Issue 10291, patch
	  by DEA, tested by sbisker and myself.

2007-08-01 18:08 +0000 [r77863-77871]  Joshua Colp <jcolp@digium.com>

	* main/cli.c: (closes issue #10351) Reported by: ftarz Some
	  platforms don't like it when you pass NULL to vsnprintf so pass
	  "" instead.

	* include/asterisk/threadstorage.h, channels/chan_mgcp.c,
	  apps/app_voicemail.c, main/acl.c, utils/smsq.c,
	  channels/chan_iax2.c: Add some fixes for building on Solaris.

	* main/utils.c: Whoops, I meant R_5 not R5.

	* configure, configure.ac: And for my last trick... make sure that
	  if gethostbyname_r is exported by a library that it is used.

	* configure, include/asterisk/autoconfig.h.in, configure.ac,
	  main/utils.c: Extend autoconf logic to determine which version of
	  gethostbyname_r is on the system.

2007-08-01 14:08 +0000 [r77852-77854]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Fixes an issue I introduced to queues wherein a
	  queue with joinempty=yes would kick people out of the queue
	  because of erroneously thinking the 'n' option was in use.
	  (closes issue #10320, reported by jfitzgibbon, patched by me,
	  tested by blitzrage and me) Thank you blitzrage for all the
	  testing you've done lately with queues! It's much appreciated!

	* apps/app_queue.c: If a queue uses dynamic realtime members, then
	  the member list should be updated after each attempt to call the
	  queue. This fixes an issue where if a caller calls into a queue
	  where no one is logged in, they would wait forever even if a
	  member logged in at some point. (closes issue #10346, reported by
	  and tested by blitzrage, patched by me)

2007-07-31 21:09 +0000 [r77845-77846]  Jim Dixon <telesistant@hotmail.com>

	* apps/app_rpt.c: Much newer version, 0.70 with much additions

	* main/dsp.c, channels/chan_zap.c: Made VAST improvements in DTMF
	  receiver in RADIO_RELAX mode (thanx Steve W9SH), and oversight in
	  logic in TONE_VERIFY/RELAX mode in chan_zap.

2007-07-31 20:59 +0000 [r77844]  Steve Murphy <murf@digium.com>

	* /, contrib/scripts/ast_grab_core: Merged revisions 77842 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r77842 | murf | 2007-07-31 13:19:35 -0600 (Tue, 31 Jul 2007) | 1
	  line This probably isn't super-general, but it's a first stab at
	  using kill -11 to generate a core file instead of gcore. ........

2007-07-31 16:17 +0000 [r77831]  Joshua Colp <jcolp@digium.com>

	* res/res_speech.c, include/asterisk/speech.h: Add a flag to the
	  speech API that allows an engine to set whether it received
	  results or not.

2007-07-31 15:53 +0000 [r77827]  Kevin P. Fleming <kpfleming@digium.com>

	* build_tools/cflags.xml: DETECT_DEADLOCKS can't be enabled without
	  DEBUG_THREADS or it does nothing

2007-07-31 15:21 +0000 [r77824]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: This patch makes Asterisk send 100 Trying
	  provisional responses upon receipt of re-invites. This makes it
	  so that if there are two or more Asterisk servers between
	  endpoints, the Asterisk servers will not keep retransmitting the
	  re-invites. (closes issue #10274, reported by cstadlmann, patched
	  by me with approval from file)

2007-07-30 20:17 +0000 [r77795]  Jason Parker <jparker@digium.com>

	* main/say.c: Applications like SayAlpha() should not hang up the
	  channel if you request an "unknown" character such as a comma.
	  Instead, skip the character and move on. Issue 10083, initial
	  patch by jsmith, modified by me.

2007-07-30 20:16 +0000 [r77785-77794]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Fix an issue that could potentially cause
	  corruption of the global iax frame queue. In the network_thread()
	  loop, it traverses the list using the AST_LIST_TRAVERSE_SAFE
	  macro. However, to remove an element of the list within this
	  loop, it used AST_LIST_REMOVE, instead of
	  AST_LIST_REMOVE_CURRENT, which I believe could leave some of the
	  internal variables of the SAFE macro invalid. Mihai says that he
	  already made this change in his local copy and it didn't help his
	  VNAK storm issues, but I still think it's wrong. :)

	* res/res_agi.c: (closes issue #10279) Reported by: seanbright
	  Patches: res_agi.carefulwrite.1.4.07252007.patch uploaded by
	  seanbright (license 71) res_agi.carefulwrite.trunk.07252007.patch
	  uploaded by seanbright (license 71) Allow the "agi_network: yes"
	  line to be printed out in the AGI debug output. Also, allow
	  partial writes to be handled when writing out this line just like
	  it is for all of the others.

	* main/channel.c: file and I both committed changes for issue
	  #10301. Remove a duplicated assignment to restore the original
	  value of the previous channel.

2007-07-30 18:43 +0000 [r77783]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, res/res_agi.c: Merged revisions 77782 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r77782 | tilghman | 2007-07-30 13:40:54 -0500 (Mon, 30 Jul 2007)
	  | 2 lines Revert change in revision 71656, even though it fixed a
	  bug, because many people were depending upon the (broken)
	  behavior. ........

2007-07-30 17:29 +0000 [r77780]  Russell Bryant <russell@digium.com>

	* main/channel.c: (closes issue #10301) Reported by: fnordian
	  Patches: asterisk-1.4.9-channel.c.patch uploaded by fnordian
	  (license 110) Additional changes by me Fix some problems in
	  channel_find_locked() which can cause an infinite loop. The
	  reference to the previous channel is set to NULL in some cases.
	  These changes ensure that the reference to the previous channel
	  gets restored before needing it again. I'm not convinced that the
	  code that is setting it to NULL is really the right thing to do.
	  However, I am making these changes to fix the obvious problem and
	  just leaving an XXX comment that it needs a better explanation
	  that what is there now.

2007-07-30 17:11 +0000 [r77768-77778]  Joshua Colp <jcolp@digium.com>

	* res/res_features.c: (closes issue #10327) Reported by: kkiely
	  Instead of directly mucking with the extension/context/priority
	  of the channel we are transferring when it has a PBX simply call
	  ast_async_goto on it. This will ensure that the channel gets
	  handled properly and sent to the right place.

	* main/channel.c: (closes issue #10301) Reported by: fnordian
	  Patches: asterisk-1.4.9-channel.c.patch uploaded by fnordian
	  (license 110) Restore previous behavior where if we failed to
	  lock the channel we wanted we would return to exactly the same
	  point as if we had just reentered the function.

	* /, apps/app_macro.c: Merged revisions 77767 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r77767 | file | 2007-07-30 11:50:02 -0300 (Mon, 30 Jul 2007) | 4
	  lines (closes issue #10334) Reported by: ramonpeek Pass through
	  the return value from macro_exec through the MacroIf application.
	  ........

2007-07-27 18:15 +0000 [r77571]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* res/res_odbc.c: Missing newline

2007-07-27 17:04 +0000 [r77536-77540]  Joshua Colp <jcolp@digium.com>

	* cdr/cdr_pgsql.c: (closes issue #10310) Reported by: prashant_jois
	  Patches: cdr_pgsql.patch uploaded by prashant (license 114)
	  Finish the Postgresql connection after the log messages are
	  printed so we don't access invalid memory.

	* channels/chan_sip.c: (closes issue #10323) Reported by: julianjm
	  Patches: chan_sip_device_state_hold_fix.v1.diff.txt uploaded by
	  julianjm (license 99) Clear ONHOLD flag when decrementing the
	  onHold peer count. If we did not do this the count may keep
	  decreasing.

2007-07-27 14:30 +0000 [r77490]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_sip.c: "re-invite" was misspelled

2007-07-26 23:19 +0000 [r77460]  Joshua Colp <jcolp@digium.com>

	* main/channel.c: (closes issue #10302) Reported by: litnialex If a
	  DTMF end frame comes from a channel without a begin and it is
	  going to a technology that only accepts end frames (aka INFO)
	  then use the minimum DTMF duration if one is not in the frame
	  already.

2007-07-26 22:16 +0000 [r77424-77429]  Kevin P. Fleming <kpfleming@digium.com>

	* doc/mp3.txt: change protocol for downloads as well

	* doc/mp3.txt, sounds/Makefile: use new canonical name for download
	  server

2007-07-26 21:23 +0000 [r77410]  Russell Bryant <russell@digium.com>

	* Makefile, build_tools/make_buildopts_h: AST_DEVMODE was defined
	  in trunk, but not in 1.4. When Asterisk is compiled under dev
	  mode, AST_DEVMODE will get defined in buildopts.h. Change 1.4 to
	  define it in the same way that trunk does. Also, revert the
	  change that added this define in the Makefile The advantage to
	  doing it this way is that buildopts.h gets installed when you
	  install Asterisk. Then, when building any out of tree modules, or
	  building asterisk-addons, these modules know which options the
	  rest of Asterisk was built with.

2007-07-26 20:35 +0000 [r77380]  Mark Michelson <mmichelson@digium.com>

	* Makefile, main/logger.c: Fixes to get ast_backtrace working
	  properly. The AST_DEVMODE macro was never defined so the majority
	  of ast_backtrace never attempted compilation. The makefile now
	  defines AST_DEVMODE if configure was run with --enable-dev-mode.
	  Also, changes were made to acccomodate 64 bit systems in
	  ast_backtrace. Thanks to qwell, kpfleming, and Corydon76 for
	  their roles in allowing me to get this committed

2007-07-26 19:32 +0000 [r77348-77350]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/logger.c: Missed one

	* main/logger.c: Oops, that builtin define should be all-lowercase.

2007-07-26 18:30 +0000 [r77318]  Mark Michelson <mmichelson@digium.com>

	* cdr/cdr_pgsql.c: Two consecutive calls to PQfinish could occur,
	  meaning free gets called on the same variable twice. This patch
	  sets the connection to NULL after calls to PQfinish so that the
	  problem does not occur. Also in this patch, prashant_jois
	  informed me that it is safe to pass a null pointer to PQfinish,
	  so I have removed the check for conn's existence from
	  my_unload_module. (closes issue 10295, reported by junky, patched
	  by me with input from prashant_jois)

2007-07-25 22:39 +0000 [r77191]  Steve Murphy <murf@digium.com>

	* apps/app_meetme.c: This fix solves problem with intense squelch
	  noise when someone joins conf in bug 9430; We repro'd the problem
	  with meetme opts of 'CciMo'; Josh Colp supplied this patch, and
	  I'm applying it. It looks like playing the recorded username will
	  louse up the next thing played into the channel. Josh rearranged
	  the code so as to start things over before playing data directly
	  into the conference.

2007-07-25 22:16 +0000 [r77176]  Joshua Colp <jcolp@digium.com>

	* apps/app_speech_utils.c: (closes issue #10303) Reported by: jtodd
	  Add SPEECH_DTMF_TERMINATOR variable so the user can specify the
	  digit to terminate a DTMF string with. If none is specified then
	  no terminator will be used.

2007-07-25 21:52 +0000 [r77154]  Mark Michelson <mmichelson@digium.com>

	* main/channel.c: chan->emulate_dtmf_duration is an unsigned int,
	  not a signed int, so use %u instead of %d in the format string

2007-07-25 20:23 +0000 [r77116-77136]  Jason Parker <jparker@digium.com>

	* /: so are my fingers...

	* /: autotagexternals script is still obviously misbehaving...

	* /: use autotagged externals

2007-07-25 17:14 +0000 [r77071]  Joshua Colp <jcolp@digium.com>

	* configure, acinclude.m4: Fix autoconf logic for finding OpenH323
	  when it is not in the first place searched (/usr/share/openh323).

2007-07-25 09:34 +0000 [r77022]  Luigi Rizzo <rizzo@icir.org>

	* main/rtp.c: set the sequence number in a frame for all frame
	  types

2007-07-25 00:18 +0000 [r76983]  Steve Murphy <murf@digium.com>

	* channels/chan_zap.c, /: Merged revisions 76978 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r76978 | murf | 2007-07-24 18:07:24 -0600 (Tue, 24 Jul 2007) | 1
	  line this fixes bug 10293, where the error message because
	  defaultzone or loadzone was not defined was confusing ........

2007-07-24 22:12 +0000 [r76891-76937]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, include/asterisk/lock.h: Merged revisions 76934 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r76934 | tilghman | 2007-07-24 17:11:33 -0500 (Tue, 24
	  Jul 2007) | 2 lines Oops, res contains the error code, not errno.
	  I was wondering why a mutex was reporting "No such file or
	  directory"... ........

	* main/app.c: Found another place where we should be using the
	  umask (thanks jcmoore)

2007-07-24  Jason Parker <jparker@digium.com>

	* Asterisk 1.4.9 released.

2007-07-24 16:42 +0000 [r76803-76805]  Jason Parker <jparker@digium.com>

	* /: Blocked revisions 76802 via svnmerge ........ r76802 | qwell |
	  2007-07-24 11:32:04 -0500 (Tue, 24 Jul 2007) | 3 lines Don't
	  create the Asterisk channel until we are starting the PBX on it.
	  (ASA-2007-018) ........

	* channels/chan_iax2.c: Don't create the Asterisk channel until we
	  are starting the PBX on it. (ASA-2007-018)

2007-07-24 16:26 +0000 [r76801]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Added a membercount variable to call_queue
	  struct which keeps track of the number of logged in members in a
	  particular queue. This makes it so that the 'n' option for
	  Queue() can act properly depending on which strategy is used. If
	  the strategy is roundrobin, rrmemory, or ringall, we want to ring
	  each phone once before moving on in the dialplan. However, if any
	  other strategy is used, we will only ring one phone since it
	  cannot be guaranteed that a different phone will ring on
	  subsequent attempts to ring a phone. As a side effect of this,
	  the QUEUE_MEMBER_COUNT dialplan function now just reads the
	  membercount variable instead of traversing through the member
	  list to figure out how many members there are. Special thanks to
	  blitzrage for helping to test this out. (closes issue #10127,
	  reported by bcnit, patched by me, tested by blitzrage)

2007-07-23 22:38 +0000 [r76708]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c: It was our stated intention for 1.4 that
	  files created in app_voicemail should depend upon the umask.
	  Unfortunately, mkstemp() creates files with mode 0600, regardless
	  of the umask. This corrects that deficiency.

2007-07-23 18:59 +0000 [r76656]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Fix some incorrect softkey labels in
	  messages. Don't try to play dialtone in some unimplemented
	  features.

2007-07-23 18:29 +0000 [r76654]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_agent.c: Merged revisions 76653 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r76653 | file | 2007-07-23 15:28:13 -0300 (Mon, 23 Jul
	  2007) | 4 lines (closes issue #5866) Reported by: tyler Do not
	  force channel format changes when a generator is present. The
	  generator may have changed the formats itself and changing them
	  back would cause issues. ........

2007-07-23 17:57 +0000 [r76620]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Don't try to queue up hold/unhold frames
	  on a non-existent channel. Issue 10276.

2007-07-23 17:48 +0000 [r76519-76618]  Joshua Colp <jcolp@digium.com>

	* apps/app_morsecode.c: Allow app_morsecode to build on PPC Linux
	  by putting the value of the digit char in an int.

	* /, channels/chan_sip.c: Merged revisions 76560 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r76560 | file | 2007-07-23 11:32:07 -0300 (Mon, 23 Jul 2007) | 6
	  lines (closes issue #10236) Reported by: homesick Patches:
	  rpid_1.4_75840.patch uploaded by homesick (license 91) Accept
	  Remote Party ID on guest calls. ........

	* channels/chan_skinny.c: (closes issue #10268) Reported by:
	  mvanbaak Patches: chan_skinny_openbsd.diff uploaded by mvanbaak
	  (license 7) Add another OS that has to use the Macros for byte
	  ordering.

2007-07-23 12:25 +0000 [r76485]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Use a signed integer for storing the number
	  of bytes in the packet read from the network. Using an unsigned
	  value here made it impossible to handle an error returned from
	  recvfrom(). Furthermore, in the case that recvfrom() did return
	  an error, this would cause a crash due to a heap overflow.
	  (closes issue #10265, reported by and fix suggested by
	  timrobbins)

2007-07-22 21:42 +0000 [r76410]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /: Blocked revisions 76409 via svnmerge ........ r76409 |
	  tilghman | 2007-07-22 16:39:55 -0500 (Sun, 22 Jul 2007) | 2 lines
	  We should not use C++ reserved words in API headers (closes issue
	  #10266) ........

2007-07-21 02:02 +0000 [r76227]  Russell Bryant <russell@digium.com>

	* /, channels/chan_sip.c: Merged revisions 76226 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r76226 | russell | 2007-07-20 21:01:46 -0500 (Fri, 20 Jul 2007) |
	  4 lines Backport a fix for a memory leak that was fixed in trunk
	  in reivision 76221 by rizzo. The memory used for the localaddr
	  list was not freed during a configuration reload. ........

2007-07-20 21:36 +0000 [r76211]  Steve Murphy <murf@digium.com>

	* sounds/Makefile: This patch from 10249 is worth applying! It
	  prevents downloading sound files if they are already downloaded.
	  Darn Practical, if you ask me

2007-07-20 21:03 +0000 [r76174-76178]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Allow getting a call from an existing
	  "sub" channel. Cancel ringing if endpoint hangs up before
	  answering. Fixes were backported from trunk (there was apparently
	  a bit of confusion during merge of a previous patch). (closes
	  issue #10241)

	* main/manager.c: Eliminate a compiler warning with gcc 4.2 by
	  constifying a char *

	* channels/chan_skinny.c: It's possible for sub->owner to be NULL
	  here if you cancel the call immediately after/during sending a
	  digit.

2007-07-20 18:42 +0000 [r76139]  Mark Michelson <mmichelson@digium.com>

	* apps/app_directory.c: When using users.conf for the entries in
	  the directory, if multiple users had the same last name, only the
	  first user listed would be available in the directory. (closes
	  issue #10200, reported by mrskippy, patched by me)

2007-07-20 18:22 +0000 [r76132]  Russell Bryant <russell@digium.com>

	* main/channel.c: Use the define that specifies the default length
	  of an artificially created DTMF digit in the ast_senddigit()
	  function. The define is set to 100ms by default, which is the
	  same thing that this function was using. But, using the define
	  lets changes take effect in this case, as well as the others
	  where it was already used.

2007-07-20 17:20 +0000 [r76054-76087]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 76080 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r76080 | file | 2007-07-20 14:16:48 -0300 (Fri, 20 Jul 2007) | 6
	  lines (closes issue #10247) Reported by: fkasumovic Patches:
	  chan_sip.patch uploaded by fkasumovic (license #101) Drop any
	  peer realm authentication entries when reloading so multiple
	  entries do not get added to the peer. ........

	* res/res_convert.c: (closes issue #10246) Reported by: fkasumovic
	  Patches: res_conver.patch uploaded by fkasumovic (license #101)
	  Use the last occurance of . to find the extension, not the first
	  occurance.

	* apps/app_queue.c: Move makeannouncement variable declaration to
	  proper place.

2007-07-19 20:36 +0000 [r75980]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Remove some duplicate code.

2007-07-19 18:59 +0000 [r75969-75978]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: The diff on this looks pretty big but all I did
	  was remove a pointless if statement (always evaluates true).

	* apps/app_queue.c: Changes in handling return values of several
	  functions in app_queue. This all started as a fix for issue
	  #10008 but now includes all of the following changes: 1.
	  Simplifying the code to handle positive return values from ast
	  API calls. 2. Removing the background_file function. 3. The fix
	  for issue #10008 (closes issue #10008, reported and patched by
	  dimas)

2007-07-19 15:53 +0000 [r75928]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 75927 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r75927 | russell | 2007-07-19 10:49:42 -0500 (Thu, 19 Jul 2007) |
	  6 lines When processing full frames, take sequence number
	  wraparound into account when deciding whether or not we need to
	  request retransmissions by sending a VNAK. This code could cause
	  VNAKs to be sent erroneously in some cases, and to not be sent in
	  other cases when it should have been. (closes issue #10237,
	  reported and patched by mihai) ........

2007-07-18 22:59 +0000 [r75807]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Need to make sure we set milliseconds and
	  timestamp - pointed out by the recent ast_ time stuff from
	  Tilghman

2007-07-18 21:09 +0000 [r75759]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 75757 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r75757 | russell | 2007-07-18 16:09:13 -0500 (Wed, 18 Jul 2007) |
	  5 lines When traversing the queue of frames for possible
	  retransmission after receiving a VNAK, handle sequence number
	  wraparound so that all frames that should be retransmitted
	  actually do get retransmitted. (issue #10227, reported and
	  patched by mihai) ........

2007-07-18 20:40 +0000 [r75749]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c, /: Merged revisions 75748 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r75748 | tilghman | 2007-07-18 15:31:36 -0500 (Wed, 18 Jul 2007)
	  | 2 lines Store prior to copy (closes issue #10193) ........

2007-07-18 20:17 +0000 [r75732]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Umm, why are we transmitting dialtone on
	  cfwdall?

2007-07-18 20:00 +0000 [r75712]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c, channels/chan_sip.c, channels/chan_agent.c,
	  pbx/pbx_realtime.c: Backport GCC 4.2 fixes. Without these
	  Asterisk won't build under devmode using GCC 4.2.

2007-07-18 19:54 +0000 [r75707-75711]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Fixes for 7935/7936 conference phones.
	  Issue 9245, patch by slimey.

	* channels/chan_skinny.c: Fix issues with new 79x1 phones. Issue
	  9887, patches by DEA

2007-07-18 17:56 +0000 [r75658]  Dwayne M. Hubbard <dhubbard@digium.com>

	* /, apps/app_queue.c: Merged revisions 75657 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r75657 | dhubbard | 2007-07-18 12:48:33 -0500 (Wed, 18 Jul 2007)
	  | 1 line removed the word 'pissed' from ast_log(...) function
	  call for BE-90 ........

2007-07-18 15:44 +0000 [r75583-75623]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Few more places that needs to check for
	  onhold state.

	* channels/chan_sip.c: (closes issue #10165) Reported by: elandivar
	  It is possible for hold status to exist without call limits set,
	  so we need to ensure update_call_counter is executed regardless.

	* channels/chan_h323.c: Don't bother reloading chan_h323 if it did
	  not load successfully in the first place. This would otherwise
	  cause a crash.

	* pbx/pbx_dundi.c: (closes issue #10224) Reported by: irroot Record
	  the threadid of each running thread before shutting them down as
	  the thread themselves may change the value.

2007-07-18 12:29 +0000 [r75529]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_meetme.c: Using a freed frame causes crashes (closes
	  issue #9317)

2007-07-17  Russell Bryant <russell@digium.com>

	* Asterisk 1.4.8 released.

2007-07-17 20:57 +0000 [r75441-75450]  Russell Bryant <russell@digium.com>

	* /, channels/chan_skinny.c: Merged revisions 75449 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r75449 | russell | 2007-07-17 15:57:09 -0500 (Tue, 17
	  Jul 2007) | 3 lines Properly check for the length in the skinny
	  packet to prevent an invalid memcpy. (ASA-2007-016) ........

	* main/rtp.c: cast arguments to ast_log so that it builds without
	  warnings for me

	* channels/iax2-parser.c, channels/iax2-parser.h, /,
	  channels/chan_iax2.c: Merged revisions 75444 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r75444 | russell | 2007-07-17 15:45:27 -0500 (Tue, 17 Jul 2007) |
	  5 lines Ensure that when encoding the contents of an ast_frame
	  into an iax_frame, that the size of the destination buffer is
	  known in the iax_frame so that code won't write past the end of
	  the allocated buffer when sending outgoing frames. (ASA-2007-014)
	  ........

	* /, channels/chan_iax2.c: Merged revisions 75440 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r75440 | russell | 2007-07-17 15:41:41 -0500 (Tue, 17 Jul 2007) |
	  4 lines After parsing information elements in IAX frames, set the
	  data length to zero, so that code later on does not think it has
	  data to copy. (ASA-2007-015) ........

2007-07-17 20:40 +0000 [r75439]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Ensure that the pointer to STUN data does not go to
	  unaccessible memory. (ASA-2007-017)

2007-07-17 20:33 +0000 [r75437]  Russell Bryant <russell@digium.com>

	* res/res_agi.c: (issue #10210) Reported by: juggie Patches:
	  10210-1.4-grr.patch uploaded by juggie (license #24) Tested by:
	  juggie, blitzrage Log a warning if someone uses DeadAGI on a live
	  channel.

2007-07-17 20:03 +0000 [r75405]  Mark Michelson <mmichelson@digium.com>

	* apps/app_dial.c: Fixing an error I made earlier. ast_fileexists
	  can return -1 on failure, so I need to be sure that we only enter
	  the if statement if it is successful. Related to my fix to issue
	  #10186

2007-07-17 20:01 +0000 [r75401-75403]  Russell Bryant <russell@digium.com>

	* main/pbx.c: (closes issue #10209) Reported by: juggie Patches:
	  10209-trunk-2.patch uploaded by juggie Tested by: juggie,
	  blitzrage In ast_pbx_run(), mark a channel as hung up after an
	  application returned -1, or when it runs out of extensions to
	  execute. This is so that code can detect that this channel has
	  been hung up for things like making sure DeadAGI is used on
	  actual dead channels, and is beneficial for other things, like
	  making sure someone doesn't try to start spying on a channel that
	  is about to go away.

	* res/res_agi.c: Remove a duplicated newline character in AGI debug
	  output. (closes issue #10207, patch by seanbright)

2007-07-16 20:53 +0000 [r75258-75306]  Kevin P. Fleming <kpfleming@digium.com>

	* main/dns.c, /: Merged revisions 75304 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r75304 | kpfleming | 2007-07-16 15:46:58 -0500 (Mon, 16 Jul 2007)
	  | 3 lines provide proper copyright/license attribution for this
	  structure that was copied from a BSD-licensed header file long,
	  long ago... ........

	* /: another fix that is not needed here (finishing up 75251)

2007-07-16 18:16 +0000 [r75253]  Mark Michelson <mmichelson@digium.com>

	* apps/app_dial.c: Restoring functionality from 1.2 wherein
	  Retrydial will not exit if there is no announce file specified.
	  This change makes it so that if there is no announce file
	  specified, the application will continue until finished (or
	  caller hangs up). If a bogus announce file is specified, then a
	  warning message will be printed saying that the file could not be
	  found, but execution will still continue. (closes issue #10186,
	  reported by jon, patched by me)

2007-07-16 18:12 +0000 [r75252]  Kevin P. Fleming <kpfleming@digium.com>

	* /: block change that is not relevant here

2007-07-13 20:36 +0000 [r75108]  Russell Bryant <russell@digium.com>

	* /, res/res_musiconhold.c: Merged revisions 75107 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r75107 | russell | 2007-07-13 15:35:22 -0500 (Fri, 13
	  Jul 2007) | 3 lines Fix a couple potential minor memory leaks.
	  load_moh_classes() could return without destroying the loaded
	  configuration. ........

2007-07-13 20:15 +0000 [r75078]  Mark Michelson <mmichelson@digium.com>

	* apps/app_chanspy.c, /: Merged revisions 75066 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r75066 | mmichelson | 2007-07-13 15:10:39 -0500 (Fri, 13 Jul
	  2007) | 5 lines Fixed an issue where chanspy flags were
	  uninitialized if no options were passed. What triggered this
	  investigation was an IRC chat where some people's quiet flags
	  were set while others' weren't even though none of them had
	  specified the q option. ........

2007-07-13 20:10 +0000 [r75053-75067]  Russell Bryant <russell@digium.com>

	* /, res/res_musiconhold.c: Merged revisions 75059 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r75059 | russell | 2007-07-13 15:07:21 -0500 (Fri, 13
	  Jul 2007) | 6 lines Ensure that adding a user to the list of
	  users of a specific music on hold class is not done at the same
	  time as any of the other operations on this list to prevent list
	  corruption. Using the global moh_data lock for this is not ideal,
	  but it is what is used to protect these lists everywhere else in
	  the module, and I am only changing what is necessary to fix the
	  bug. ........

	* channels/chan_zap.c, /: Merged revisions 75052 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r75052 | russell | 2007-07-13 14:10:00 -0500 (Fri, 13 Jul 2007) |
	  12 lines (closes issue #9660) Reported by: mmacvicar Patches
	  submitted by: bbryant, russell Tested by: mmacvicar, marco,
	  arcivanov, jmhunter, explidous When using a TDM400P (and probably
	  other analog cards) there was a chance that you could hang up and
	  pick the phone back up where it has been long enough to be not
	  considered a flash hook, but too soon such that the device
	  reports that it is busy and the person on the phone will only
	  hear silence. This patch makes chan_zap more tolerant of this and
	  gives the device a couple of seconds to succeed so the person on
	  the phone happily gets their dialtone. ........

2007-07-12 23:00 +0000 [r74998]  Mark Michelson <mmichelson@digium.com>

	* channels/chan_agent.c: Change to my previous fix regarding agent
	  logoff soft. Now uses deferlogoff instead of loginstart since
	  loginstart is used after logoff. Thanks to makoto for pointing
	  this out and suggesting the fix. (closes issue #10178, reported
	  and patched by makoto, with modification by me)

2007-07-12 20:42 +0000 [r74955]  Steve Murphy <murf@digium.com>

	* channels/chan_sip.c: This patch resolves 10143; thanks to irroot
	  for the patch; looked acceptable. Let the community decide if it
	  messes things up

2007-07-12 19:17 +0000 [r74888-74922]  Joshua Colp <jcolp@digium.com>

	* main/channel.c: Whoops... didn't want this to be returned to 0
	  each iteration.

	* main/channel.c: When waiting for a digit ensure that a begin
	  frame was received with it, not just an end frame. (issue #10084
	  reported by rushowr)

2007-07-12 16:53 +0000 [r74839-74866]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: It helps if I actually add this stuff for
	  the 7921 too - otherwise it won't actually do much of anything.

	* channels/chan_skinny.c: Add device ID for 7921 wireless skinny
	  phone

	* channels/chan_skinny.c: Fix dialing in skinny that was broken in
	  some cases. Issue 10136, fix provided by DEA.

2007-07-12 15:53 +0000 [r74815]  Joshua Colp <jcolp@digium.com>

	* /, res/res_musiconhold.c: Merged revisions 74814 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r74814 | file | 2007-07-12 12:51:24 -0300 (Thu, 12 Jul
	  2007) | 2 lines Only print out a warning for situations where it
	  is actually helpful. (issue #10187 reported by denke) ........

2007-07-11 22:57 +0000 [r74767]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 74766 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r74766 | russell | 2007-07-11 17:53:26 -0500 (Wed, 11 Jul 2007) |
	  5 lines The function make_trunk() can fail and return -1 instead
	  of a valid new call number. Fix the uses of this function to
	  handle this instead of treating it as the new call number. This
	  would cause a deadlock and memory corruption. (possible cause of
	  issue #9614 and others, patch by me) ........

2007-07-11 21:14 +0000 [r74722]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_agent.c: Merged revisions 74719 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r74719 | mmichelson | 2007-07-11 16:12:30 -0500 (Wed, 11
	  Jul 2007) | 5 lines The cli command "agent logoff Agent/x soft"
	  did not work...at all. Now it does. (closes issue #10178,
	  reported and patched by makoto, with slight modification for 1.4
	  and trunk by me) ........

2007-07-11 18:34 +0000 [r74657]  Russell Bryant <russell@digium.com>

	* res/res_config_odbc.c, /: Merged revisions 74656 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r74656 | russell | 2007-07-11 13:33:23 -0500 (Wed, 11
	  Jul 2007) | 4 lines Make sure that the ESCAPE immediately follows
	  the condition that uses LIKE. This fixes realtime extensions with
	  ODBC. (closes issue #10175, reported by stuarth, patch by me)
	  ........

2007-07-11 18:18 +0000 [r74628-74642]  Steve Murphy <murf@digium.com>

	* Makefile: This fixes 10172, where the entire man8 dir gets
	  removed during an uninstall of asterisk

	* utils/expr2.testinput, doc/channelvariables.txt, UPGRADE.txt:
	  further reversion of previously applied floating point stuff for
	  expr2

2007-07-11 17:16 +0000 [r74515-74590]  Joshua Colp <jcolp@digium.com>

	* /: Blocked revisions 74587 via svnmerge ........ r74587 | file |
	  2007-07-11 14:15:11 -0300 (Wed, 11 Jul 2007) | 2 lines Use some
	  Makefile magic to determine if linux/compiler.h is present.
	  (issue #10174 reported by francesco_r) ........

	* channels/chan_phone.c, configure,
	  include/asterisk/autoconfig.h.in, configure.ac: Instead of
	  figuring out kernel versions that have compiler.h and not...
	  let's just use autoconf to check for it's presence. (issue #10174
	  reported by francesco_r)

	* channels/chan_phone.c: Only check if we need to do a SIGMA based
	  tone generation if we have a card. (issue #10179 reported by
	  mikowhy)

2007-07-10 23:32 +0000 [r74476]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Forwarding a message with IMAP storage was
	  storing the message in the sender's box instead of the forwarded
	  mailbox. (closes issue #10138, reported and patched by jaroth)

2007-07-10 19:58 +0000 [r74374-74428]  Jason Parker <jparker@digium.com>

	* /, apps/app_queue.c: Merged revisions 74427 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r74427 | qwell | 2007-07-10 14:57:20 -0500 (Tue, 10 Jul 2007) | 6
	  lines Fix an issue where it was possible to have a service level
	  of over 100% Between the time recalc_holdtime and update_queue
	  was called, it was possible that the call could have been hungup.
	  Move both additions to the same place, so this won't happen.
	  Issue 10158, initial patch by makoto, modified by me. ........

	* main/dns.c: Don't use #if to check if something is defined - use
	  #ifdef instead. Pointed out by kpfleming

	* /, channels/chan_agent.c: Merged revisions 74376 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r74376 | qwell | 2007-07-10 14:03:45 -0500 (Tue, 10 Jul
	  2007) | 4 lines Fix an issue with wrapuptime not working when
	  using AgentLogin. Issue 10169, patch by makoto, with a minor mod
	  by me to not re-break issue 9618 ........

	* main/dns.c, /, configure, include/asterisk/autoconfig.h.in,
	  configure.ac: Merged revisions 74373 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r74373 | qwell | 2007-07-10 13:37:23 -0500 (Tue, 10 Jul 2007) | 5
	  lines Use res_ndestroy on systems that have it. Otherwise, use
	  res_nclose. This prevents a memleak on NetBSD - and possibly
	  others. Issue 10133, patch by me, reported and tested by scw
	  ........

2007-07-10  Russell Bryant <russell@digium.com>

	* Asterisk 1.4.7.1 released.

2007-07-10 16:00 +0000 [r74323]  Russell Bryant <russell@digium.com>

	* res/res_musiconhold.c: fix an uninitialized variable

2007-07-10 15:38 +0000 [r74317]  Jason Parker <jparker@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 74316 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r74316 | qwell | 2007-07-10 10:37:54 -0500 (Tue, 10 Jul 2007) | 4
	  lines Fix a small typo in description in of Voicemail()
	  application. Issue 10170, patch by casper. ........

2007-07-10 15:31 +0000 [r74314]  Russell Bryant <russell@digium.com>

	* res/res_config_odbc.c, /: Merged revisions 74313 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r74313 | russell | 2007-07-10 10:30:20 -0500 (Tue, 10
	  Jul 2007) | 3 lines Only use ESCAPE when LIKE is used. (issue
	  #10075, this part reported by jmls on IRC, patch by me) ........

2007-07-10 14:50 +0000 [r74262-74265]  Joshua Colp <jcolp@digium.com>

	* /, main/app.c: Merged revisions 74264 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r74264 | file | 2007-07-10 11:48:00 -0300 (Tue, 10 Jul 2007) | 2
	  lines Ensure the group information category exists before trying
	  to do a string comparison with it. (issue #10171 reported by
	  mlegas) ........

	* channels/chan_sip.c: Only spit out an inringing warning message
	  when it is applicable. Since call limits are already toast in
	  realtime let's not scare the user if they are using it. (issue
	  #10166 reported by bcnit)

2007-07-09  Russell Bryant <russell@digium.com>

	* Asterisk 1.4.7 released.

2007-07-09 21:31 +0000 [r74162-74211]  Russell Bryant <russell@digium.com>

	* configure, configure.ac: Update the configure script to check for
	  a required function that is not present in the 1.2 version of
	  libpri. This will prevent the configure script from thinking that
	  it has compatible libpri support for Asterisk 1.4, when it
	  actually does not because the installed version is from 1.2.

	* /: Blocked revisions 74165 via svnmerge ........ r74165 | russell
	  | 2007-07-09 16:00:17 -0500 (Mon, 09 Jul 2007) | 4 lines When the
	  specified class isn't found, properly fall back to the channel's
	  music class or the default. (issue #10123, reported by blitzrage,
	  patches from juggie, qwell, and me) ........

	* res/res_musiconhold.c: (closes issue #10123) Reported by:
	  blitzrage Patches submitted by: juggie, qwell, me Tested by:
	  blitzrage When trying to find a music on hold class to use, try
	  all of the options, instead of only the first one that is set.
	  Also, change the MusicOnHold applications to not hang up on the
	  channel when a class can not be found.

2007-07-09 20:19 +0000 [r74159]  Jason Parker <jparker@digium.com>

	* channels/chan_zap.c, /: Merged revisions 74158 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r74158 | qwell | 2007-07-09 15:18:15 -0500 (Mon, 09 Jul 2007) | 8
	  lines Several chan_zap options were not working on reload because
	  they were arbitrarily disallowed when reloading some/most PRI
	  options (such as signalling) was disallowed. Options such as
	  polarityonanswerdelay and answeronpolarityswitch can safely be
	  changed on a reload. This corrects that behavior. Issue 9186,
	  patch by tzafrir. ........

2007-07-09 18:38 +0000 [r74120-74122]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Forgot to get rid of an extraneous debug
	  message.

	* apps/app_queue.c: The n option for Queue should make the queue
	  exit immediately after failure to reach any members and should
	  not be dependent on the timeout value passed to Queue (closes
	  issue #10127, reported by bcnit, repaired by me)

2007-07-09 15:32 +0000 [r74082]  Joshua Colp <jcolp@digium.com>

	* channels/chan_skinny.c: Only destroy the scheduler context if it
	  was allocated. (issue #10124 reported by gzero)

2007-07-09 14:57 +0000 [r74047]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Fixed a logic error in leave_voicemail.
	  Pass the mailbox instead of the context to inbox_count when the
	  context is "default." (closes issue #10135, reported by yannj,
	  repaired by me)

2007-07-09 14:49 +0000 [r74043-74045]  Joshua Colp <jcolp@digium.com>

	* channels/chan_skinny.c, pbx/pbx_dundi.c: Few minor thread
	  synchronization tweaks. (issue #10124 reported by gzero)

	* configure, acinclude.m4: Use AC_CHECK_HEADER to check for
	  ptlib/openh323 to allow for cross compiling. (issue #9675
	  reported by zandbelt)

2007-07-09 04:03 +0000 [r73985]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/ast_expr2f.c: Doxygen formatting fixes; fixes errors while
	  'make progdocs'. (Closes issue #10104)

2007-07-09 03:13 +0000 [r73930-73980]  Joshua Colp <jcolp@digium.com>

	* main/cdr.c: Give Agent channel names priority when doing CDR
	  merging. (issue #10011 reported by krtorio)

	* pbx/pbx_config.c: Add a few sanity checks when writing out the
	  dialplan. (issue #10157 reported by dome)

2007-07-08 09:47 +0000 [r73849]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: While tracking down a bug, I need some more
	  history. Dumphistory is very useful, indeed.

2007-07-06 23:02 +0000 [r73769]  Russell Bryant <russell@digium.com>

	* /, channels/chan_sip.c: Merged revisions 73768 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r73768 | russell | 2007-07-06 18:01:22 -0500 (Fri, 06 Jul 2007) |
	  4 lines If a sip_pvt struct has already registered an extension
	  state callback, remove the old one before adding a new one. If
	  this isn't done, Asterisk will crash. (issue #10120) ........

2007-07-06 16:36 +0000 [r73727]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Fixing a rare case which causes voicemail
	  to crash when compiled with IMAP storage. inboxcount has the
	  possibility of finding an "interactive" vm_state when no
	  persistent "non-interactive" vm_state exists for that mailbox. If
	  this should happen when someone attempts to leave a message, it
	  results in a crash. This patch, along with my commit in revision
	  72670 fix issue 10053, reported by jaroth. closes issue #10053

2007-07-06 16:12 +0000 [r73679-73696]  Russell Bryant <russell@digium.com>

	* res/res_config_odbc.c, /: Merged revisions 73684 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r73684 | russell | 2007-07-06 11:06:27 -0500 (Fri, 06
	  Jul 2007) | 8 lines (closes issue #10075) Reported by: apsaras
	  Patches submitted by: Corydon76 Tested by: apsaras Fix a problem
	  with MSSQL 2005 by explicitly stating that '\' is being used as
	  an escape character. ........

	* /, channels/chan_sip.c: Merged revisions 73678 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r73678 | russell | 2007-07-06 10:55:41 -0500 (Fri, 06 Jul 2007) |
	  7 lines (closes issue #10125) Reported by: makoto Patches
	  submitted by: makoto This fixes a crash in chan_sip that happens
	  when the bindaddr setting is not valid on Asterisk startup, gets
	  fixed, and then a reload gets issued. ........

2007-07-06 15:27 +0000 [r73675]  Mark Michelson <mmichelson@digium.com>

	* /, channels/chan_agent.c: Merged revisions 73674 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r73674 | mmichelson | 2007-07-06 10:26:40 -0500 (Fri, 06
	  Jul 2007) | 5 lines Fixed a bug wherein agents get stuck busy.
	  (issue 9618, reported by jiddings, patched by moi) closes issue
	  #9618 ........

2007-07-06 03:34 +0000 [r73551-73629]  Russell Bryant <russell@digium.com>

	* BUGS: fix a little spelling error

	* channels/chan_sip.c: Fix a crash in chan_sip. Don't try to stop
	  the monitor thread if it was never started. (closes issue #10124,
	  reported by gzero, fixed by me)

	* channels/chan_iax2.c: copy from the correct buffer when deferring
	  a full frame (related to issue #9937)

	* channels/chan_iax2.c: * Store the call number that a thread is
	  processing without the full frame bit set to ease debugging *
	  When deferring a full frame for processing, stick it into the
	  queue for the thread that is processing frames for that call, not
	  the one that read the current frame and is about to go back into
	  the idle list (related to issue #9937)

2007-07-05 22:20 +0000 [r73548]  Kevin P. Fleming <kpfleming@digium.com>

	* /, channels/chan_sip.c: Merged revisions 73547 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r73547 | kpfleming | 2007-07-05 17:11:51 -0500 (Thu, 05 Jul 2007)
	  | 2 lines we shouldn't allow G.723.1 endpoints to use VAD, just
	  like we don't support it for G.729 ........

2007-07-05 20:50 +0000 [r73512]  Russell Bryant <russell@digium.com>

	* res/res_features.c: Pass HOLD and UNHOLD frames to the other
	  channel when they are returned from a native bridge function.
	  This fixes a problem where when two zap channels are natively
	  bridged and one does a flash hook, the other channel did not
	  receive music on hold. (Reported to me directly by Doug Bailey at
	  Digium)

2007-07-05 19:18 +0000 [r73467]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 73466 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r73466 | file | 2007-07-05 16:15:18 -0300 (Thu, 05 Jul 2007) | 2
	  lines Copy language information to the dialog structure when
	  calling a peer for situations where a PBX may be started on the
	  dialed channel. (issue #10121 reported by clegall_proformatique)
	  ........

2007-07-05 15:59 +0000 [r73400]  Mark Michelson <mmichelson@digium.com>

	* apps/app_queue.c: Correcting a minor CLI bug I found. When
	  issuing the queue show command, if you type queue show and then
	  press tab, you can continue pressing tab and it will keep
	  auto-completing queue names even though only 1 queue can be used
	  as an argument.

2007-07-05 15:28 +0000 [r73398]  Russell Bryant <russell@digium.com>

	* channels/chan_vpb.cc, channels/Makefile: Make this module build
	  for me in dev-mode

2007-07-05 14:21 +0000 [r73316-73355]  Joshua Colp <jcolp@digium.com>

	* apps/app_chanspy.c, main/channel.c, /: Merged revisions 73349 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r73349 | file | 2007-07-05 11:19:14 -0300 (Thu, 05 Jul 2007) | 2
	  lines Tweak spy locking. (issue #9951 reported by welles)
	  ........

	* channels/chan_local.c, /: Merged revisions 73318 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r73318 | file | 2007-07-05 10:26:02 -0300 (Thu, 05 Jul
	  2007) | 2 lines Actually check to make sure a PBX was started on
	  one of the Local channels instead of blindly assuming it was.
	  (issue #10112 reported by makoto) ........

	* /, apps/app_queue.c: Merged revisions 73315 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r73315 | file | 2007-07-05 10:19:17 -0300 (Thu, 05 Jul 2007) | 2
	  lines Reset ServicelevelPerf variable back to 0 if we are unable
	  to calculate it each time... otherwise we will get previous
	  values. (issue #10117 reported by noriyuki) ........

2007-07-04 14:53 +0000 [r73208-73253]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, /: Merged revisions 73252 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r73252 | crichter | 2007-07-04 16:50:58 +0200 (Mi, 04
	  Jul 2007) | 1 line bchannel configurations like echocancel and
	  volume control, need to be setuped on inbound calls too. ........

	* channels/chan_misdn.c, /: Merged revisions 73207 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r73207 | crichter | 2007-07-04 10:20:54 +0200 (Mi, 04
	  Jul 2007) | 1 line bad bug in overlapdial case, we called
	  start_pbx multiple times, because the state wasn't changed..
	  ........

2007-07-03 20:17 +0000 [r73143]  Steve Murphy <murf@digium.com>

	* main/ast_expr2.fl, main/ast_expr2.c, main/Makefile,
	  main/ast_expr2.h, main/ast_expr2.y, main/ast_expr2f.c: Removing
	  expr floating patch from 1.4; too much of a behavior change. If
	  you want this fix, try trunk instead. bug 9508.

2007-07-03 15:42 +0000 [r73104-73106]  Jason Parker <jparker@digium.com>

	* /: What the heck. This should not have happened.

	* /: use autotagged externals

2007-07-03 12:38 +0000 [r73053]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_dial.c, /: Merged revisions 73052 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r73052 | tilghman | 2007-07-03 07:34:14 -0500 (Tue, 03 Jul 2007)
	  | 2 lines RetryDial should accept a 0 argument, but it does not,
	  because atoi does not distinguish between 0 and error (closes
	  issue #10106) ........

2007-07-03 08:17 +0000 [r73005]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c, /: Merged revisions 73004 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r73004 | crichter | 2007-07-03 10:04:35 +0200 (Di, 03
	  Jul 2007) | 1 line fixed issue, that misdn_l2l1_check could only
	  be called from mISDN Source channels.. #9449 ........

2007-07-02 20:16 +0000 [r72933]  Steve Murphy <murf@digium.com>

	* main/ast_expr2.fl, main/ast_expr2.c, utils/expr2.testinput,
	  main/Makefile, main/ast_expr2.h, main/ast_expr2.y,
	  main/ast_expr2f.c, doc/channelvariables.txt, UPGRADE.txt: support
	  for floating point numbers added to ast_expr2 $\[...\] exprs.
	  Fixes bug 9508, where the expr code fails with fp numbers. The
	  MATH function returns fp numbers by default, so this fix is
	  considered necessary.

2007-07-02 18:18 +0000 [r72926]  Russell Bryant <russell@digium.com>

	* main/manager.c: Remove a bogus comment and add proper locking to
	  the handler function for the CLI command to show information on
	  manager actions.

2007-07-02 17:59 +0000 [r72925]  Jason Parker <jparker@digium.com>

	* /: Blocked revisions 72924 via svnmerge ........ r72924 | qwell |
	  2007-07-02 12:58:25 -0500 (Mon, 02 Jul 2007) | 4 lines Fix an
	  issue with playing "oclock" multiple times in French with 24 hour
	  time format. Issue 10101 ........

2007-07-02 14:32 +0000 [r72888]  Joshua Colp <jcolp@digium.com>

	* main/channel.c: Added additional DTMF debug messages for when
	  emulation occurs.

2007-07-02 08:41 +0000 [r72850-72852]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/chan_misdn.c, /: Merged
	  revisions 72585 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r72585 | crichter | 2007-06-29 15:08:26 +0200 (Fr, 29 Jun 2007) |
	  1 line check if the bchannel stack id is already used, if so
	  don't use it a second time. Also added a release_chan lock, so
	  that the same chan_list object cannot be freed twice. chan_misdn
	  does not crash anymore on heavy load with these changes. ........

	* channels/misdn/isdn_lib.c, channels/misdn/isdn_lib.h,
	  channels/chan_misdn.c, /, channels/misdn/isdn_msg_parser.c:
	  Merged revisions 72099 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r72099 | crichter | 2007-06-27 15:22:37 +0200 (Mi, 27 Jun 2007) |
	  1 line simplified generation for dummy bchannels, also we mark
	  them as dummies, so they are not used later as real-bchannels,
	  optimized the RESTART mechanisms, we block a channel now on
	  cause:44, and send out a RESTART automatically, then on reception
	  of RESTART_ACKNOWLEDGE we unblock the channel again. ........

	* channels/misdn/isdn_lib.c, channels/misdn/isdn_lib.h, /: Merged
	  revisions 72087 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r72087 | crichter | 2007-06-27 11:26:53 +0200 (Mi, 27 Jun 2007) |
	  1 line simplified channel finding and locking a lot. removed
	  unnecessary #ifdefed areas. ........

2007-07-01 23:52 +0000 [r72806]  Russell Bryant <russell@digium.com>

	* pbx/pbx_spool.c, /: Merged revisions 72805 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r72805 | russell | 2007-07-01 18:51:34 -0500 (Sun, 01 Jul 2007) |
	  5 lines When appending lines to call files to keep track of
	  retries, write a leading newline just in case the original call
	  file did not have a newline at the end. This fix is in response
	  to a problem I saw reported on the asterisk-users mailing list.
	  ........

2007-06-30 16:50 +0000 [r72705-72766]  Russell Bryant <russell@digium.com>

	* configure, configure.ac: Tweak the configure script so that error
	  output isn't spewed to the console when searching for GTK2 libs,
	  and they aren't found.

	* formats/format_pcm.c: give format_pcm a more concise destription

2007-06-29 19:07 +0000 [r72665]  Luigi Rizzo <rizzo@icir.org>

	* main/utils.c: Use !defined(HAVE_GETHOSTBYNAME_R) to check for
	  absence of the function. This was already done in trunk.

2007-06-29  Russell Bryant <russell@digium.com>

	* Asterisk 1.4.6 released.

2007-06-29 16:31 +0000 [r72630]  Russell Bryant <russell@digium.com>

	* /: Blocked revisions 72629 via svnmerge ........ r72629 | russell
	  | 2007-06-29 11:30:56 -0500 (Fri, 29 Jun 2007) | 4 lines Backport
	  changes that make chan_iax2 not start the PBX on an incoming
	  channel until the three-way call setup is completed. These
	  changes are already in 1.4 and trunk. ........

2007-06-29 14:26 +0000 [r72597-72599]  Joshua Colp <jcolp@digium.com>

	* main/cdr.c: Minor change for older GCC versions.

	* Makefile, configure, configure.ac, makeopts.in: Backport fix for
	  GCC versions without support for declaration-after-statement.

2007-06-29 04:47 +0000 [r72554-72556]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/manager.c: Issue 10055 - Change memory allocation to use the
	  heap for a command, since the output has the potential to
	  overflow the stack (as it did here)

	* res/res_jabber.c: Fix 1.4 breakage

2007-06-28 19:44 +0000 [r72493]  Russell Bryant <russell@digium.com>

	* configure, include/asterisk/autoconfig.h.in: regenerate the
	  configure script for rizzo

2007-06-28 19:29 +0000 [r72453-72489]  Luigi Rizzo <rizzo@icir.org>

	* configure.ac: add a check for gethostbyname_r so we can simplify
	  the handling e.g. in utils.c Also add comments on a couple of
	  features which are not working on FreeBSD. All the above has been
	  already done in trunk so the merge must be blocked. Can someone
	  please regenerate ./configure ?

	* Makefile, channels/chan_zap.c, main/say.c: Add
	  -Wdeclaration-after-statement to AST_DEVMODE flags to catch
	  variable declarations in the middle of a block. Fix the few
	  instances of the above spotted out by the compiler. All of this
	  has been already done or is not applicable in trunk, so the merge
	  of this change will be blocked.

	* apps/app_meetme.c: cast a time_t so that it does not conflict
	  with the print format. This change was already done on trunk so
	  this change needs to be blocked from merging.

2007-06-27 23:29 +0000 [r72383]  Brett Bryant <bbryant@digium.com>

	* main/asterisk.c, /: Merged revisions 72373 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r72373 | bbryant | 2007-06-27 18:22:13 -0500 (Wed, 27 Jun 2007) |
	  3 lines Reinstating patch. This actually fixes the problem,
	  however I was running a development branch without it and
	  mistakenly thought it wasn't fixed. Fixes issue #10010, and
	  #9654: 100% CPU usage caused by an asterisk console losing it's
	  controlling terminal. ........

2007-06-27 23:25 +0000 [r72381]  Joshua Colp <jcolp@digium.com>

	* apps/app_mixmonitor.c, /: Merged revisions 72378 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r72378 | file | 2007-06-27 19:24:01 -0400 (Wed, 27 Jun
	  2007) | 2 lines Update documentation to clarify variable usage
	  with MixMonitor. (issue #9494 reported by netoguy) ........

2007-06-27 23:03 +0000 [r72335]  Brett Bryant <bbryant@digium.com>

	* main/asterisk.c, /: Merged revisions 72333 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r72333 | bbryant | 2007-06-27 17:58:53 -0500 (Wed, 27 Jun 2007) |
	  2 lines Reverted changes for earlier revisions 72259 to 72261.
	  Issue #9654, #10010 ........

2007-06-27 22:58 +0000 [r72328-72331]  Joshua Colp <jcolp@digium.com>

	* channels/chan_gtalk.c: Make payload IDs for iLBC/Speex match to
	  our list. Since these are dynamic payloads the other side
	  shouldn't care. (issue #9426 reported by irroot)

	* /, apps/app_queue.c: Merged revisions 72327 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r72327 | file | 2007-06-27 18:43:11 -0400 (Wed, 27 Jun 2007) | 2
	  lines Fix issue where queue log events might be missing. (issue
	  #7765 reported by mtryfoss) ........

2007-06-27 21:08 +0000 [r72272]  Russell Bryant <russell@digium.com>

	* /, pbx/pbx_config.c: Merged revisions 72267 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r72267 | russell | 2007-06-27 16:06:45 -0500 (Wed, 27 Jun 2007) |
	  5 lines Fix a minor issue with parsing the priority number. You
	  could have as much whitespace as you want around a numeric
	  priority, but you couldn't have any whitespace around a special
	  priority like "n" or "hint". (issue #10039, reported by mitheloc,
	  fixed by me) ........

2007-06-27 20:46 +0000 [r72260]  Brett Bryant <bbryant@digium.com>

	* main/asterisk.c, /: Merged revisions 72259 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r72259 | bbryant | 2007-06-27 15:43:53 -0500 (Wed, 27 Jun 2007) |
	  4 lines Fixes 100% load when controlling terminal disappears.
	  Issue #9654, #10010 ........

2007-06-27 20:25 +0000 [r72257]  Joshua Colp <jcolp@digium.com>

	* main/channel.c, /: Merged revisions 72256 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r72256 | file | 2007-06-27 16:23:24 -0400 (Wed, 27 Jun 2007) | 2
	  lines I may possibly get shot for doing this... but... defer CDR
	  processing until after the channel has been dealt with. This
	  should eliminate all of the issues with channels going funky
	  (SIP/PRI) when you are posting CDRs to a database that is either
	  slow or unavailable and do not want to enable batching. ........

2007-06-27 19:13 +0000 [r72205]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_zap.c: use the proper type for storing group number
	  bits so that if someone specifies 'group=42' it will actually
	  work instead of being silently ignored

2007-06-27 18:40 +0000 [r72182-72185]  Jason Parker <jparker@digium.com>

	* /: Blocked revisions 72184 via svnmerge ........ r72184 | qwell |
	  2007-06-27 13:40:15 -0500 (Wed, 27 Jun 2007) | 4 lines Fix
	  another problem in voicemail with missing symbols. Issue 10074,
	  patch by kryptolus, extended to include #if 0'd blocks (just in
	  case) ........

	* apps/app_voicemail.c: Fix another problem in voicemail with
	  missing symbols. Issue 10074, patch by kryptolus, extended to
	  include #if 0'd blocks (just in case)

2007-06-27 17:31 +0000 [r72148]  Joshua Colp <jcolp@digium.com>

	* main/channel.c: Make the ast_read_noaudio API call behave better
	  under circumstances where DTMF emulation was happening and a
	  generator was setup. (issue #10065 reported by stevefeinstein)

2007-06-27 17:10 +0000 [r72125]  Jason Parker <jparker@digium.com>

	* channels/chan_gtalk.c: Don't modify a variable that we don't want
	  modified. Make a copy of it instead. Issue 10029, patch by
	  phsultan with slight modifications by me (to remove needless
	  casts).

2007-06-27 16:34 +0000 [r72112]  Russell Bryant <russell@digium.com>

	* main/rtp.c: Only output debug information related to RTCP
	  timestamps when RTCP debug is turned on (issue #10066, patch by
	  me)

2007-06-27 07:58 +0000 [r72042]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, /: Merged revisions 72040-72041 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r72040 | crichter | 2007-06-27 09:49:27 +0200 (Mi, 27 Jun 2007) |
	  1 line for inbound TE calls, we setup the bchannel when we get
	  the CONNECT_ACKNOWLEDGE, to make sure mISDN has everything ready.
	  removed some #if 0 areas which weren't used anymore. ........
	  r72041 | crichter | 2007-06-27 09:54:30 +0200 (Mi, 27 Jun 2007) |
	  1 line isdn_lib.c didn't compile ........

2007-06-27 00:58 +0000 [r72006]  Joshua Colp <jcolp@digium.com>

	* pbx/pbx_dundi.c: Make unloading of pbx_dundi actually work.

2007-06-26 23:02 +0000 [r71953]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Removing a pointless line. This variable
	  was already set earlier and between then and this line, there is
	  no way that the values on the right side of the assignment could
	  have changed.

2007-06-26 20:36 +0000 [r71915]  Jason Parker <jparker@digium.com>

	* main/rtp.c: Don't dereference a pointer that may be NULL here.
	  Issue 10017.

2007-06-26 19:00 +0000 [r71877]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: A few changes, the ultimate goal of which
	  is to keep better track of the number of messages that a mailbox
	  currently has. A description of the changes: 1. Changed the
	  "updated" field of the vm_state struct to act more as a binary
	  semaphore than a counting semaphore, since its current
	  implementation made the inboxcount function not work properly.
	  This change falls in line with a change made by UPenn with their
	  IMAP setup and helps to sync our changes with theirs. 2.
	  Eliminated some redundant calls to get_vm_state_by_mailbox inside
	  leave_voicemail 3. Use the play_folder variable to keep track of
	  the number of old and new messages in a mailbox as the messages
	  are deleted 4. Added an increment to the number of new messages
	  that was not there previously in the leave_voicemail function

2007-06-26 17:49 +0000 [r71848]  Jason Parker <jparker@digium.com>

	* /: Blocked revisions 71847 via svnmerge ........ r71847 | qwell |
	  2007-06-26 12:49:14 -0500 (Tue, 26 Jun 2007) | 4 lines Don't try
	  to install an init script that doesn't exist. Reported to me on
	  #asterisk on Freenode IRC. ........

2007-06-26 15:47 +0000 [r71796]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Fixing bug where the authuser was
	  mistakenly pulled from the mailbox string instead of the IMAP
	  user. (closes issue 10054, reported and patched by jaroth)

2007-06-26 12:27 +0000 [r71657-71751]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c, /: Merged revisions 71750 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r71750 | tilghman | 2007-06-26 07:25:58 -0500 (Tue, 26 Jun 2007)
	  | 2 lines Issue 10062 - Trying to move a message without
	  selecting one first results in memory corruption ........

	* /, res/res_agi.c: Merged revisions 71656 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r71656 | tilghman | 2007-06-25 13:12:37 -0500 (Mon, 25 Jun 2007)
	  | 2 lines Issue 10035 - handle_exec returns a result inconsistent
	  with all of the other AGI commands ........

2007-06-25 14:13 +0000 [r71522-71576]  Joshua Colp <jcolp@digium.com>

	* channels/chan_h323.c: Build a peer as well when hash323 is
	  enabled in users.conf (issue #9599 reported by asagage)

	* channels/chan_agent.c: Minor tweak for queueing up the unhold
	  frame... this will teach me to do bugs while half asleep. (issue
	  #10046 reported by dimas)

2007-06-25 12:40 +0000 [r71519]  Russell Bryant <russell@digium.com>

	* doc/asterisk-mib.txt: Fix a typo in the Asterisk mib. (issue
	  #10048, Matti)

2007-06-25 01:10 +0000 [r71412-71430]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 71414 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r71414 | file | 2007-06-24 21:02:49 -0400 (Sun, 24 Jun 2007) | 2
	  lines Ignore other URIs after the first in a 300 Multiple Choice
	  response. (issue #10041 reported by homesick) ........

	* main/cdr.c: Fix it so 1.4 actually compiles on my box.

	* channels/chan_agent.c: Check to make sure the channel pointer is
	  present before queueing up an unhold frame on it. (issue #10046
	  reported by dimas)

2007-06-24 20:16 +0000 [r71362-71371]  Russell Bryant <russell@digium.com>

	* build_tools/prep_tarball: Include the menuselect-tree file in
	  tarballs to make builds from tarballs a little bit faster

	* main/asterisk.c, /: Merged revisions 71358 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r71358 | russell | 2007-06-24 15:04:21 -0500 (Sun, 24 Jun 2007) |
	  2 lines Revert the patch from issue 9654 due to an unexpected
	  side effect ........

2007-06-24 17:50 +0000 [r71289-71291]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* res/res_features.c: Issue 10044 - chan->cdr is NULL here, so
	  peer->cdr is what we really wanted to use

	* main/db.c, main/manager.c, /: Merged revisions 71288 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r71288 | tilghman | 2007-06-24 12:32:21 -0500 (Sun, 24
	  Jun 2007) | 2 lines Issue 10043 - There is a legitimate need to
	  be able to set variables to the empty string. ........

2007-06-23 03:29 +0000 [r71230]  Steve Murphy <murf@digium.com>

	* main/cdr.c, res/res_features.c: This patch is meant to fix 8433;
	  where clid and src are lost via bridging.

2007-06-22 22:44 +0000 [r71214]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/misdn/isdn_lib.h,
	  channels/chan_misdn.c, /: Merged revisions 70341 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r70341 | crichter | 2007-06-20 17:29:09 +0200 (Mi, 20
	  Jun 2007) | 1 line fixed a bug that was introduced by copy and
	  paste in the last commit ..bchannels weren't cleaned properly.
	  ........

2007-06-22 16:05 +0000 [r71128]  Joshua Colp <jcolp@digium.com>

	* /: Blocked revisions 71124 via svnmerge ........ r71124 | file |
	  2007-06-22 12:02:40 -0400 (Fri, 22 Jun 2007) | 2 lines Send an
	  unhold indication when going off hold. (issue #10036 reported by
	  speedy) ........

2007-06-22 15:38 +0000 [r71096-71123]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/chan_misdn.c, /: Merged
	  revisions 70672 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r70672 | crichter | 2007-06-21 15:11:29 +0200 (Do, 21 Jun 2007) |
	  1 line we activate the bchannels in TE mode on incoming calls
	  only when we want to connect the call. ........

	* channels/misdn/isdn_lib.c, /: Merged revisions 70342 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r70342 | crichter | 2007-06-20 17:42:39 +0200 (Mi, 20
	  Jun 2007) | 1 line forgot one place .. ........

	* channels/misdn/isdn_lib.c, channels/misdn/isdn_lib.h,
	  channels/chan_misdn.c, /: Merged revisions 70311 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r70311 | crichter | 2007-06-20 16:47:59 +0200 (Mi, 20
	  Jun 2007) | 1 line on receiption of cause:44 we mark the channel
	  as in use and inform the user about the situation, we need to
	  test the RESTART stuff then. Also shuffled the
	  empty_chan_in_stack function after the bchannel cleaning
	  functions, to avoid race conditions. ........

	* channels/chan_misdn.c, /: Merged revisions 69887 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r69887 | crichter | 2007-06-19 15:23:04 +0200 (Di, 19
	  Jun 2007) | 1 line when we send out a SETUP, but get no response,
	  we should cleanup everything after reception of a hangup.
	  ........

	* /, channels/misdn/isdn_msg_parser.c: Merged revisions 69053 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r69053 | crichter | 2007-06-13 11:55:54 +0200 (Mi, 13 Jun 2007) |
	  1 line restart indicator 0x80 is correct, at least that's what
	  libpri does. ........

	* channels/chan_misdn.c, /: Merged revisions 68887 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r68887 | crichter | 2007-06-12 10:35:22 +0200 (Di, 12
	  Jun 2007) | 1 line if the bridged partner is mISDN too we should
	  not send dtmf tones, they are transmitted inband always ........

	* channels/chan_misdn.c, /: Merged revisions 68874 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r68874 | crichter | 2007-06-12 09:48:52 +0200 (Di, 12
	  Jun 2007) | 1 line if we have already some digits, we just stop
	  the tones. ........

2007-06-22 15:00 +0000 [r71068]  Jason Parker <jparker@digium.com>

	* apps/app_speech_utils.c, /, res/res_agi.c, main/file.c: Merged
	  revisions 71065 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r71065 | qwell | 2007-06-22 09:52:18 -0500 (Fri, 22 Jun 2007) | 4
	  lines Fix a few silly usages of ast_playstream() - it only ever
	  returns 0... Issue 10035 ........

2007-06-22 14:53 +0000 [r71066]  Brett Bryant <bbryant@digium.com>

	* main/asterisk.c, /: Merged revisions 71064 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r71064 | bbryant | 2007-06-22 09:39:34 -0500 (Fri, 22 Jun 2007) |
	  10 lines Fixed infinite loop when controlling terminal was lost
	  and return value of input function wasn't checked for errors.
	  This would cause 100% cpu to be taken up. (closes issue #9654,
	  issue #10010) Reported by: mnicholson, and eserra Idea for the
	  patch from mnicholson, patched by me ........

2007-06-22 14:10 +0000 [r71063]  Steve Murphy <murf@digium.com>

	* main/cdr.c: My conditions for merging amaflags info was naive;
	  DOCUMENTATION is the default, although null is possible; theft of
	  user-settable fields is not good. Just copy them, leave them
	  alone.

2007-06-22 03:14 +0000 [r71003]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Fix a small typo which ... well ...
	  completely broke chan_iax2. oops! (issue #9937, patch by me)

2007-06-21 22:34 +0000 [r70949]  Steve Murphy <murf@digium.com>

	* main/cdr.c, /: Merged revisions 70948 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r70948 | murf | 2007-06-21 16:29:50 -0600 (Thu, 21 Jun 2007) | 1
	  line This little fix is in response to bug 10016, but may not
	  cure it. The code is wrong, clearly. In a situation where you set
	  the CDR's amaflags, and then ForkCDR, and then set the new CDR's
	  amaflags to some other value, you will see that all CDRs have had
	  their amaflags changed. This is not good. So I fixed it. ........

2007-06-21 21:40 +0000 [r70899]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 70898 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r70898 | file | 2007-06-21 17:37:55 -0400 (Thu, 21 Jun 2007) | 2
	  lines Don't explode if the gain option is specified without a
	  value. (issue #9274 reported by mfarver) ........

2007-06-21 21:14 +0000 [r70866-70883]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Put the thread reading from the socket back
	  in the idle list if it deferred the processing of a full frame to
	  another thread

	* channels/chan_iax2.c: If a full frame is received while one of
	  the iax2 threads is in the middle of handling a full frame for
	  the same call, queue it up for processing by that same thread
	  later instead of dropping it. (issue #9937, patch by me)

2007-06-21 20:19 +0000 [r70841]  Steve Murphy <murf@digium.com>

	* cdr/cdr_custom.c, /: Merged revisions 70804 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r70804 | murf | 2007-06-21 13:13:17 -0600 (Thu, 21 Jun 2007) | 1
	  line it was pointed out that the cdr_custom config load could get
	  a lock, and under certain circumstances, would never release it.
	  I also noted that the situation where more than one mapping spec
	  was warned about, but did not ignore further mappings as it had
	  promised. I think I have fixed both situations. ........

2007-06-21 19:49 +0000 [r70808]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: When volgain is used don't leave a
	  temporary file behind. (Closes Issue 8514, Reported and patched
	  by ulogic, code reviewed by Jason Parker)

2007-06-21 15:22 +0000 [r70727]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Do not Packet2Packet bridge if packetization settings
	  do not allow it. (issue #9117 reported by phsultan)

2007-06-21 15:21 +0000 [r70726]  Russell Bryant <russell@digium.com>

	* apps/app_meetme.c: Remove a couple of duplicate unlocks

2007-06-21 13:58 +0000 [r70677]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c: Fix building with ODBC storage enabled.
	  (issue #10025 reported by denisgalvao)

2007-06-21 13:00 +0000 [r70656]  Steve Murphy <murf@digium.com>

	* main/cdr.c: Via complaints aired in asterisk-users, I submit
	  these changes, which allow cdr updates to see macro
	  context/exten, whether hung up or not

2007-06-20 23:32 +0000 [r70554-70612]  Jason Parker <jparker@digium.com>

	* cdr/cdr_pgsql.c: Fix some potential memory leaks in cdr_pgsql.
	  Issue 10020, patch by my, with credit to prashant_jois for
	  pointing out the problem.

	* cdr/cdr_pgsql.c: Fix a stupid mistake in my last cdr_pgsql race
	  condition fix

	* cdr/cdr_pgsql.c: Fix a race condition in cdr_pgsql that can occur
	  when reloading the module. Issue 10022, patch by me, with credit
	  to prashant_jois for finding the bug.

2007-06-20 22:22 +0000 [r70552]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 70551 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r70551 | file | 2007-06-20 18:20:16 -0400 (Wed, 20 Jun 2007) | 2
	  lines Don't overwrite the configured username setting upon a
	  REGISTER. (issue #8565 reported by jsmith) ........

2007-06-20 20:53 +0000 [r70494]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Make sure we clear the previously dialed
	  number if it did not exist. Issue 9958.

2007-06-20 19:29 +0000 [r70445]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_dial.c, /: Merged revisions 70444 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r70444 | tilghman | 2007-06-20 14:25:54 -0500 (Wed, 20 Jun 2007)
	  | 2 lines Issue 9997 - Timelimit times out the wrong channel
	  ........

2007-06-20 18:46 +0000 [r70397]  Russell Bryant <russell@digium.com>

	* channels/chan_zap.c, /: Merged revisions 70396 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r70396 | russell | 2007-06-20 13:45:38 -0500 (Wed, 20 Jun 2007) |
	  5 lines Fix a problem where an established call would not be
	  properly disconnected when a PRI disconnect is received depending
	  on which cause code was received. (issue #9588, original patch by
	  softins, updated patch from jtexter3, and some additional
	  feedback from mhardeman) ........

2007-06-20 17:52 +0000 [r70198-70360]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c, main/frame.c: Put the speex packetization values back
	  in but disable it when setting up the smoother.

	* main/frame.c: Don't do packetization/smoother stuff with speex,
	  it doesn't work.

2007-06-20 00:03 +0000 [r70084-70164]  Russell Bryant <russell@digium.com>

	* contrib/scripts/ast_grab_core: don't delete the backtrace in
	  ast_grab_core

	* channels/chan_gtalk.c: Only attempt to queue a hangup on the
	  owner channel if it actually exists. (issue #9795, patch from
	  zandbelt)

2007-06-19 18:23 +0000 [r70062]  Steve Murphy <murf@digium.com>

	* main/channel.c, /: Merged revisions 70053 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r70053 | murf | 2007-06-19 12:07:59 -0600 (Tue, 19 Jun 2007) | 1
	  line This fixes 9246, where channel variables are not available
	  in the 'h' exten, on a 'ZOMBIE' channel. The fix is to
	  consolidate the channel variables during a masquerade, and then
	  copy the merged variables back onto the clone, so the zombie has
	  the same vars that the 'original' has. ........

2007-06-19 17:07 +0000 [r70003]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c, /: Merged revisions 69992 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r69992 | file | 2007-06-19 13:00:58 -0400 (Tue, 19 Jun 2007) | 2
	  lines Handle the CC field in the RTP header. (issue #9384
	  reported by DoodleHu) ........

2007-06-19 16:46 +0000 [r69991]  Russell Bryant <russell@digium.com>

	* /: Blocked revisions 69990 via svnmerge ........ r69990 | russell
	  | 2007-06-19 11:45:37 -0500 (Tue, 19 Jun 2007) | 12 lines
	  Backport fix for crashes related to subscriptions from 1.4 ...
	  Fix a crash that could occur when handing device state changes.
	  When the state of a device changes, the device state thread tells
	  the extension state handling code that it changed. Then, the
	  extension state code calls the callback in chan_sip so that it
	  can update subscriptions to that extension. A pointer to a
	  sip_pvt structure is passed to this function as the call which
	  needs a NOTIFY sent. However, there was no locking done to ensure
	  that the pvt struct didn't disappear during this process. (issue
	  #9946, reported by tdonahue, patch by me, patch updated to trunk
	  to use the sip_pvt lock wrappers by eliel) ........

2007-06-19 16:24 +0000 [r69987]  Joshua Colp <jcolp@digium.com>

	* main/channel.c, /: Merged revisions 69986 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r69986 | file | 2007-06-19 12:21:29 -0400 (Tue, 19 Jun 2007) | 2
	  lines Update BRIDGEPEER variable if set to the new channel name
	  when a masquerade happens. (issue #9699 reported by dimas)
	  ........

2007-06-19 15:22 +0000 [r69944]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Fix a crash that could occur when handing
	  device state changes. When the state of a device changes, the
	  device state thread tells the extension state handling code that
	  it changed. Then, the extension state code calls the callback in
	  chan_sip so that it can update subscriptions to that extension. A
	  pointer to a sip_pvt structure is passed to this function as the
	  call which needs a NOTIFY sent. However, there was no locking
	  done to ensure that the pvt struct didn't disappear during this
	  process. (issue #9946, reported by tdonahue, patch by me, patch
	  updated to trunk to use the sip_pvt lock wrappers by eliel)

2007-06-19 13:55 +0000 [r69805-69895]  Joshua Colp <jcolp@digium.com>

	* /, apps/app_meetme.c: Merged revisions 69894 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r69894 | file | 2007-06-19 09:54:03 -0400 (Tue, 19 Jun 2007) | 2
	  lines Perform an extra hangup check just in case. (issue #9589
	  reported by bcnit) ........

	* /, res/res_features.c: Merged revisions 69846 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r69846 | file | 2007-06-19 08:57:55 -0400 (Tue, 19 Jun 2007) | 2
	  lines Add parked call extension AFTER the parking slot has been
	  announced, otherwise two threads will try to handle the same
	  channel and it will go kaboom. (issue #9191 reported by japple)
	  ........

	* main/callerid.c: Fix for building on PowerPC under Linux.

2007-06-18 19:48 +0000 [r69796]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* channels/chan_sip.c: Issue 10005 - Segfault with missing
	  arguments, plus fix a missing define for SIP INFO channels

2007-06-18 19:00 +0000 [r69775-69794]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Don't count RTP timeout when involved in a
	  T38 fax session. (issue #9222 reported by ivoc)

	* /, channels/chan_sip.c: Merged revisions 69765 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r69765 | file | 2007-06-18 14:13:03 -0400 (Mon, 18 Jun 2007) | 2
	  lines Set the peer name on the dialog to the one configured in
	  sip.conf and NOT the username to be used for authentication
	  attempts. (issue #9967 reported by achauvin) ........

2007-06-18 17:46 +0000 [r69744]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* contrib/scripts/safe_asterisk, /: Merged revisions 69743 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r69743 | tilghman | 2007-06-18 12:45:15 -0500 (Mon, 18 Jun 2007)
	  | 2 lines Issue 9998 - Remove SIG prefix, since it's not
	  supported by ksh ........

2007-06-18 16:51 +0000 [r69708]  Joshua Colp <jcolp@digium.com>

	* main/dnsmgr.c: Remember the DNS lookup done when dnsmgr is called
	  for the first time so that it does not needlessly spit out
	  changed messages when the host really didn't change.

2007-06-18 16:35 +0000 [r69689-69702]  Russell Bryant <russell@digium.com>

	* res/res_odbc.c, apps/app_voicemail.c, res/res_config_odbc.c,
	  build_tools/menuselect-deps.in, configure, funcs/func_odbc.c,
	  include/asterisk/autoconfig.h.in, configure.ac, cdr/cdr_odbc.c:
	  To prevent 92138749238754 more reports of "I have unixodbc
	  installed, but still can't build *_odbc.so!", check for ltdl
	  directly, instead of just listing it as another library to
	  include in the unixodbc check in the configure script. This also
	  makes ltdl show up as a dependency in menuselect so people know
	  what to go install. (related to issue #9989, patch by me)

	* build_tools/prep_moduledeps: Change the use of "echo -e" to
	  "printf". On systems where /bin/sh is not bash, most of the lines
	  in menuselect-tree were getting a "-e" at the beginning of every
	  line. I'm surprised nobody noticed this, but I think the XML
	  parser was being very nice and ignoring them.

2007-06-18 16:04 +0000 [r69661-69668]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Don't defer the BYE till later on a transfer
	  when the transfer itself goes kaboom and has no hope of working.

	* channels/chan_sip.c: Few minor transfer tweaks. We can't unlock
	  something we never locked, and better handle a specific scenario
	  with doing an attended transfer between two non-bridged calls.

2007-06-18 15:46 +0000 [r69660]  Russell Bryant <russell@digium.com>

	* Makefile: Tweak paths for BSD systems (issue #10001, stuarth)

2007-06-18 13:55 +0000 [r69625]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Fix issue where it would be possible for the
	  negotiated codecs to get set back to nothing. (issue #9992
	  reported by yehavi)

2007-06-15  Russell Bryant <russell@digium.com>

	* Asterisk 1.4.5 released.

2007-06-15 20:18 +0000 [r69579]  Russell Bryant <russell@digium.com>

	* res/res_features.c: Fix a silly deadlock in res_features that I
	  found while debugging on one of blitzrage's test machines. It was
	  one of the situations where he was seeing hung channels, and may
	  be the cause of some of the reports from other people. (related
	  to issue #9235)

2007-06-15 19:23 +0000 [r69558]  Joshua Colp <jcolp@digium.com>

	* apps/app_speech_utils.c: Add support for setting the maximum
	  length of acceptable DTMF in SpeechBackground.

2007-06-15 15:27 +0000 [r69518]  Russell Bryant <russell@digium.com>

	* apps/app_meetme.c: The SLATRUNK_STATUS variable indicated
	  "SUCCESS" for both an answer of the incoming call on the trunk,
	  or if the trunk reached its ring timeout. This patch changes the
	  variable to say "RINGTIMEOUT" in that case. (issue #9973,
	  reported by n00dle, patch by me)

2007-06-14 23:22 +0000 [r69434-69470]  Jason Parker <jparker@digium.com>

	* main/config.c, /: Merged revisions 69469 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r69469 | qwell | 2007-06-14 18:21:45 -0500 (Thu, 14 Jun 2007) | 4
	  lines Fix an issue where the line number in an unterminated
	  comment block error message would show the wrong line number.
	  "Reported" to me on #asterisk (somebody posted an error message,
	  and I happened to catch it) ........

	* sounds/Makefile: Update to latest versions of sound files.

2007-06-14 21:50 +0000 [r69392]  Kevin P. Fleming <kpfleming@digium.com>

	* cdr/cdr_tds.c, cdr/cdr_csv.c, main/cdr.c, channels/chan_phone.c,
	  cdr/cdr_sqlite.c, main/logger.c, main/callerid.c, cdr/cdr_odbc.c,
	  main/asterisk.c, channels/chan_mgcp.c, cdr/cdr_manager.c,
	  apps/app_voicemail.c, include/asterisk/utils.h, main/pbx.c,
	  main/say.c, cdr/cdr_pgsql.c, cdr/cdr_radius.c,
	  channels/chan_iax2.c: use ast_localtime() in every place
	  localtime_r() was being used

2007-06-14 21:08 +0000 [r69358]  Russell Bryant <russell@digium.com>

	* main/say.c: Fix some problems with saying dates and times for the
	  "tw" langauge (issue #9964, ljmid)

2007-06-14 15:21 +0000 [r69259]  Jason Parker <jparker@digium.com>

	* funcs/func_groupcount.c, /: Merged revisions 69258 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r69258 | qwell | 2007-06-14 10:15:53 -0500 (Thu, 14 Jun
	  2007) | 4 lines Change a quite broken while loop to a for loop,
	  so "continue;" works as expected instead of eating 99% CPU...
	  Issue 9966, patch by me. ........

2007-06-13 21:19 +0000 [r69184-69222]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: Whoops...

	* channels/chan_iax2.c: Let's make chan_iax2 media only native
	  transfers actually work. (issue #9376 reported by simone
	  cittadini)

	* channels/iax2-parser.c: Add TXMEDIA to list so that it is
	  properly displayed during iax2 packet output.

2007-06-13 19:57 +0000 [r69183]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Move the logic for destroying a call when no
	  response is received to a BYE outside of the block that checks
	  for FLAG_FATAL to be set. This flag is only set when the packet
	  is transmitted with the reliability set to XMIT_CRITICAL when the
	  original packet is transmitted. A BYE is always sent with it set
	  to XMIT_RELIABLE, meaning this code could never be encountered.
	  This resulted in seeing some SIP channels that would never go
	  away with the last packet sent being a BYE. (part of issue #9235,
	  patch from jcmoore)

2007-06-13 19:41 +0000 [r69181]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Contains a patch for fixing an encoding
	  problem when using Outlook to view voicemail emails and
	  attachments. This fix has also been tested on Thunderbird,
	  Evolution, Pine, and Mutt. (Issue 9336, reported by marwick,
	  patched by mutterc)

2007-06-13 19:08 +0000 [r69128-69144]  Joshua Colp <jcolp@digium.com>

	* apps/app_meetme.c: Really ignore NULL frames and check whether
	  the channel hungup or not. (issue #9912 reported by junky)

	* /, main/app.c: Merged revisions 69127 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r69127 | file | 2007-06-13 14:12:48 -0400 (Wed, 13 Jun 2007) | 2
	  lines Return group counting to previous behavior where you could
	  only have one group per category. (issue #9711 reported by
	  irroot) ........

2007-06-13 16:56 +0000 [r69016-69071]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Clarify a bit of logic. This doesn't change
	  behavior in any way, but it is helpful when following the logic
	  to debug problems like 9235.

	* channels/chan_iax2.c: Fix a place where a chan_iax2 pvt struct
	  was accessed without the lock held. This issue was reported to me
	  via email by Dmitry Mishchenko. Thanks!

	* cdr/cdr_pgsql.c: Fix a memory leak pointed out by prashant_jois
	  in #asterisk-bugs. PQclear() was not called on the result
	  structure after doing a PQexec(). Also, fix up some formatting in
	  passing.

2007-06-12 19:36 +0000 [r69012-69014]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: Change the full frame dropping log message
	  to debug to avoid future bug reports.

	* channels/chan_iax2.c: Schedule the sending of a PING packet a
	  second later than previously so that it does not collide with the
	  LAGRQ.

2007-06-12 19:13 +0000 [r69010]  Russell Bryant <russell@digium.com>

	* main/channel.c: In ast_channel_make_compatible(), just return if
	  the channels' read and write formats already match up. There are
	  code paths that call this function on a pair of channels multiple
	  times. This made calls fail that were using g729 in some cases.
	  The reason is that codec_g729a will unregister itself from the
	  list of available translators will all licenses are in use. So,
	  the first time the function got called, the right translation
	  path was allocated. However, the second time it got called, the
	  code would not find a translation path to/from g729 and make the
	  call fail, even if the channel actually already had a g729
	  translation path allocated. (SPD-32)

2007-06-12 14:23 +0000 [r68922]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c, /: Merged revisions 68921 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r68921 | file | 2007-06-12 10:18:57 -0400 (Tue, 12 Jun 2007) | 2
	  lines Bring RTP back to Asterisk at the end of a native bridge no
	  matter what. ........

2007-06-11 21:20 +0000 [r68814]  Jason Parker <jparker@digium.com>

	* include/asterisk/time.h: Solaris 10 sometimes (?) needs this
	  include in order to have NULL defined.

2007-06-11 20:45 +0000 [r68781]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_directory.c: Issue 9947 - fn2 was unused / incorrectly
	  used

2007-06-11 16:57 +0000 [r68733]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c, /, channels/misdn/isdn_msg_parser.c:
	  Merged revisions 68732 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r68732 | crichter | 2007-06-11 18:49:00 +0200 (Mo, 11 Jun 2007) |
	  1 line added check for NULL Pointer when calling misdn_new.
	  Asterisk does not allow us to create channels anymore when stop
	  gracefully is used :). also modified the restart_indicator to 0
	  ........

2007-06-11 14:33 +0000 [r68683]  Joshua Colp <jcolp@digium.com>

	* main/channel.c, /: Merged revisions 68682 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r68682 | file | 2007-06-11 10:29:58 -0400 (Mon, 11 Jun 2007) | 2
	  lines Improve deadlock handling of the channel list. (issue #8376
	  reported by one47) ........

2007-06-11 10:29 +0000 [r68644]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/misdn/isdn_lib.h,
	  channels/chan_misdn.c, /, channels/misdn/ie.c,
	  channels/misdn/isdn_msg_parser.c: Merged revisions 68631 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r68631 | crichter | 2007-06-11 11:18:01 +0200 (Mo, 11 Jun 2007) |
	  1 line fixed problem that the dummybc chanels had no lock,
	  checking for the lock now. Also fixed the channel restart stuff,
	  we can now specify and restart particular channels too. ........

2007-06-11 04:21 +0000 [r68595]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* pbx/pbx_config.c: "dialplan save" produced garbage in the config
	  file

2007-06-08 22:23 +0000 [r68527]  Russell Bryant <russell@digium.com>

	* /, apps/app_dictate.c: Merged revisions 68526 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r68526 | russell | 2007-06-08 17:22:36 -0500 (Fri, 08 Jun 2007) |
	  4 lines Don't automatically hang up after running Dictate so that
	  callers can exit cleanly using '#' (closes issue #9577, patch
	  from Thomas Andrews) ........

2007-06-08 15:52 +0000 [r68450]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_iax2.c: actually remember the type/subclass of full
	  frames that are in process

2007-06-08 00:17 +0000 [r68370-68401]  Joshua Colp <jcolp@digium.com>

	* /, main/say.c: Merged revisions 68397 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r68397 | file | 2007-06-07 20:15:33 -0400 (Thu, 07 Jun 2007) | 2
	  lines Don't call ast_waitstream_full when the control file
	  descriptor and audio file descriptor are not set, simply call
	  ast_waitstream! (issue #8530 reported by rickead2000) ........

	* main/dnsmgr.c, /: Merged revisions 68368 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r68368 | file | 2007-06-07 19:59:04 -0400 (Thu, 07 Jun 2007) | 2
	  lines Do a DNS lookup immediately upon calling the dnsmgr
	  function, don't wait until a refresh happens. (issue #9097
	  reported by plack) ........

2007-06-07 23:14 +0000 [r68354]  Russell Bryant <russell@digium.com>

	* /, main/say.c: Merged revisions 68351 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r68351 | russell | 2007-06-07 18:13:33 -0500 (Thu, 07 Jun 2007) |
	  3 lines Fix a problem where saying a character wouldn't properly
	  break out when the caller pressed '#' (issue #8113, reported by
	  patbaker82, patch from jamesgolovich (hey, long time no see!) and
	  patbaker82) ........

2007-06-07 23:00 +0000 [r68326]  Jason Parker <jparker@digium.com>

	* apps/app_voicemail.c: Fix incorrect French syntax of "old
	  messages". Request for feedback was sent to asterisk-dev mailing
	  list, with little response. Issue 9118, patch by junky.

2007-06-07 22:14 +0000 [r68313]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_iax2.c: some improvements to the IAX2 full frame
	  dropping logic recently added: - use inaddrcmp(), since we have
	  it - output the type of frame and subclass being dropped, and the
	  type/subclass that is already being processed (which caused the
	  drop)

2007-06-07 21:16 +0000 [r68280]  Russell Bryant <russell@digium.com>

	* channels/chan_agent.c, apps/app_queue.c: Fix loading persistent
	  queue members when using realtime configuration for queues. Also,
	  remove an unneeded leading slash for the astdb family. (issue
	  #9911, patch by atis)

2007-06-07 20:25 +0000 [r68211-68249]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Fix an issue with newer phones which
	  require packets be padded out to the correct length. Issue 9887,
	  patch by DEA.

	* apps/app_voicemail.c, /: Merged revisions 68204 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r68204 | qwell | 2007-06-07 15:02:50 -0500 (Thu, 07 Jun 2007) | 4
	  lines Don't try to save voicemail greetings unless the user
	  presses '1' to accept/save. Issue 9904, patch by me. ........

2007-06-07 19:47 +0000 [r68198]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Submitting a fix for Issue 8016. Added a
	  check to make sure that greetings get stored properly. (Issue
	  8016, reported by edhorton, patched by alamantia with
	  modification by me. Thanks to Jason Parker for the advice on
	  this).

2007-06-07 19:46 +0000 [r68196]  Olle Johansson <oej@edvina.net>

	* channels/chan_features.c: Disable chan_features by default in
	  menuselect

2007-06-07 19:30 +0000 [r68192]  Russell Bryant <russell@digium.com>

	* main/strcompat.c: Include stdarg.h for build issues on Solaris
	  (issue #9381)

2007-06-07 18:39 +0000 [r68071-68157]  Joshua Colp <jcolp@digium.com>

	* main/channel.c: Fix logic when doing a name based channel search
	  for a structure when you want to start from a specific point in
	  the channel list. (issue #9324 reported by slavon)

	* apps/app_dial.c, /: Merged revisions 68070 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r68070 | file | 2007-06-07 10:19:40 -0400 (Thu, 07 Jun 2007) | 2
	  lines Allow the 'g' option to work if used with the 'S' option.
	  (issue #9888 reported by gasparz) ........

2007-06-07 10:00 +0000 [r67993-68030]  Olle Johansson <oej@edvina.net>

	* res/res_jabber.c: Adding a few Todo's to res_jabber so we don't
	  forget.

	* res/res_jabber.c: Ok, we found out that this is not about if you
	  have any *active* clients using TLS, but if you have initialized
	  TLS at all during the lifetime of the module. So if you reload to
	  disable TLS, it won't help.

	* res/res_jabber.c: If you have a jabber client that uses TLS,
	  refuse unload. Bad fix, but will prevent crashes while we are
	  trying to find a workaround. Iksemel development seems to have
	  stalled and we might have to stop using the TCP/TLS connections
	  in that library and use our own, which would scale better from a
	  poll/select perspective I guess. It would also make it easier to
	  migrate to OpenSSL and stop Asterisk from depending on both
	  OpenSSL and GnuTLS.

	* include/asterisk/jabber.h, res/res_jabber.c: Issue #9738 - Make
	  sure we can unload res_jabber. Patch by phsultan - thanks! Due to
	  a bug in the iksemel library, this will not work if you are using
	  GTLS in the connection. That's being investigated. If you figure
	  out a way to handle that without us having to patch iksemel, let
	  us know in the bug report. Thanks.

2007-06-07 00:10 +0000 [r67924-67941]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 67938 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r67938 | file | 2007-06-06 20:09:13 -0400 (Wed, 06 Jun 2007) | 2
	  lines Only notify the devicestate system of a peer state change
	  when the peer is built from the config file. (issue #9900
	  reported by arkadia) ........

	* main/file.c: Properly handle cases where a stream can't be
	  written to. (issue #9757 reported by junky)

2007-06-06 22:08 +0000 [r67862-67872]  Russell Bryant <russell@digium.com>

	* res/res_snmp.c: Disable reload functionality in res_snmp. It is
	  not possible to initialize the snmp library more than once
	  without completely unloading the module and loading it again.
	  (issue #9571, reported by hristo, additional helpful debug
	  information from festr, patch from me)

	* channels/chan_sip.c: Fix a crash when doing call pickups with SIP
	  phones. The code unlocked the channel when it should not have.
	  (issue #9652, reported by corruptor, fixed by me)

2007-06-06 19:26 +0000 [r67804]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Fix for Issue 9810. There was a segfault
	  under a specific set of circumstances: 1. VoiceMailMain was
	  configured in the dialplan with an extension as its argument 2. A
	  message was left for this mailbox 3. Tried to call VoiceMailMain
	  but hung up before entering password. This was fixed by checking
	  that a pointer was non-null prior to trying to dereference it.
	  (Issue 9810, reported by xmarksthespot, patched by Corydon76 with
	  modifications by me).

2007-06-06 16:55 +0000 [r67716]  Russell Bryant <russell@digium.com>

	* main/channel.c, /, include/asterisk/linkedlists.h: Merged
	  revisions 67715 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r67715 | russell | 2007-06-06 11:40:51 -0500 (Wed, 06 Jun 2007) |
	  5 lines We have some bug reports showing crashes due to a double
	  free of a channel. Add a sanity check to ast_channel_free() to
	  make sure we don't go on trying to free a channel that wasn't
	  found in the channel list. (issue #8850, and others...) ........

2007-06-06 13:30 +0000 [r67594-67650]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c, /: Merged revisions 67649 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r67649 | file | 2007-06-06 09:28:34 -0400 (Wed, 06 Jun 2007) | 2
	  lines Reinvite the RTP back to the Asterisk machine when the
	  timeout happens. (issue #9888 reported by gasparz) ........

	* main/translate.c: Fix plc_samples warning when registering a
	  translator. (issue #9897 reported by xylome)

	* apps/app_directed_pickup.c: Include macroexten while searching
	  for a channel to pick up in case they are in a macro. (issue
	  #9491 reported by jamesb63)

	* res/res_agi.c: Make the new "agi debug off" CLI command work.
	  (issue #9890 reported by eliel)

	* /, main/devicestate.c: Merged revisions 67593 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r67593 | file | 2007-06-06 08:18:36 -0400 (Wed, 06 Jun 2007) | 2
	  lines Revert channel name splitting fix for Zap. The moral of the
	  story is don't use - in your user/peer names. (issue #9668
	  reported by stevedavies) ........

2007-06-05 23:01 +0000 [r67558]  Russell Bryant <russell@digium.com>

	* apps/app_meetme.c: Fix some crashes related to the use of the
	  "meetme" CLI command. The code for this command was not locking
	  the conference list at all. (issue #9351, reported by and patch
	  submitted by Junk-Y, committed patch is different and by me)

2007-06-05 21:30 +0000 [r67526]  Steve Murphy <murf@digium.com>

	* pbx/ael/ael.tab.c, pbx/ael/ael.y, pbx/pbx_ael.c: this fixes bug
	  9883, wherein macros were not allowing the includes construct.
	  fixed and tested, looks OK. Now includes can serve as an adjunct
	  to catch.

2007-06-05 20:53 +0000 [r67457-67492]  Russell Bryant <russell@digium.com>

	* include/asterisk/linkedlists.h: This bug has been hanging over my
	  head ever since I wrote this SLA code. Every time I tried to go
	  debug it by adding some debug output, the behavior would change.
	  It turns out I wasn't crazy. I had the following piece of code:
	  if (remove) AST_LIST_REMOVE_CURRENT(...); Well,
	  AST_LIST_REMOVE_CURRENT was not wrapped in braces, so my
	  conditional statement didn't do much good at all. It always ran
	  at least all of the macro minus the first statement, so I was
	  seeing list entries magically disappear when they weren't
	  supposed to. After many hours of debugging, I have come to this
	  extremely irritating fix. :) (issues #9581, #9497)

	* channels/chan_zap.c: Suppress a bunch of debug output unless
	  option_debug is on

2007-06-05 18:32 +0000 [r67424]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Fix for bug number 9786, wherein voicemails
	  saved to IMAP storage using extensions other than gsm were unable
	  to be played over the phone. (Issue 9786, reporter:
	  xmarksthespot, Patched by xmarksthe spot with revisions by me,
	  reviewed by Russell Bryant).

2007-06-05 18:18 +0000 [r67421]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Correctly update date/time on devices
	  throughout the life of the device, instead of just at
	  registration. Issue 9152, yet another patch by DEA.

2007-06-05 18:17 +0000 [r67420]  Steve Murphy <murf@digium.com>

	* pbx/pbx_ael.c: Added code to automatically add a default case to
	  switches that don't have one. In some cases, rather than fall
	  thru, it results in a goto with -1 result, which terminates the
	  extension; a sort of dialplan seqfault, sort of. This was
	  required to fix bug reported in 9881

2007-06-05 17:07 +0000 [r67360-67372]  Russell Bryant <russell@digium.com>

	* main/channel.c: Handle a failure in malloc() in
	  ast_safe_string_alloc()

	* main/channel.c: Fix a problem that showed itself by causing Zap
	  channel names to be completely bogus on my machine.
	  ast_safe_string_alloc() was broken. It called vsnprintf() on a
	  va_args list twice without re-initializing it. After the first
	  usage, va_end() and va_start() must be called again.

2007-06-05 16:14 +0000 [r67329-67334]  Christian Richter <christian.richter@beronet.com>

	* /, channels/misdn/chan_misdn_config.h: Merged revisions 67307 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r67307 | crichter | 2007-06-05 17:42:03 +0200 (Di, 05 Jun 2007) |
	  1 line briding is a bool, fixed copy and paste issue. ........

	* channels/chan_misdn.c, /: Merged revisions 67306 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r67306 | crichter | 2007-06-05 17:39:43 +0200 (Di, 05
	  Jun 2007) | 1 line simplified the EVENT_SETUP handling in the
	  cb_events function a lot. Commented the different possibilities a
	  bit and made functions of shared code. When the dialed extension
	  does not exist in the extensions.conf we'll jump into the 'i'
	  extension if this does exist, else we disconnect the call with
	  the cause:1 = No Route to Destination. ........

2007-06-05 15:51 +0000 [r67308]  Russell Bryant <russell@digium.com>

	* main/asterisk.c, main/loader.c, include/asterisk/module.h: When
	  shutting down "gracefully", go through and run the unload()
	  callbacks for all of the modules. "stop now" is considered a
	  non-graceful shutdown and will not go through this process.
	  (issue #9804, reported by chrisost, patch by me)

2007-06-05 15:22 +0000 [r67304]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: Only muck with the thread structure if an
	  idle one was found/created.

2007-06-05 14:35 +0000 [r67270]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_iax2.c: ensure that a burst of full frames
	  (AST_FRAME_DTMF being the prime example) will not be processed
	  out of order... this is a brute force fix, but seems to be the
	  safest fix for now (thanks to the Digium PQ department for
	  finding this bug)

2007-06-05 10:25 +0000 [r67210]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn_config.c, channels/chan_misdn.c, /,
	  channels/misdn/chan_misdn_config.h: Merged revisions 67209 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r67209 | crichter | 2007-06-05 12:05:45 +0200 (Di, 05 Jun 2007) |
	  1 line added possibility to deactivate bridging per port ........

2007-06-04 23:43 +0000 [r67162]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, funcs/func_math.c: Merged revisions 67161 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r67161 | tilghman | 2007-06-04 18:41:49 -0500 (Mon, 04 Jun 2007)
	  | 2 lines According to MATH, 0+1181000386 = 1181000448. Oops.
	  ........

2007-06-04 23:31 +0000 [r67158]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Fix up a bunch of places where the iax2 pvt
	  structure can disappear and the code did not account for it and
	  crashes. (issues #9642, #9569, #9666, probably others ... based
	  on the work by stevedavies and mihai, with additional changes
	  from me)

2007-06-04 23:26 +0000 [r67121-67156]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Fix for skinny keepalives. If there is no
	  traffic from the phone for (keep_alive * 1100) ms (arbitrarily
	  adding 10% for network issues, etc), unregister the device. Issue
	  8394, patch by DEA.

	* channels/chan_mgcp.c: Fixes for dtmf/dialing with mgcp (similar
	  to the recent fix for chan_skinny) Issue 9855, patch by DEA.

2007-06-04 22:28 +0000 [r67119]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Add comments for two functions that get
	  called with the appropriate call locked, but perform operations
	  that could result in the pvt structure getting destroyed before
	  returning again, causing numerous seg faults all over the module.
	  (inspired by issues #9642, #9569, and #9666, and the work done by
	  stevedavies and mihai)

2007-06-04 21:59 +0000 [r67073]  Steve Murphy <murf@digium.com>

	* main/cdr.c: This typo has been here since 1.4 forked. It has been
	  the source of heartburn to many a dialplan/CDR programmer.

2007-06-04 21:47 +0000 [r67071]  Russell Bryant <russell@digium.com>

	* main/rtp.c: Add a missing \n. (pointed out by jcmoore on IRC)

2007-06-04 19:31 +0000 [r67064-67068]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Better handle SIP devices that say they have
	  SDP content... but really don't. (issue #9398 reported by
	  mthomasslo)

	* apps/app_dial.c: Initialize cidname variable to nothing since it
	  may be used without having been touched. (issue #9661 reported by
	  dimas)

	* res/res_features.c: Returning a value that indicates the parking
	  of a call was a success when it really wasn't (because the
	  parking slot selected was in use) is the wrong thing to do.
	  (issue #9723 reported by mdu113)

2007-06-04 17:11 +0000 [r67061]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* contrib/init.d/rc.debian.asterisk,
	  contrib/init.d/rc.mandrake.asterisk, /,
	  contrib/init.d/rc.redhat.asterisk,
	  contrib/init.d/rc.gentoo.asterisk,
	  contrib/init.d/rc.mandrake.zaptel,
	  contrib/init.d/rc.slackware.asterisk: Merged revisions 67060 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r67060 | tilghman | 2007-06-04 12:10:30 -0500 (Mon, 04 Jun 2007)
	  | 2 lines Add revision Id tags (by request of tzafrir) ........

2007-06-04 16:02 +0000 [r67026]  Russell Bryant <russell@digium.com>

	* configure, configure.ac: Change the configure script to build a
	  test program against libcurl to make sure the results from
	  curl-config can be used to compile successfully. This is intended
	  to help prevent a situation where you are cross compiling, and
	  the configure script finds the curl library installed on the
	  host. (issue #9865, reported and patched by zandbelt)

2007-06-04 15:50 +0000 [r67021]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* res/res_jabber.c: Issue 9739 - Malformed jid causes a crash

2007-06-04 15:47 +0000 [r67018-67020]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Resolve a deadlock in chan_iax2. When
	  handling an implicit ACK to a frame that was marked as the final
	  transmission for a call, don't call iax2_destroy() for that call
	  while the global frame queue is still locked. There is a very
	  nice explanation of the deadlock in the report. (issue #9663,
	  thorough report and patch from stevedavies, additional positive
	  test reports from mihai and joff_oconnell)

	* include/asterisk/stringfields.h: Fix some compiler warnings in
	  C++ modules. (issue #9866, reported by osk, patch by Corydon76)

2007-06-01 21:45 +0000 [r66919]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* funcs/func_odbc.c: On some drivers, deallocating the statement
	  handle isn't enough. We also have to clear the cursor (nice,
	  Oracle)

2007-06-01 21:31 +0000 [r66897-66917]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Removing extraneous debugging lines from
	  revision 66897. Sorry :)

	* apps/app_voicemail.c: Submitting a fix for voicemail with IMAP
	  storage. Attachments with format specified as gsm were duplicated
	  (i.e. two attachments) were left. Thank you very much to
	  xmarksthespot for submitting the patch that fixed this. (Issues
	  9787 and 8873, Reported by xmarksthespot and jerjer, patched by
	  xmarksthespot)

2007-06-01 19:41 +0000 [r66879-66881]  Russell Bryant <russell@digium.com>

	* channels/chan_skinny.c: Changes to the way DTMF is handled in the
	  core broke dialing in chan_skinny. This patch makes chan_skinny
	  usable again. I did not end up testing this, but there are
	  multiple positive test reports listed in the bug report. (issue
	  #9596, reported by pj, testing by pj and mvanbaak, and the fix
	  was written by DEA)

	* apps/app_page.c: List app_meetme as a module that app_page
	  depends on.

2007-05-31 23:03 +0000 [r66821]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* doc/asterisk.8: Issue 9850 - update preferred command line syntax

2007-05-31 18:41 +0000 [r66775]  Russell Bryant <russell@digium.com>

	* res/res_speech.c, include/asterisk/app.h,
	  include/asterisk/speech.h: Change a couple of header files to not
	  use "new", which is a reserved keyword in C++. (issue #9830,
	  reported by osk)

2007-05-31 17:15 +0000 [r66770]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, apps/app_macro.c: Merged revisions 66744 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r66744 | tilghman | 2007-05-31 10:58:45 -0500 (Thu, 31 May 2007)
	  | 2 lines Issue 9818 - Fix for issue 8329 breaks pbx_realtime.
	  Issue 8329 will remain unfixed for pbx_realtime, but only because
	  we lack core API to do it. ........

2007-05-31 16:14 +0000 [r66768]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 66764 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r66764 | file | 2007-05-31 12:12:39 -0400 (Thu, 31 May 2007) | 2
	  lines It is now possible for this path of execution to have the
	  frame pointer be NULL, therefore we need to check for it before
	  trying to access it. (issue #9836 reported by barthpbx) ........

2007-05-30 23:26 +0000 [r66671]  Mark Michelson <mmichelson@digium.com>

	* apps/app_voicemail.c: Fixed seg-faults when recording greetings
	  in voicemail with IMAP enabled. (Issue No. 9735, reported by
	  xmarksthespot, patched by me)

2007-05-30 17:28 +0000 [r66602-66639]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Silly me for having out of date source! Oh
	  well... I'm still leaving my comment.

	* channels/chan_sip.c: When calling some peer/host that may not
	  exist/reply back... don't keep the dialog in memory for all of
	  eternity.

	* channels/chan_zap.c, channels/chan_features.c: Change how channel
	  names are generated a bit. (issue #9825 reported by eldadran)

2007-05-29 21:56 +0000 [r66538]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, funcs/func_strings.c: Merged revisions 66537 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r66537 | tilghman | 2007-05-29 16:49:35 -0500 (Tue, 29 May 2007)
	  | 2 lines If the value of a variable passed to FIELDQTY is blank,
	  then FIELDQTY should return 0, not 1. ........

2007-05-29 19:32 +0000 [r66474-66503]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Properly handle 408 request timeout -
	  according to the RFC, the dialog dies if a request in a dialog
	  gets this response.

	* channels/chan_sip.c: Don't issue hangup on hangup on hangup on
	  hangup (for jcmoore)

2007-05-29 16:44 +0000 [r66437]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Handle cases where a frame may have no data. (issue
	  #9519 reported by dmb)

2007-05-29 16:07 +0000 [r66404-66414]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Don't reset hangupcause if we already have
	  one

	* channels/chan_sip.c: Tracking down hanging channels, killing them
	  one by one. Issue #9235 and related

2007-05-29 15:43 +0000 [r66398]  Joshua Colp <jcolp@digium.com>

	* doc/datastores.txt: Update datastores documentation. (issue #9801
	  reported by mnicholson)

2007-05-29 09:41 +0000 [r66363]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Merged revisions 66349 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r66349 | oej | 2007-05-29 09:53:14 +0200 (Tue, 29 May 2007) | 2
	  lines Issue #9802 - Change inuse counter on CANCEL ........

2007-05-28 23:16 +0000 [r66312]  Joshua Colp <jcolp@digium.com>

	* channels/chan_zap.c: Make the usedistinctiveringdetection option
	  work again. (issue #9823 reported by premeau)

2007-05-27 04:12 +0000 [r66244]  Jason Parker <jparker@digium.com>

	* channels/chan_zap.c: I don't know what this was trying to do, but
	  it's clearly incorrect. Issues 9808 and 9809.

2007-05-25 14:43 +0000 [r66160]  Kevin P. Fleming <kpfleming@digium.com>

	* configure, configure.ac: have to check for OSP toolkit _after_
	  checking for OpenSSL

2007-05-25 14:41 +0000 [r66159]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, main/say.c: Merged revisions 66127 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r66127 | tilghman | 2007-05-25 08:46:35 -0500 (Fri, 25 May 2007)
	  | 2 lines Issue 9791 - Fix pronunciation of seconds in Dutch
	  ........

2007-05-25 14:28 +0000 [r66157]  Kevin P. Fleming <kpfleming@digium.com>

	* configure, configure.ac, channels/chan_gtalk.c, makeopts.in,
	  res/res_jabber.c: handle the GNUTLS library properly in the
	  configure script and build system don't build in OSP support
	  unless we have found and are allowed to use SSL support

2007-05-24 22:23 +0000 [r66076]  Russell Bryant <russell@digium.com>

	* main/channel.c: if the string field init fails, clean up the
	  stuff that was allocated already

2007-05-24 22:16 +0000 [r66074]  Joshua Colp <jcolp@digium.com>

	* main/slinfactory.c: Fix slinfactory logic when dealing with
	  frames coming in that may already be in the signed linear format.

2007-05-24 22:07 +0000 [r66068-66070]  Russell Bryant <russell@digium.com>

	* main/channel.c: Check the result of ast_string_field_init() in
	  ast_channel_alloc()

	* main/rtp.c: Make 1.4 build on my machine, too..

2007-05-24 20:54 +0000 [r66029-66030]  Jason Parker <jparker@digium.com>

	* configure: Rebuild configure script for previous ar fix.

	* configure.ac: Following moving strip to AC_PATH_TOOL, we need to
	  do something similar for ar.

2007-05-24 20:42 +0000 [r65978-66026]  Russell Bryant <russell@digium.com>

	* configure, include/asterisk/autoconfig.h.in, configure.ac:
	  Checking for the strip application needs to be done with
	  AC_PATH_TOOL instead of AC_PATH_PROG to properly handle cross
	  compilation environments.

	* Makefile: Clear CFLAGS before running make for menuselect. (issue
	  #9784, reported by ovi, patch by me)

2007-05-24 18:28 +0000 [r65965-65967]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_gtalk.c: oops, use #ifdef instead of #if

	* channels/chan_gtalk.c: don't reference GnuTLS headers and
	  functions unless the configure script found it

	* main/rtp.c: don't use uninitialized variables

2007-05-24 15:27 +0000 [r65902]  Joshua Colp <jcolp@digium.com>

	* main/manager.c: Add the ability to blacklist certain commands
	  from being executed using the Command AMI action. (issue #9240
	  reported by junky)

2007-05-24 15:26 +0000 [r65892-65901]  Olle Johansson <oej@edvina.net>

	* channels/chan_gtalk.c: Issue 7672 - fix by zandbelt - Asterisk
	  core dump since the GnuTLS interface did not support
	  multithreading correctly.

	* channels/chan_gtalk.c: Issue 8193 - NAT issues with gtalk/STUN.
	  Patch by phsultan. Thanks!

2007-05-24 15:16 +0000 [r65877-65883]  Jason Parker <jparker@digium.com>

	* .cleancount: Update cleancount for that last commit - just for
	  good measure.

	* include/asterisk/translate.h, codecs/codec_speex.c,
	  main/translate.c, codecs/codec_ilbc.c: Fix handling of
	  zero-length frames when a codec is capable of native PLC. Issue
	  9183, patch by Mihai.

2007-05-24 15:08 +0000 [r65866]  Dwayne M. Hubbard <dhubbard@digium.com>

	* funcs/func_math.c: merged qwell's func_math patch for issue 9507

2007-05-24 15:08 +0000 [r65863]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: I like it when the RTP stack compiles myself...

2007-05-24 15:05 +0000 [r65857]  Olle Johansson <oej@edvina.net>

	* channels/chan_gtalk.c: Issue 7686, fix by phsultan, NAT issues
	  when calling from gtalk to SIP over nat.

2007-05-24 15:04 +0000 [r65842-65853]  Russell Bryant <russell@digium.com>

	* apps/app_festival.c: Ensure that frames are fully initialized.
	  This will probably fix getting weird timestamp log messages in
	  logs when using the Festival app. (issue #9781, patch by me)

	* main/rtp.c: Fix the calculation of the RTT for RTCP. The previous
	  code would result in oscillating and incorrect data.
	  Additionally, the RTT would sometimes report negative values due
	  to incorrect calculations. (issue #9601, patch from davetroy)

2007-05-24 14:48 +0000 [r65841]  Olle Johansson <oej@edvina.net>

	* channels/chan_gtalk.c: Issue #8536 - Caller ID not set in CDR for
	  jingle

2007-05-24 14:42 +0000 [r65839]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 65837 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r65837 | file | 2007-05-24 10:40:38 -0400 (Thu, 24 May 2007) | 2
	  lines Allow RFC2833 to be negotiated when an INVITE comes in
	  without SDP and is not matched to a user or peer. (issue #9546
	  reported by mcrawford) ........

2007-05-24 14:38 +0000 [r65836]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c, res/res_jabber.c: Issue 8409 - phsultan -
	  Fix "login" as component to jabber server. ...and, by accident,
	  fix a bug in chan_sip for stopping a loop on retransmits of BYE
	  requests.

2007-05-24 09:37 +0000 [r65768]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c, /: Merged revisions 65767 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r65767 | crichter | 2007-05-24 11:19:58 +0200 (Do, 24
	  Mai 2007) | 1 line we should only activate the generator in
	  chan_misdn, when asterisk hask not yet taken the call
	  (WAITING4DIGS state). Alerting audio will be generated fomr
	  asterisk for example. ........

2007-05-23 20:59 +0000 [r65677-65685]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_iax2.c: start the delayed PBX when receive voice or
	  video full frames as well, and comment this delayed-PBX activity

	* /, channels/chan_sip.c: Merged revisions 65682 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r65682 | kpfleming | 2007-05-23 16:46:22 -0400 (Wed, 23 May 2007)
	  | 2 lines ensure that variables are set on a newly created
	  channel before we start a PBX on it ........

	* channels/chan_iax2.c: clear the 'delay PBX' flag when we are
	  ready to start the PBX

	* channels/chan_iax2.c: don't start a PBX on a new incoming IAX2
	  channel until we have some sort of response to our ACCEPT (ACK or
	  anything else)

	* /, channels/chan_iax2.c: Merged revisions 65676 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r65676 | kpfleming | 2007-05-23 16:06:13 -0400 (Wed, 23 May 2007)
	  | 2 lines if we are going to set variables on a newly created
	  channel, it should be done *before* we start the PBX on it
	  ........

2007-05-23 13:07 +0000 [r65589]  Russell Bryant <russell@digium.com>

	* channels/chan_zap.c, /: Merged revisions 65588 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r65588 | russell | 2007-05-23 08:06:17 -0500 (Wed, 23 May 2007) |
	  3 lines Revert revision 62417 as someone reported problems with
	  it to Mark. This was related to issue #9588. ........

2007-05-22 20:25 +0000 [r65541]  Kevin P. Fleming <kpfleming@digium.com>

	* build_tools/make_version: when building a version string for a
	  developer branch, include the base branch in the version string

2007-05-22 18:40 +0000 [r65501]  Russell Bryant <russell@digium.com>

	* apps/app_voicemail.c, channels/chan_zap.c: List res_smdi as a
	  dependency for app_voicemail and chan_zap (Thanks to mnicholson
	  for pointing it out)

2007-05-22 15:04 +0000 [r65452]  Joshua Colp <jcolp@digium.com>

	* apps/app_meetme.c: Remove a double const.

2007-05-22 14:02 +0000 [r65408]  BJ Weschke <bweschke@btwtech.com>

	* apps/app_followme.c: Fix a problem with flag recognition.

2007-05-22 13:09 +0000 [r65394]  Russell Bryant <russell@digium.com>

	* /, apps/app_queue.c: Merged revisions 65389 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r65389 | russell | 2007-05-22 08:07:03 -0500 (Tue, 22 May 2007) |
	  4 lines Fix a memory leak that I just noticed in the device state
	  handling in app_queue. On most device state changes, it would
	  leak roughly 8 to 64 bytes (the length of the name of the
	  device). ........

2007-05-22 08:12 +0000 [r65342]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c, /: Merged revisions 65328 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r65328 | crichter | 2007-05-22 09:46:39 +0200 (Di, 22
	  Mai 2007) | 1 line we stop the tones only when we're in the
	  pre-call phase, otherwise e.g. when in CONNECTED state we should
	  not stop tones when we receive an Information Message ........

2007-05-20 17:59 +0000 [r65250]  Joshua Colp <jcolp@digium.com>

	* res/res_agi.c: res_agi needs to export two symbols
	  (ast_agi_register and ast_agi_unregister) for usage by others.
	  (issue #9755 reported by mnicholson)

2007-05-18 22:26 +0000 [r65200-65201]  Steve Murphy <murf@digium.com>

	* main/cdr.c: Ugh. The svnmerge didn't catch the shift from cdr.c
	  to main/cdr.c, and neither did I. This is the remainder of the
	  9717 patch, the fix for the run-away FAIL status for a call

	* apps/app_dial.c, /, include/asterisk/cdr.h: Merged revisions
	  65172 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r65172 | murf | 2007-05-18 14:56:20 -0600 (Fri, 18 May 2007) | 1
	  line This update will fix the situation that occurs as described
	  by 9717, where when several targets are specified for a dial, if
	  any one them reports FAIL, the whole call gets FAIL, even though
	  others were ringing OK. I rearranged the priorities, so that a
	  new disposition, NULL, is at the lowest level, and the
	  disposition get init'd to NULL. Then, next up is FAIL, and next
	  up is BUSY, then NOANSWER, then ANSWERED. All the related set
	  routines will only do so if the disposition value to be set to is
	  greater than what's already there. This gives the intended
	  effect. So, if all the targets are busy, you'd get BUSY for the
	  call disposition. If all get BUSY, but one, and that one rings is
	  not answered, you get NOANSWER. If by some freak of nature, the
	  NULL value doesn't get overridden, then the disp2str routine will
	  report NOANSWER as before. ........

2007-05-18 18:16 +0000 [r65041-65123]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Merged revisions 65122 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r65122 | oej | 2007-05-18 20:10:46 +0200 (Fri, 18 May 2007) | 2
	  lines Not getting an ACK to a 200 OK in the initial invite is
	  critical to the call. ........

	* /, channels/chan_sip.c: Merged revisions 65075 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r65075 | oej | 2007-05-18 17:12:09 +0200 (Fri, 18 May 2007) | 5
	  lines Issue 9235 - part of the problem, maybe not all. Please
	  retry with this patch (and no other patch) if you have problems
	  with hanging SIP channels. Thank you. A special Thank You to
	  WeBRainstorm that gave me access to his system. ........

	* channels/chan_sip.c: - Adding support for putting calls OFF hold
	  with a re-invite with blank SDP. This was a bug found while doing
	  tests at SIPit in Antwerp. - In order to not duplicate code, I
	  restructured some of the code for putting calls on/off hold.
	  Thanks DEA for reminding me. This fix has been asleep in the
	  videocaps branch until now.

2007-05-18 12:40 +0000 [r65039]  Christian Richter <christian.richter@beronet.com>

	* /, channels/misdn/ie.c, channels/misdn/isdn_msg_parser.c: Merged
	  revisions 65007 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r65007 | crichter | 2007-05-18 13:23:11 +0200 (Fr, 18 Mai 2007) |
	  1 line fixed a warning regarding Keypad encoding. encode the IE
	  sending_complete at the right position. ........

2007-05-18 10:37 +0000 [r64974]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Issue 9487 - stop media flows at hangup of
	  call

2007-05-18 08:58 +0000 [r64904]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c, /: Merged revisions 64902 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r64902 | crichter | 2007-05-18 10:24:08 +0200 (Fr, 18
	  Mai 2007) | 1 line we *need* to send a PROCEEDING when
	  sending_complete is set, even if need_more_infos is requested.
	  ........

2007-05-18 02:48 +0000 [r64868]  Russell Bryant <russell@digium.com>

	* apps/app_queue.c: Fix a small bug I noticed while working on
	  something else. app_queue did not unregister its device state
	  monitoring callback in unload_module(). So, this would make
	  Asterisk crash on the first device state change after you unload
	  the module.

2007-05-17 21:19 +0000 [r64820]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, include/asterisk/linkedlists.h: Merged revisions 64819 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r64819 | tilghman | 2007-05-17 16:14:36 -0500 (Thu, 17 May 2007)
	  | 2 lines How is it that we never caught that this is returning
	  the opposite of our documentation, until now? ........

2007-05-17 16:53 +0000 [r64761]  Jason Parker <jparker@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 64758 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r64758 | qwell | 2007-05-17 11:52:38 -0500 (Thu, 17 May 2007) | 4
	  lines If we have a negative current message, we shouldn't go back
	  even further... Issue 9727. ........

2007-05-17 16:52 +0000 [r64756-64759]  Russell Bryant <russell@digium.com>

	* contrib/scripts/astxs (removed): Remove script that is no longer
	  functional since the build system was redone. (issue #9340,
	  reported by junky)

	* apps/app_dial.c: Increase the size of a buffer to support longer
	  dial strings for channels. (issue #9291, reported and fix
	  suggested by meni)

2007-05-17 16:10 +0000 [r64720-64754]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Even more direct RTP setup fixes! Don't
	  allow a codec that isn't supported to creep into the SDP of
	  either side. (issue #9446 reported by marcelbarbulescu)

	* apps/app_voicemail.c: Fix authuser support. (issue #9740 reported
	  by xmarksthespot)

2007-05-17 06:13 +0000 [r64686]  Russell Bryant <russell@digium.com>

	* README: Update the main README to reflect the new build process
	  for 1.4 and above. (issue #9725, patch by eliel)

2007-05-16 11:01 +0000 [r64516-64609]  Olle Johansson <oej@edvina.net>

	* /: Blocking patch already in this code

	* channels/chan_sip.c: Fix auth on BYE. (Different patch than for
	  1.2)

	* channels/chan_sip.c: Issue #9681 - Handle www-auth on BYE

	* channels/chan_sip.c: Final part of issue #9483 - fixing
	  transfer() of sip calls in the dial plan (twilson)

	* channels/chan_sip.c: Issue #9439 - properly handle username
	  parameters in SIP uri.

	* /, channels/chan_sip.c: Merged revisions 64535 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r64535 | oej | 2007-05-16 11:08:22 +0200 (Wed, 16 May 2007) | 2
	  lines Support SIP uri's starting with SIP: and sip: (reported by
	  Tony Mountfield on the mailing list. Thanks!) ........

	* /, channels/chan_sip.c: Merged following patch with a lot of
	  changes for 1.4 ------ Merged revisions 64514 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r64514 | oej | 2007-05-16 10:25:56 +0200 (Wed, 16 May 2007) | 6
	  lines Issue #9726 - rlister - Better logging for ACL denials
	  While at it, also added better logging and handling of peers that
	  are not supposed to register. My patch, stole the issue report
	  from Russell. My apologies, Russell :-) ........

2007-05-16 08:44 +0000 [r64515]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c, /: Merged revisions 64513 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r64513 | crichter | 2007-05-16 10:23:42 +0200 (Mi, 16
	  Mai 2007) | 1 line in the case immediate=yes, we directly jump
	  into the dialplan, where people can use PlayTones to indicate a
	  Dialtone, so we don't need to to that by ourself. also we should
	  not do a dialtone_indicate for incoming calls on a TE port in
	  overlapdialmode. ........

2007-05-15 19:52 +0000 [r64353-64426]  Russell Bryant <russell@digium.com>

	* res/res_features.c: Properly fix a problem that occurs when you
	  set PARKINGEXTEN to an exten where a call is already parked.
	  (issue #9723, patch by me)

	* res/res_features.c: When someone requests a specific parking
	  space using the PARKINGEXTEN variable, ensure that no other
	  caller is already there. (issue #9723, reported by mdu113, patch
	  by me)

2007-05-14 19:26 +0000 [r64324]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Change -2 to XMIT_ERROR to clarify a bit
	  more

2007-05-14 19:13 +0000 [r64306]  Russell Bryant <russell@digium.com>

	* channels/chan_alsa.c: Properly handle AST_CONTROL_PROGRESS by
	  just ignoring it. An unknown indication will trigger an error and
	  cause sounds to stop, which in this case, is ringing.

2007-05-14 18:52 +0000 [r64280]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Handle network errors, like host or network
	  unreachable, in a better way. This means that calls to hosts or
	  qualify (OPTION) messages will fail quicker if the TCP/IP stack
	  tells us that there is an issue. Since this is an unconnected UDP
	  socket, we will not get error messages directly in most cases,
	  but maybe on the second and third try. This is already
	  implemented in trunk.

2007-05-14 18:48 +0000 [r64240-64278]  Joshua Colp <jcolp@digium.com>

	* codecs/codec_speex.c: Properly set datalen field when doing PLC
	  in codec_speex. (issue #9722 reported by mihai)

	* /, main/devicestate.c: Merged revisions 64275 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r64275 | file | 2007-05-14 14:34:06 -0400 (Mon, 14 May 2007) | 2
	  lines Only perform stripping of - strings from the channel name
	  for Zap channels. Anywhere else we might remove a legitimate part
	  of a device name. (issue #9668 reported by stevedavies) ........

	* main/channel.c: Fix scenario where if a phone that simply called
	  Echo() put itself on hold it could never get off hold.

2007-05-14 13:58 +0000 [r64193]  Steve Murphy <murf@digium.com>

	* main/cdr.c, main/pbx.c, channels/chan_local.c: As per 9570,
	  worrisome CDR warnings have been removed, that are either not
	  helpful, or not relevant.

2007-05-14 10:39 +0000 [r64157]  Olle Johansson <oej@edvina.net>

	* main/channel.c: Add hangupcause when we lack codecs for
	  transcoding

2007-05-12 22:27 +0000 [r64044-64114]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: This concludes my final adventure with
	  bitmasks and the onhold flag. Would anyone care for some peanuts?

	* channels/chan_sip.c: Tweak hold flags some more. They can be of
	  three states when active: active, inactive, one direction.

	* channels/chan_sip.c: Ensure the onhold flag is set no matter what
	  when being put on hold.

2007-05-11 20:16 +0000 [r63982]  Jason Parker <jparker@digium.com>

	* main/manager.c: Hide manager password from "manager show user
	  foo". I realize that there are other ways to get this, but we
	  really don't need to just show it in plain text so easily. Issue
	  9273, patch by junky

2007-05-11 16:35 +0000 [r63905]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* contrib/scripts/safe_asterisk, Makefile, /: Merged revisions
	  63903 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r63903 | tilghman | 2007-05-11 11:31:03 -0500 (Fri, 11 May 2007)
	  | 2 lines Issue 9121 - fixups for safe_asterisk script ........

2007-05-11 16:05 +0000 [r63886]  Russell Bryant <russell@digium.com>

	* main/manager.c: When MD5 authentication is not possible because
	  there is no challenge present, either because the Challenge
	  action was never issued, or some other reason, give a proper
	  error message and return an error instead of claiming that the
	  user wasn't found. (reported by jsmith on IRC)

2007-05-11 15:43 +0000 [r63872]  Joshua Colp <jcolp@digium.com>

	* res/res_features.c: Make the PARKINGEXTEN feature of parking
	  actually work. (issue #9708 reported by mdu113)

2007-05-10 23:15 +0000 [r63830]  Jason Parker <jparker@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 63828 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r63828 | qwell | 2007-05-10 18:14:55 -0500 (Thu, 10 May 2007) | 4
	  lines Fix an issue with trying to kill a thread before it gets
	  created. Issue 9709, patch by nic_bellamy. ........

2007-05-10 22:23 +0000 [r63804]  Russell Bryant <russell@digium.com>

	* main/manager.c: Strip terminal escape sequences from CLI command
	  output that is going to be sent out over the manager interface.
	  (issue #9659, reported by pari, fixed by me)

2007-05-10 20:48 +0000 [r63750]  Doug Bailey <dbailey@digium.com>

	* main/callerid.c: Add test for negative offsets in cid data to
	  prevent infinite loops.

2007-05-10 20:46 +0000 [r63749]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Merged revisions 63748 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r63748 | oej | 2007-05-10 22:38:54 +0200 (Thu, 10 May 2007) | 4
	  lines Do not allocate SIP pvt's for PEERs we can not reach. This
	  was seen as a lot of dialogs being created then immediately
	  destroyed at reload/restart of the SIP channel. ........

2007-05-09 19:22 +0000 [r63656-63698]  Joshua Colp <jcolp@digium.com>

	* main/channel.c: Use the DTMF frame on the channel when returning
	  a DTMF frame from AST_FRAME_NULL or AST_FRAME_VOICE.

	* channels/chan_sip.c: Do not prematurely go on hold if sendonly
	  was not actually set.

2007-05-09 17:25 +0000 [r63654]  Matthew Fredrickson <creslin@digium.com>

	* channels/chan_zap.c, /: Merged revisions 63653 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r63653 | mattf | 2007-05-09 12:20:20 -0500 (Wed, 09 May 2007) | 2
	  lines Make sure we only create a DSP if it's requested on
	  SUB_REAL ........

2007-05-09 16:55 +0000 [r63612]  Russell Bryant <russell@digium.com>

	* main/channel.c: Modify ast_senddigit_begin() to use the same
	  assumptions used elsewhere in the code in that if a channel does
	  not have a send_digit_begin() callback, it only cares about DTMF
	  END events. (pointed out by Michael Neuhauser on the asterisk-dev
	  list)

2007-05-09 16:54 +0000 [r63611]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 63610 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r63610 | file | 2007-05-09 12:51:03 -0400 (Wed, 09 May 2007) | 2
	  lines Properly handle hints that point to multiple devices in
	  chan_sip. Why chan_sip is even doing this I have no idea but I
	  would rather not go into a rant. (issue #9536 reported by
	  rlister) ........

2007-05-09 16:43 +0000 [r63608]  Russell Bryant <russell@digium.com>

	* main/channel.c: Only call ast_senddigit_begin() in
	  ast_senddigit() if the channel has a send_digit_begin() callback.
	  Checking the END_DTMF_ONLY flag was the wrong thing to do,
	  because that flag indicates that a *bridged* channel only wants
	  DTMF END events coming from this channel.

2007-05-09 14:50 +0000 [r63566]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, apps/app_directory.c: Merged revisions 63565 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r63565 | tilghman | 2007-05-09 09:48:06 -0500 (Wed, 09 May 2007)
	  | 2 lines Replicate fix from 51158 (app_voicemail) to
	  app_directory (Issue 9224) ........

2007-05-09 13:24 +0000 [r63535]  Russell Bryant <russell@digium.com>

	* Makefile: I have seen multiple people post questions trying to
	  figure out what the message "The configure script must be
	  executed before running 'make'" means. So, add another like that
	  says to specifically run ./configure. If this isn't obvious
	  enough, then they should be using something like AsteriskNOW and
	  not installing from source.

2007-05-09 13:17 +0000 [r63534]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/chan_misdn.c, /,
	  channels/misdn/isdn_msg_parser.c: Merged revisions
	  62945,63402,63519 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r62945 | crichter | 2007-05-03 17:39:21 +0200 (Do, 03 Mai 2007) |
	  1 line when we're in state WAITING4DIGS, we use the asterisk
	  tone-generator which prods us, so we can't just return -1 in
	  misdn_write in this case. Added a MISDN_KEYPAD channel variable,
	  and fixed the sending of keypad. this enables us to modify the
	  call forward parameters in the switch. ........ r63402 | crichter
	  | 2007-05-08 17:07:37 +0200 (Di, 08 Mai 2007) | 1 line added
	  application misdn_check_l2l1 which tries to pull up the L1/L2 on
	  all ports that have the layers down in a group. It waits then for
	  a timeout. This helps for scenarios where multiple PMP BRIs are
	  grouped together, or where a provider has a faulty PTP
	  Implementation, that looses the L2 after a while. ........ r63519
	  | crichter | 2007-05-09 13:26:16 +0200 (Mi, 09 Mai 2007) | 1 line
	  release_chan frees ch, so we should never touch ch after
	  release_chan, this may cause segfaults. ........

2007-05-09 13:04 +0000 [r63532]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Don't retransmit 200 OK's on ignore status.
	  (Reported on asterisk-users)

2007-05-08 22:38 +0000 [r63478]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, apps/app_macro.c: Merged revisions 63477 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r63477 | tilghman | 2007-05-08 17:19:15 -0500 (Tue, 08 May 2007)
	  | 2 lines Issue 9602 - segfault in app_macro ........

2007-05-08 16:53 +0000 [r63403-63448]  Russell Bryant <russell@digium.com>

	* res/res_features.c: I mixed up the use of the find_feature()
	  function, so I renamed it find_dynamic_feature, and changed the
	  code to use the correct lock when using it.

	* res/res_features.c: Use a read/write lock when accessing the
	  built-in features.

	* contrib/scripts/realtime_pgsql.sql (added),
	  contrib/realtime_pgsql.sql (removed): Move realtime_pgsql.sql to
	  contrib/scripts to be with the rest of the sql examples. (issue
	  #9676, suretec)

2007-05-08 06:22 +0000 [r63360]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c, /: Merged revisions 63359 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r63359 | tilghman | 2007-05-08 01:20:16 -0500 (Tue, 08 May 2007)
	  | 2 lines Issue 9527 - upon entering a folder, no message is
	  selected (curmsg == -1), so deleting causes memory corruption
	  (beyond bounds) ........

2007-05-07 22:28 +0000 [r63329]  Russell Bryant <russell@digium.com>

	* configs/res_pgsql.conf.sample (added),
	  configs/extconfig.conf.sample, contrib/realtime_pgsql.sql
	  (added): Add a sample configuration file and example tables for
	  use with res_config_pgsql. (issue #9676, suretec)

2007-05-07 21:45 +0000 [r63283-63286]  Joshua Colp <jcolp@digium.com>

	* main/channel.c, include/asterisk/app.h, /, main/app.c: Merged
	  revisions 63285 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r63285 | file | 2007-05-07 17:39:52 -0400 (Mon, 07 May 2007) | 2
	  lines Properly handle what happens during a masquerade in
	  relation to group counting. (issue #9657 reported by ramonpeek)
	  ........

	* channels/chan_sip.c: Minor backport of revision 59083 in trunk.
	  Don't queue an unhold frame up if the call was never on hold to
	  begin with.

2007-05-07 20:05 +0000 [r63196-63254]  Olle Johansson <oej@edvina.net>

	* main/config.c: Don't remove configuration from memory just
	  because one section failed.

	* /: Guess svnmerge doesn't handle files that move around. Blocking
	  patch to ./config.c

2007-05-06 12:28 +0000 [r63152]  Olle Johansson <oej@edvina.net>

	* main/file.c: Stop the video stream when you stop playback of all
	  streams for a call

2007-05-04 20:03 +0000 [r63099]  Jason Parker <jparker@digium.com>

	* res/res_jabber.c: Fix a crash when checking version attribute in
	  an incoming XML caps element. Issue 9667, patch by phsultan.

2007-05-04 16:45 +0000 [r63047]  Pari Nannapaneni <paripurnachand@digium.com>

	* configs/manager.conf.sample: explanation for httptimeout in
	  manager.conf

2007-05-03 16:44 +0000 [r62989]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 62987 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r62987 | file | 2007-05-03 13:42:19 -0300 (Thu, 03 May 2007) | 2
	  lines When a peer is seeded or built tell the devicestate core to
	  update it's status. This is easier then having chan_sip load
	  before pbx_config. (issue #9658 reported by dlynes) ........

2007-05-03 16:38 +0000 [r62986]  Kevin P. Fleming <kpfleming@digium.com>

	* main/loader.c: improve loader a bit, by avoiding trying to
	  initialize embedded modules twice and avoiding trying to load
	  modules from disk when they have been loaded already during the
	  'preload' pass (reported by blitzrage on IRC, patch by me)

2007-05-03 15:23 +0000 [r62942]  Russell Bryant <russell@digium.com>

	* main/channel.c: Fix YADB (Yet Another DTMF Bug) ((C) Russell
	  Bryant, 2007, TM, Patent Pending). This set of changes came from
	  a debugging session I had with Dwayne Hubbard. When he called
	  into his home FXO, ran the Echo application, and pressed a digit,
	  the digit would be echoed back and would never end. This is
	  fixed, along with a couple other little improvements. * When
	  chan_zap is in the middle of playing a digit to a channel, it
	  feeds back null frames, not voice frames. So, I have modified
	  ast_read to check the timing on emulated DTMF when it receives
	  null frames, in addition to where it was doing this on voice
	  frames. * Make a tweak to setting the duration on emulated DTMF
	  digits. If there was no duration specified, it set it to be the
	  minimum, instead of the default. * Instead of timing the emulated
	  digits off of the number of samples in audio frames that pass
	  through, just use time values. Now there is no code in this
	  section that assumes 8kHz audio.

2007-05-03 14:41 +0000 [r62913]  Steve Murphy <murf@digium.com>

	* pbx/ael/ael-test/ref.ael-test18, pbx/ael/ael-test/ref.ael-test19
	  (added), pbx/ael/ael-test/ael-test18/extensions.ael,
	  pbx/ael/ael-test/ael-test19/extensions.ael (added),
	  pbx/ael/ael-test/ael-test19 (added),
	  pbx/ael/ael-test/ref.ael-test20 (added),
	  pbx/ael/ael-test/ael-test20/extensions.ael (added),
	  pbx/ael/ael-test/ael-test20 (added): updated the ael regressions
	  to match what's in trunk

2007-05-03 14:36 +0000 [r62912]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/misdn/isdn_lib_intern.h,
	  channels/misdn/isdn_lib.h, channels/chan_misdn.c, /,
	  channels/misdn/ie.c, channels/misdn/isdn_msg_parser.c: Merged
	  revisions 61357,61770,62885 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r61357 | crichter | 2007-04-11 14:05:57 +0200 (Mi, 11 Apr 2007) |
	  1 line some fixes for PMP Hold/Retrieve, it should work now, when
	  briding=no ........ r61770 | crichter | 2007-04-24 15:50:05 +0200
	  (Di, 24 Apr 2007) | 1 line added lock for sending messages to
	  avoid double sending. shuffled some empty_chans after the
	  cb_event calls, this avoids that a release_complete from a quite
	  different call releases a fresh created setup by accident.
	  ........ r62885 | crichter | 2007-05-03 15:59:00 +0200 (Do, 03
	  Mai 2007) | 1 line fixed the problem that misdn_write did not
	  return -1 when called with 0 samples in a frame this resultet in
	  a deadlock in some circumstances, when the call ended because of
	  a busy extension. added encoding of keypad. ........

2007-05-03 13:54 +0000 [r62883]  Steve Murphy <murf@digium.com>

	* pbx/ael/ael-test/ref.ael-test18 (added),
	  pbx/ael/ael-test/ref.ael-vtest13,
	  pbx/ael/ael-test/ael-test18/extensions.ael (added),
	  pbx/ael/ael-test/ael-test18 (added),
	  pbx/ael/ael-test/ref.ael-vtest17, pbx/ael/ael.tab.c,
	  pbx/ael/ael.y, pbx/ael/ael.tab.h, pbx/ael/ael-test/ref.ael-test7:
	  These mods fix bug 9623, where an '@' in the eswitch contents
	  causes a syntax error. I also updated the regressions.

2007-05-03 00:23 +0000 [r62797-62842]  Kevin P. Fleming <kpfleming@digium.com>

	* res/res_config_odbc.c, /: Merged revisions 62841 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r62841 | kpfleming | 2007-05-02 20:23:00 -0400 (Wed, 02
	  May 2007) | 2 lines doh... initializing the pointer variable will
	  work just a bit better ........

	* res/res_config_odbc.c, /: Merged revisions 62796 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r62796 | kpfleming | 2007-05-02 19:53:46 -0400 (Wed, 02
	  May 2007) | 7 lines increase reliability and efficiency of static
	  Realtime config loading via ODBC: don't request fields we aren't
	  going to use don't request sorting on fields that are pointless
	  to sort on explicitly request the fields we want, because we
	  can't expect the database to always return them in the order they
	  were created (reported by blitzrage in person (!), patch by me)
	  ........

	* res/res_config_pgsql.c: improve static Realtime config loading
	  from PostgreSQL: don't request sorting on fields that are
	  pointless to sort on use ast_build_string() instead of snprintf()
	  don't request the list of fieldnames that resulted from the query
	  when we both knew what they were before we ran the query _AND_ we
	  aren't going to do anything with them anyway (patch by me,
	  inspired by blitzrage's bug report about res_config_odbc)

2007-05-02 22:59 +0000 [r62739-62789]  Russell Bryant <russell@digium.com>

	* main/channel.c: Merge changes from team/russell/inband_dtmf ...
	  Fix some issues related to generating inband DTMF. There are two
	  changes here: 1) The list of DTMF tones in the senddigit_begin()
	  function explicitly specified 100ms of the tone followed by 100ms
	  of silence. This really broke things with the way that Asterisk
	  now wants complete control over when the digit begins and ends.
	  So, regardless of what Asterisk really wanted to do, this was
	  going to play out the tone at the length it wanted to. This
	  caused various problems like DTMF translation to inband to be
	  extremely unreliable. The list of tones has been changed so that
	  the correct DTMF tone is played indefinitely until Asterisk tells
	  it to stop. 2) ast_write() had to be modified to let a DTMF_END
	  frame get processed even when a generator is present. This is how
	  the tone will finally get stopped. (issues #8944, #9250, #9348,
	  maybe others. Thanks to mdu113 from #8944 for the testing and
	  feedback!)

	* main/manager.c: Backport the change that only went in to trunk
	  that fixes the command manager action over http. (reported
	  internally by pari and bkruse)

2007-05-02 20:46 +0000 [r62738]  Steve Murphy <murf@digium.com>

	* main/cdr.c, main/pbx.c, /: Merged revisions 62737 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r62737 | murf | 2007-05-02 14:10:32 -0600 (Wed, 02 May
	  2007) | 1 line Some tweaks to satisfy CDR bug 8796, where being
	  in 'h' extension louses up the dst field ........

2007-05-02 17:43 +0000 [r62692]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, channels/chan_iax2.c: Merged revisions 62691 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r62691 | tilghman | 2007-05-02 12:38:16 -0500 (Wed, 02 May 2007)
	  | 4 lines Issue 9638 - if a text frame is sent with no
	  terminating NULL through a bridged IAX connection, the remote end
	  will receive garbage characters tacked onto the end. ........

2007-05-02 17:10 +0000 [r62689]  Steve Murphy <murf@digium.com>

	* configs/extensions.conf.sample, main/channel.c, main/pbx.c,
	  channels/chan_zap.c, cdr/cdr_radius.c: a)In chan_zap, set the
	  clid, src fields in channel_alloc call. b)in the channel_alloc
	  func, set the cid_num and name fields from the arglist[blush]. c)
	  don't update the channel app & app data fields if you are in the
	  'h' extension. d)the load_module func in cdr_radius needs to
	  return DECLINE, SUCCESS.

2007-05-02 06:15 +0000 [r62624]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Don't unlock a channel that we already know
	  does not exist (propably isue 8228)

2007-05-01 21:57 +0000 [r62548]  Russell Bryant <russell@digium.com>

	* /, res/res_features.c: Merged revisions 62547 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r62547 | russell | 2007-05-01 16:55:19 -0500 (Tue, 01 May 2007) |
	  4 lines Remove an unnecessary check that makes it so if you hang
	  up after doing an attended transfer before the target extension
	  answers the channel, the transfer is not successful. (issue
	  #9338, patch by svanlund) ........

2007-05-01 21:34 +0000 [r62545]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c: Bug 9590 - Memory leaks around find_user()
	  (found by rayjay, different fixes by me)

2007-05-01 16:26 +0000 [r62497]  Russell Bryant <russell@digium.com>

	* /, configs/indications.conf.sample: Merged revisions 62496 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r62496 | russell | 2007-05-01 11:26:23 -0500 (Tue, 01 May 2007) |
	  3 lines Add indications.conf information for the Philippines.
	  (issue #9525, reported and patched by loloski) ........

2007-04-30 15:58 +0000 [r62414-62419]  Russell Bryant <russell@digium.com>

	* channels/chan_zap.c, /: Merged revisions 62417 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r62417 | russell | 2007-04-30 10:57:26 -0500 (Mon, 30 Apr 2007) |
	  4 lines This patch fixes an issue where depending on the cause
	  code, when the network sends a PRI disconnect, the call may not
	  be properly hung up. (issue #9588, reported and patched by
	  softins) ........

	* include/asterisk/http.h, main/http.c: When serving dynamic
	  content, include a Cache-Control header to instruct the browsers
	  to not store the resulting content. (issue #9621, reported by
	  Pari, patch by me)

2007-04-30 14:52 +0000 [r62371]  Jason Parker <jparker@digium.com>

	* configs/iax.conf.sample: Remove unused (and potentially
	  confusing) jitterbuffer options from sample config.

2007-04-30 14:36 +0000 [r62369]  Joshua Colp <jcolp@digium.com>

	* main/asterisk.c, /: Merged revisions 62368 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r62368 | file | 2007-04-30 11:34:07 -0300 (Mon, 30 Apr 2007) | 2
	  lines Update copyright notice. It's now the year 2007! ........

2007-04-29 05:50 +0000 [r62299-62331]  Russell Bryant <russell@digium.com>

	* channels/chan_zap.c: Fix a bug that made the "language" setting
	  in zapata.conf not functional. (issue #9626, reported and fixed
	  by sergee)

	* apps/app_meetme.c: Note that the "talker optimization" option
	  will be enabled by default in 1.6

2007-04-27  Russell Bryant <russell@digium.com>

	* Asterisk 1.4.4 released.

2007-04-27 21:10 +0000 [r62218]  Russell Bryant <russell@digium.com>

	* channels/chan_agent.c: Fix a weird problem where when a caller
	  talking to someone sitting behind an agent channel sent a digit,
	  the digit would be played to the agent for forever. This is
	  because chan_agent always returned -1 from its send_digit_begin
	  and _end callbacks. This non-zero return value indicates to the
	  Asterisk core that it would like an inband DTMF generator put on
	  the channel. However, this is the wrong thing to do. It should
	  *always* return 0, instead. When the digit begin and end
	  functions are called on the proxied channel, the underlying
	  channel will indicate whether inband DTMF is needed or not, and
	  the generator will be put on that one, and not the Agent channel.
	  (issue #9615, #9616, reported by jiddings and BigJimmy, and fixed
	  by me)

2007-04-27 16:17 +0000 [r62174]  Jason Parker <jparker@digium.com>

	* /, codecs/codec_zap.c: Merged revisions 62173 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r62173 | qwell | 2007-04-27 11:16:16 -0500 (Fri, 27 Apr 2007) | 3
	  lines This transcoder message needn't be a NOTICE. I've seen it
	  cause confusion more than a few times. ........

2007-04-27 16:14 +0000 [r62171]  Russell Bryant <russell@digium.com>

	* main/pbx.c: If no variables were passed into
	  pbx_substitute_variables_helper_full(), then don't even bother
	  creating a temporary bogus channel, since that is only for
	  allowing certain functions to operate on the variables as if they
	  were on a channel. Most importantly, this fixes a crash. (issue
	  #9613, reported by callguy, fixed by me)

2007-04-27 14:04 +0000 [r62095-62137]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Merged revisions 62126 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r62126 | oej | 2007-04-27 15:57:45 +0200 (Fri, 27 Apr 2007) | 4
	  lines Issue #7351 - SIP Cancel fails due to the wrong contact
	  uri. Reported by PPYY, failed to fix by OEJ final fix by wojtekka
	  - THANKS!!!! THis was a hard one to catch. ........

	* channels/chan_zap.c, main/manager.c: Issue #9608 - fix some
	  annoying DEBUG messages not controlled by option_debug (DEA).
	  Thanks!

2007-04-26 16:33 +0000 [r61959-62038]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 62037 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r62037 | file | 2007-04-26 12:30:57 -0400 (Thu, 26 Apr 2007) | 2
	  lines Revert previous fix for when the IAX2 channel goes funky
	  (that's the technical term). This is causing legit calls to be
	  prematurely hung up. (issue #9600 reported by justdave) ........

	* main/channel.c: Missed an ast_app_group_discard during merge.
	  Thanks blitzrage!

	* res/res_monitor.c: Don't always say that the channel is being
	  paused if it is actually being unpaused in the Manager ack
	  message. (reported by jsmith in #asterisk-bugs)

	* main/config.c, /: Merged revisions 61958 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r61958 | file | 2007-04-25 21:25:03 -0400 (Wed, 25 Apr 2007) | 2
	  lines Don't count failed include attempts against the
	  configuration include level. (issue #9593 reported by mostyn)
	  ........

2007-04-25 22:29 +0000 [r61914]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_zap.c, /: Merged revisions 61913 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r61913 | kpfleming | 2007-04-25 17:24:59 -0500 (Wed, 25 Apr 2007)
	  | 2 lines handle a very bizarre race condition with channels
	  being redirected before a simple switch can be started on them
	  (issue #9286) ........

2007-04-25 21:59 +0000 [r61863-61870]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 61866 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r61866 | russell | 2007-04-25 16:55:23 -0500 (Wed, 25 Apr 2007) |
	  2 lines If the callerid= option is specified, but empty, clear
	  any previous data. ........

	* /, channels/chan_iax2.c: Merged revisions 61862 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r61862 | russell | 2007-04-25 16:06:22 -0500 (Wed, 25 Apr 2007) |
	  2 lines Ensure that callerid settings are reset on a reload.
	  ........

2007-04-25 19:21 +0000 [r61805]  Joshua Colp <jcolp@digium.com>

	* main/cli.c, main/channel.c, include/asterisk/app.h,
	  funcs/func_groupcount.c, /, main/app.c: Merged revisions 61804
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r61804 | file | 2007-04-25 14:52:50 -0400 (Wed, 25 Apr 2007) | 2
	  lines Merge rewritten group counting support. No more storing
	  data on the variable list of the channels. That was bad, mmmk?
	  (issue #7497 reported by sabbathbh) ........

2007-04-25 16:22 +0000 [r61799]  Russell Bryant <russell@digium.com>

	* channels/chan_zap.c, /: Merged revisions 61798 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r61798 | russell | 2007-04-25 11:20:38 -0500 (Wed, 25 Apr 2007) |
	  3 lines Fix a typo where cid_num got copied instead of cid_ani.
	  (issue #9587, reported and patched by xrg) ........

2007-04-24  Russell Bryant <russell@digium.com>

	* Asterisk 1.4.3 released.

2007-04-24 21:34 +0000 [r61781-61787]  Russell Bryant <russell@digium.com>

	* main/manager.c, /: Merged revisions 61786 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r61786 | russell | 2007-04-24 16:33:59 -0500 (Tue, 24 Apr 2007) |
	  4 lines Don't crash if a manager connection provides a username
	  that exists in manager.conf but does not have a password, and
	  also requests MD5 authentication. (ASA-2007-012) ........

	* main/channel.c, include/asterisk/channel.h: Improve DTMF handling
	  in ast_read() even more in response to a discussion on the
	  asterisk-dev mailing list. I changed the enforced minimum length
	  of a digit from 100ms to 80ms. Furthermore, I made it now enforce
	  a gap of 45ms in between digits. These values are not
	  configurable in a configuration file right now, but they can be
	  easily changed near the top of main/channel.c.

2007-04-24 18:43 +0000 [r61779]  Dwayne M. Hubbard <dhubbard@digium.com>

	* channels/chan_zap.c, /: Merged revisions 61777 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r61777 | dhubbard | 2007-04-24 13:20:31 -0500 (Tue, 24 Apr 2007)
	  | 1 line removed #if 0 block from chan_phone, chan_zap, and
	  chan_modem restart_monitor() ........

2007-04-24 16:16 +0000 [r61774]  Russell Bryant <russell@digium.com>

	* main/dial.c: Add a few more state changes in
	  handle_frame_ownerless() so that the SLA code will get notified
	  of these changes even when an owner channel is not provided. This
	  isn't from a specific bug report, it's just something I noticed
	  while poking around.

2007-04-24 16:07 +0000 [r61772]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 61771 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r61771 | file | 2007-04-24 12:05:06 -0400 (Tue, 24 Apr 2007) | 2
	  lines Allow RFC2833 to be sent in the response SDP when an INVITE
	  comes in without SDP. (issue #9546 reported by mcrawford)
	  ........

2007-04-23 18:17 +0000 [r61763-61765]  Russell Bryant <russell@digium.com>

	* main/pbx.c: Some dialplan functions, such as CUT(), expect to
	  operate on variables on a channel. So, this little hack lets them
	  work in places where a channel doesn't exist, such as within
	  DUNDi configuration. (issue #9465, reported and patched by
	  Corydon76, testing by blitzrage)

	* main/channel.c: Ensure that digits passing through Asterisk have
	  a reasonable minimum length. It is currently 100 ms. If someone
	  thinks this should be different, feel free to speak up. (related
	  to issues #8944, #9250, and #9348)

2007-04-20 21:35 +0000 [r61705-61707]  Jason Parker <jparker@digium.com>

	* main/rtp.c: Avoid invalid seqno cycling detection. Per comment
	  from Dave Troy: This adds back in some simple typecasting I had
	  in an earlier version which I realize now may be breaking things.
	  Issue #9554.

	* main/loader.c, /: Merged revisions 61704 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r61704 | qwell | 2007-04-20 16:14:27 -0500 (Fri, 20 Apr 2007) | 4
	  lines Fix an issue that I noticed while looking over issue 9571.
	  The reload timestamp was getting set after reloading the built-in
	  stuff, and before the modules. ........

2007-04-20 20:42 +0000 [r61697]  Russell Bryant <russell@digium.com>

	* main/rtp.c: Remove a stray debug message introduced by a recent
	  commit.

2007-04-20 19:51 +0000 [r61694]  Jason Parker <jparker@digium.com>

	* /, apps/app_queue.c: Merged revisions 61692 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r61692 | qwell | 2007-04-20 14:49:54 -0500 (Fri, 20 Apr 2007) | 5
	  lines If the '* to hangup' option is not enabled, we don't need
	  to disable * as a valid exit key. If it was enabled, this
	  statement would've never been checked in the first place. Issue
	  #9552 ........

2007-04-20 18:19 +0000 [r61690]  Russell Bryant <russell@digium.com>

	* main/config.c, apps/app_voicemail.c, main/manager.c,
	  include/asterisk/config.h: Fix the UpdateConfig manager action to
	  properly treat "variables" and "objects" differently (a=b versus
	  a=>b). (issue #9568, reported by pari, patch by me)

2007-04-19 08:37 +0000 [r61686]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Merged revisions 61685 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r61685 | oej | 2007-04-19 09:56:21 +0200 (Thu, 19 Apr 2007) | 3
	  lines Send NOTIFY to Contact: in SUBSCRIBE - as reported by
	  Intertex and Citel. Fixed during SIPit 20 in Antwerp. ........

2007-04-19 04:36 +0000 [r61681-61683]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/manager.c: Bug 9557 - simple reason why reading a function
	  always returned NULL

	* funcs/func_callerid.c, funcs/func_language.c, funcs/func_moh.c,
	  funcs/func_groupcount.c, /, funcs/func_timeout.c,
	  funcs/func_cdr.c: Merged revisions 61680 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r61680 | tilghman | 2007-04-18 21:30:18 -0500 (Wed, 18 Apr 2007)
	  | 5 lines Bug 9557 - Specifying the GetVar AMI action without a
	  Channel parameter can cause Asterisk to crash. The reason this
	  needs to be fixed in the functions instead of in AMI is because
	  Channel can legitimately be NULL, such as when retrieving global
	  variables. ........

2007-04-18 22:10 +0000 [r61678]  Kevin P. Fleming <kpfleming@digium.com>

	* sounds/Makefile: allow external build systems to extract the
	  required sound file versions

2007-04-18 20:46 +0000 [r61674-61676]  Olle Johansson <oej@edvina.net>

	* main/rtp.c: Clean upp formatting, add some doxygen stuff while
	  we're in cleaning mode... Thanks Kevin!

	* main/rtp.c: Issue #9554 - Improve RTCP (Dave Troy)

2007-04-16 14:47 +0000 [r61664-61666]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: #9483, half of patch by twilson to solve 302
	  redirect issues

	* /: Blocking AstHoloPatch from 1.2

2007-04-13 21:17 +0000 [r61658]  Steve Murphy <murf@digium.com>

	* main/cdr.c: This is a fix to the way CDR merge handles the data
	  that results from ForkCDR.

2007-04-13 19:17 +0000 [r61648-61656]  Joshua Colp <jcolp@digium.com>

	* apps/app_dial.c, /: Merged revisions 61655 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r61655 | file | 2007-04-13 15:15:12 -0400 (Fri, 13 Apr 2007) | 2
	  lines Add OUTBOUND_GROUP_ONCE variable to app_dial. This behaves
	  the same as OUTBOUND_GROUP except it will get unset after use so
	  it won't get accidentally inherited. (issue #BE-140) ........

	* apps/app_speech_utils.c: Do not bother looking for a result if
	  none are present.

	* channels/chan_sip.c: For those very verbose SIP implementations
	  that attach tons of info to the Contact header... let's increase
	  our variable sizes. (issue #9535 reported by jeffg)

2007-04-13 17:10 +0000 [r61645]  Russell Bryant <russell@digium.com>

	* apps/app_voicemail.c: Eliminate a compiler warning with
	  ODBC_STORAGE enabled so that it will build under dev-mode.

2007-04-13 17:01 +0000 [r61644]  Steve Murphy <murf@digium.com>

	* channels/chan_oss.c: A fix for chan_oss that resulted from the
	  CDR changes; it helps to use the right info.

2007-04-13 16:32 +0000 [r61641]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Don't assume the callid of a dialog will be
	  set, as in some circumstances it may not. (issue #9534 reported
	  by tecnoxarxa)

2007-04-11 16:05 +0000 [r61477]  Russell Bryant <russell@digium.com>

	* /, channels/chan_sip.c: Merged revisions 61476 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r61476 | russell | 2007-04-11 11:01:25 -0500 (Wed, 11 Apr 2007) |
	  5 lines If someone sets the "useragent" option in sip.conf to be
	  empty, then don't add the User-Agent header at all. It is an
	  optional header, anyway. Also, the bug report says that some of
	  Japan's SIP providers don't allow it for some weird reason.
	  (issue #9488, reported by makoto, fixed by me) ........

2007-04-11 15:39 +0000 [r61443]  Nadi Sarrar <ns@beronet.com>

	* channels/chan_misdn.c: Don't export AOCD variables on
	  misdn_hangup anymore, this was mainly a fix for trunk..

2007-04-11 15:09 +0000 [r61377-61427]  Russell Bryant <russell@digium.com>

	* /, channels/chan_sip.c: Merged revisions 61426 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r61426 | russell | 2007-04-11 10:05:36 -0500 (Wed, 11 Apr 2007) |
	  6 lines Fix a bug with switching between host=dynamic and using
	  specific hosts for peers. The code would only reset the peer's
	  address when it is dynamic if it was a new peer structure. Now,
	  it will also reset the address if it was already in the peer
	  list, but before the reload, it was not dynamic. (issue #9515,
	  reported by caio1982, fixed by me) ........

	* main/http.c: Add "svgz" to the mimetypes table. (issue #9510,
	  bkruse) In passing, constify the elements of the mimetypes table.

	* /, channels/chan_sip.c: Merged revisions 61376 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r61376 | russell | 2007-04-11 09:02:54 -0500 (Wed, 11 Apr 2007) |
	  5 lines Remove the attempt at reporting configuration errors in
	  sip.conf. This can cause a bunch of improper messages when using
	  realtime. I give up. As oej tried to convince me when I put this
	  in, there is just no easy way to do it. (inspired by a message on
	  the -dev list) ........

2007-04-11 13:40 +0000 [r61342-61373]  Nadi Sarrar <ns@beronet.com>

	* channels/chan_misdn.c: Export AOCD variables on misdn_hangup.

	* channels/chan_misdn.c: Ignore facility messages in case we don't
	  have a corresponding channel object.

	* channels/chan_misdn.c: AOCD's are now exported to asterisk
	  channel variables.

2007-04-10 16:05 +0000 [r61220]  Russell Bryant <russell@digium.com>

	* main/Makefile, main/http.c, main/minimime (removed): File upload
	  support was added to solve some needs for the Asterisk GUI.
	  However, after much discussion, it has been decided that adding
	  this to 1.4 is not in the best interests of the project. It has
	  been removed here, but will remain in trunk.

2007-04-10 12:43 +0000 [r61183]  Nadi Sarrar <ns@beronet.com>

	* channels/misdn_config.c, /: Merged revisions 61170 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r61170 | nadi | 2007-04-10 14:31:45 +0200 (Di, 10 Apr
	  2007) | 2 lines msns config parameter defaults to '*' ........

2007-04-10 05:18 +0000 [r61136]  Steve Murphy <murf@digium.com>

	* apps/app_cdr.c, main/cdr.c, res/res_features.c: Finished up a
	  previous fix to overcome a compiler warning; the app NoCDR() has
	  been updated to mark the channel CDR as POST_DISABLED instead of
	  destroying the CDR; this way its flags are propagated thru a
	  bridge and the CDR is actually dropped. The cases where only one
	  channel in a bridge has a CDR was cleaned up.

2007-04-09 19:58 +0000 [r61072]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Merged revisions 61038 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r61038 | oej | 2007-04-09 21:38:59 +0200 (Mon, 09 Apr 2007) | 3
	  lines - Don't send ActionID before Response: header. - Don't use
	  a blank in an AMI header ........

2007-04-09 19:55 +0000 [r61062-61070]  Kevin P. Fleming <kpfleming@digium.com>

	* main/minimime/mm_envelope.c, res/res_features.c: fix up some
	  warnings found using --enable-dev-mode

	* main/minimime/Doxyfile (removed),
	  main/minimime/tests/messages/CVS (removed),
	  main/minimime/tests/CVS (removed): remove some more stuff we
	  don't need

2007-04-09 19:41 +0000 [r61042-61044]  Russell Bryant <russell@digium.com>

	* main/minimime/test (removed): Remove another directory that
	  should no longer be there

	* main/minimime/Make.conf (removed), main/minimime/mytest_files
	  (removed), main/minimime/.cvsignore (removed), main/minimime/sys
	  (removed), main/minimime/mm-docs (removed): Remove various files
	  that I thought I already removed.

2007-04-09 19:05 +0000 [r61022]  Jason Parker <jparker@digium.com>

	* apps/app_queue.c: Use the appropriate interface name with
	  COMPLETECALLER. Issue 9395.

2007-04-09 18:32 +0000 [r60989]  Steve Murphy <murf@digium.com>

	* channels/chan_oss.c, main/channel.c, main/cdr.c,
	  channels/chan_phone.c, channels/chan_misdn.c,
	  channels/chan_skinny.c, channels/chan_features.c,
	  channels/chan_h323.c, channels/chan_alsa.c, channels/chan_nbs.c,
	  channels/chan_mgcp.c, apps/app_voicemail.c, main/pbx.c,
	  channels/chan_vpb.cc, channels/chan_local.c, channels/chan_zap.c,
	  channels/chan_sip.c, res/res_features.c, channels/chan_agent.c,
	  include/asterisk/channel.h, channels/chan_gtalk.c,
	  channels/chan_iax2.c: This is a big improvement over the current
	  CDR fixes. It may still need refinement, but this won't have as
	  many folks bothered.

2007-04-09 18:02 +0000 [r60984]  Olle Johansson <oej@edvina.net>

	* res/res_jabber.c: Add final new line after JabberEvent

2007-04-09 17:22 +0000 [r60936]  Jason Parker <jparker@digium.com>

	* /, apps/app_directory.c: Merged revisions 60935 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r60935 | qwell | 2007-04-09 12:22:15 -0500 (Mon, 09 Apr 2007) | 5
	  lines Allow matching on names shorter than 3 chars. This also
	  fixes the case where somebody wants to match on less then 3
	  chars. Issue 9071 ........

2007-04-09 03:01 +0000 [r60847-60850]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/asterisk.c, include/asterisk.h, /: Merged revisions 60849
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r60849 | tilghman | 2007-04-08 21:49:06 -0500 (Sun, 08 Apr 2007)
	  | 2 lines Don't check for error when lowering priority (according
	  to the manpage, it should never happen anyway). It might could
	  happen, though, if another thread messed with the priority, so
	  safeguard against that (reported via -dev list). ........

	* channels/chan_local.c, /: Merged revisions 60846 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r60846 | tilghman | 2007-04-08 21:37:18 -0500 (Sun, 08
	  Apr 2007) | 2 lines Bug 9505 - If the return value for
	  local_queue_frame is set, then p->lock is no longer valid.
	  ........

2007-04-09 01:03 +0000 [r60762-60798]  Joshua Colp <jcolp@digium.com>

	* apps/app_dial.c, /: Merged revisions 60797 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r60797 | file | 2007-04-08 20:59:29 -0400 (Sun, 08 Apr 2007) | 2
	  lines When calling a device that then forwards us elsewhere... we
	  have to make our channels compatible if it is the only channel
	  being dialed. (issue #9445 reported by marcelbarbulescu) ........

	* apps/app_queue.c: Allow app_queue to use MONITOR_EXEC even if
	  MONITOR_OPTIONS is not set. (issue #9495 reported by cduffy)

2007-04-08 14:14 +0000 [r60661-60713]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, apps/app_macro.c: Merged revisions 60711 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r60711 | tilghman | 2007-04-08 09:00:22 -0500 (Sun, 08 Apr 2007)
	  | 2 lines Gosub called within a Macro resets the arguments
	  improperly and causes general weirdness. (Issue 8329) ........

	* main/http.c: Fix --enable-dev-mode

	* channels/chan_oss.c: Off by one error, resulting in a crash
	  (Issue 9500)

	* /, main/file.c: Merged revisions 60660 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r60660 | tilghman | 2007-04-07 20:39:25 -0500 (Sat, 07 Apr 2007)
	  | 2 lines Bug 9486 - memory leak when opening a filestream
	  ........

2007-04-06 20:58 +0000 [r60603]  Russell Bryant <russell@digium.com>

	* main/minimime/sys/mm_queue.h, main/minimime/Doxyfile,
	  main/minimime/mimeparser.yy.c, main/minimime/minimime.c,
	  main/manager.c, main/minimime/mm_mimepart.c,
	  main/minimime/test.sh, configure, include/asterisk/compat.h,
	  main/strcompat.c, main/minimime/mm_internal.h, main/http.c,
	  main/minimime/tests/parse.c, main/minimime/mm_base64.c,
	  main/minimime/mm_mimeutil.c, main/minimime/mm.h,
	  main/minimime/tests, main/minimime/mm_header.c,
	  main/minimime/mm_error.c, main/Makefile,
	  main/minimime/mm_codecs.c, main/minimime/mm_param.c,
	  configure.ac, main/minimime/Makefile, main/minimime/mm_init.c,
	  include/asterisk/manager.h, main/minimime/strlcpy.c,
	  configs/http.conf.sample, main/minimime/mm_parse.c,
	  main/minimime/tests/create.c, main/minimime/mm_contenttype.c,
	  main/minimime/mm_util.c, main/minimime/mm_envelope.c,
	  main/minimime/tests/messages/test1.txt, main/minimime/mm_mem.c,
	  main/minimime/tests/messages/test2.txt,
	  main/minimime/tests/messages/test3.txt,
	  main/minimime/mimeparser.h, main/minimime/mimeparser.tab.c,
	  main/minimime/tests/messages/test4.txt,
	  main/minimime/tests/messages/test5.txt, main/minimime/mm_util.h,
	  main/minimime/tests/messages/test6.txt, main/minimime/strlcat.c,
	  main/minimime/mm_mem.h, main/minimime/tests/messages/test7.txt,
	  main/minimime/mimeparser.l, main/minimime/mm_context.c,
	  main/minimime/mimeparser.tab.h, main/minimime (added),
	  main/minimime/mm_warnings.c, main/minimime/mm_queue.h,
	  main/minimime/tests/messages, include/asterisk/autoconfig.h.in,
	  main/minimime/mimeparser.y, Makefile.moddir_rules,
	  main/minimime/sys, main/minimime/tests/Makefile: To be able to
	  achieve the things that we would like to achieve with the
	  Asterisk GUI project, we need a fully functional HTTP interface
	  with access to the Asterisk manager interface. One of the things
	  that was intended to be a part of this system, but was never
	  actually implemented, was the ability for the GUI to be able to
	  upload files to Asterisk. So, this commit adds this in the most
	  minimally invasive way that we could come up with. A lot of work
	  on minimime was done by Steve Murphy. He fixed a lot of bugs in
	  the parser, and updated it to be thread-safe. The ability to
	  check permissions of active manager sessions was added by Dwayne
	  Hubbard. Then, hacking this all together and do doing the
	  modifications necessary to the HTTP interface was done by me.

2007-04-06 20:32 +0000 [r60568-60572]  Dwayne M. Hubbard <dhubbard@digium.com>

	* UPGRADE.txt: clarified a sentence in the format_wav section

	* UPGRADE.txt: updated UPGRADE.txt with format_wav GAIN change and
	  plan to remove GAIN code from trunk

2007-04-06 19:50 +0000 [r60521-60565]  Russell Bryant <russell@digium.com>

	* apps/app_meetme.c: When a station picks up a trunk that was on
	  hold, make the hints reflect that nobody has the trunk on hold
	  anymore.

	* apps/app_meetme.c: Fix a few problems with SLA. (issue #9459,
	  reported by francesco_r, fixed by me) * The original behavior was
	  that if one station put a call on hold, another one picked it up,
	  and then hung up, the code would still consider the call on hold
	  by the first station, so the trunk would not be hung up. However,
	  to better comply with what most people seem to expect it to
	  behave, it will now hang up the trunk. * Fix a problem with
	  "barge=no". This was only intended to prevent people from joining
	  calls that are in progress. However, it also prevented other
	  people from picking up a call that was on hold. This has been
	  fixed. * When there are no active stations on a trunk and it is
	  on hold, the code now indicates the HOLD and UNHOLD conditions to
	  the trunk channel. This allows music on hold to be played to the
	  trunk when it is on hold.

2007-04-06 18:21 +0000 [r60459-60485]  Matt Frederickson <creslin@digium.com>

	* channels/chan_zap.c: Make sure we check the faxdetect option
	  before doing fax processing

	* channels/chan_zap.c, /: Merged revisions 60456 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r60456 | mattf | 2007-04-06 12:03:15 -0500 (Fri, 06 Apr 2007) | 2
	  lines There should only be one code path for doing DTMF
	  conditionals on channels. This fixes it. ........

2007-04-06 14:49 +0000 [r60399]  Kevin P. Fleming <kpfleming@digium.com>

	* /, codecs/codec_zap.c: Merged revisions 60398 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r60398 | kpfleming | 2007-04-06 09:41:37 -0500 (Fri, 06 Apr 2007)
	  | 2 lines remove undocumented 'cardsmode' parameter and stop
	  searching for transcoders during reload() ........

2007-04-06 01:14 +0000 [r60361]  Joshua Colp <jcolp@digium.com>

	* res/res_speech.c, apps/app_speech_utils.c,
	  include/asterisk/speech.h: Add support for returning different
	  types of results (ie: NBest).

2007-04-05 22:58 +0000 [r60325]  Dwayne M. Hubbard <dhubbard@digium.com>

	* formats/format_wav.c: modified default GAIN for issue 5823,
	  thanks jrwalliker

2007-04-05 22:35 +0000 [r60323]  Steve Murphy <murf@digium.com>

	* configs/cdr_custom.conf.sample, configs/cdr.conf.sample: Added
	  some clarification to the example configs for CDRs, on how to
	  select a backend. Also, made cdr-csv the default if you 'make
	  samples', and no other changes.

2007-04-05 16:10 +0000 [r60268]  Jason Parker <jparker@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 60267 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r60267 | qwell | 2007-04-05 11:09:41 -0500 (Thu, 05 Apr 2007) | 5
	  lines Just because we can't find the voicemail configuration
	  file, doesn't mean that the module failed to load. The user could
	  be using realtime. Issue #9473 ........

2007-04-05 15:47 +0000 [r60265]  Russell Bryant <russell@digium.com>

	* main/http.c: Add the MIME type for gif by request from Pari

2007-04-05 12:55 +0000 [r60214]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 60213 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r60213 | file | 2007-04-05 08:52:50 -0400 (Thu, 05 Apr 2007) | 2
	  lines Only unlock our pvt and net locks if we are actually going
	  to try to lock the owner again. (issue #9472 reported by zoa)
	  ........

2007-04-04 17:40 +0000 [r60013-60137]  Russell Bryant <russell@digium.com>

	* main/manager.c, /: Merged revisions 60134 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r60134 | russell | 2007-04-04 12:38:47 -0500 (Wed, 04 Apr 2007) |
	  6 lines It is valid to redirect channels via the manager
	  interface that are not in the UP state. Instead of checking for
	  that to prevent to ensure a dead channel doesn't get redirected,
	  just use the ast_check_hangup() API call. (issue #9457, reported
	  by Callmewind, patch by me) (related to issue #8977) ........

	* channels/chan_sip.c: Add a Content-Length of 0 to the response
	  built by transmit_response_with_unsupported(). (issue #9454,
	  reported by makoto, fixed by me)

	* /, channels/chan_sip.c: Merged revisions 60083 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r60083 | russell | 2007-04-04 11:37:04 -0500 (Wed, 04 Apr 2007) |
	  4 lines Fix the return value of handle_common_options() so that
	  it always properly indicates whether it handled the option or
	  not. (issue #9455, reported by Netview, fixed by me) ........

	* apps/app_meetme.c: Fix a problem where if a trunk was hung up
	  while it was on hold, all of the hints would reflect the line
	  still on hold, even though it should reflect that it is back to
	  not in use. (issue #9459, reported by francesco_r, fixed by me)

	* /: Blocked revisions 60016 via svnmerge ........ r60016 | russell
	  | 2007-04-03 18:23:23 -0500 (Tue, 03 Apr 2007) | 3 lines Add a
	  missing "\r\n" in the body of the NOTIFY that is sent to indicate
	  the status of a transfer. (issue #9388, reported by rarritt)
	  ........

	* /: Blocked revisions 60014 via svnmerge ........ r60014 | russell
	  | 2007-04-03 18:00:10 -0500 (Tue, 03 Apr 2007) | 3 lines Use the
	  more generic check for "sed -r" support that was already present
	  in 1.4. (related to issue #9399) ........

	* /: Blocked revisions 60012 via svnmerge ........ r60012 | russell
	  | 2007-04-03 17:54:49 -0500 (Tue, 03 Apr 2007) | 3 lines On
	  Darwin, the -r argument to sed is not valid. It has to be -E.
	  (issue #9399, reported by jcovert) ........

2007-04-03 19:40 +0000 [r59963]  Joshua Colp <jcolp@digium.com>

	* apps/app_speech_utils.c: Don't clash when a person both speaks
	  and uses DTMF.

2007-04-03 19:16 +0000 [r59853-59939]  Russell Bryant <russell@digium.com>

	* /, channels/chan_sip.c: Merged revisions 59938 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r59938 | russell | 2007-04-03 14:15:04 -0500 (Tue, 03 Apr 2007) |
	  4 lines Don't attempt to report configuration errors in
	  build_user(). oej pointed out that for a "friend" entry, this
	  won't work, because all user options are valid for peers, but not
	  the other way around. ........

	* /, channels/chan_sip.c: Merged revisions 59916 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r59916 | russell | 2007-04-03 13:43:54 -0500 (Tue, 03 Apr 2007) |
	  3 lines Make chan_sip report when it encounters an unknown
	  option. (issue #9440, reported by nightcrawler) ........

	* /, main/app.c: Merged revisions 59886 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r59886 | russell | 2007-04-03 12:58:19 -0500 (Tue, 03 Apr 2007) |
	  5 lines When doing a built-in blind or attended transfer, restore
	  the ability to use '#' to terminate the number and immediately do
	  the transfer instead of having to dial the number and just wait
	  for the feature digit timeout. (issue #8366, xueliangliang)
	  ........

	* Makefile: Ensure that menuselect gets executed in dependency
	  check mode every time you run make.

2007-04-03 11:02 +0000 [r59804]  Nadi Sarrar <ns@beronet.com>

	* channels/misdn_config.c, /, channels/misdn/chan_misdn_config.h:
	  Merged revisions 59788,59803 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r59788 | nadi | 2007-04-03 11:37:00 +0200 (Di, 03 Apr 2007) | 2
	  lines Use the new sysfs way of mISDN 1.2 to check if a port is NT
	  or not. ........ r59803 | nadi | 2007-04-03 12:40:58 +0200 (Di,
	  03 Apr 2007) | 2 lines ptp is the 5th bit, not the 4th. ........

2007-04-03 07:20 +0000 [r59774]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/misdn_config.c,
	  channels/chan_misdn.c, /, channels/misdn/chan_misdn_config.h:
	  Merged revisions 59623-59624,59639 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r59623 | crichter | 2007-04-02 09:12:24 +0200 (Mo, 02 Apr 2007) |
	  1 line we can now make 30 channels on a PRI (before we forgot
	  chan 31..) ........ r59624 | crichter | 2007-04-02 09:25:54 +0200
	  (Mo, 02 Apr 2007) | 1 line don't be verbose if no need ........
	  r59639 | crichter | 2007-04-02 14:08:12 +0200 (Mo, 02 Apr 2007) |
	  1 line added option which allows us to accept incoming SETUP
	  Messages without automatically sending Proceeding or Setup
	  Acknowledge, this is useful with some broken switches and if you
	  want to Release incoming calls without previously having
	  acknowledged them. The new option is
	  noautorespond_on_setup=yes|no default is no, so we don't break
	  the existing behaviour ........

2007-04-02 18:58 +0000 [r59724]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 59723 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r59723 | file | 2007-04-02 14:55:25 -0400 (Mon, 02 Apr 2007) | 2
	  lines Increase the maximum size for a string of mailboxes to
	  1024. (issue #9270 reported by rtucker) ........

2007-04-02 17:31 +0000 [r59688]  Steve Murphy <murf@digium.com>

	* pbx/pbx_ael.c: continue in for-loop should go to the incrementer,
	  not the test. As per 9435, thanks to marcelbarbulescu

2007-04-02 15:39 +0000 [r59654]  Russell Bryant <russell@digium.com>

	* main/netsock.c, /: Merged revisions 59608 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r59608 | russell | 2007-04-01 17:35:25 -0500 (Sun, 01 Apr 2007) |
	  6 lines Add the SO_REUSEADDR flag to sockets handled by netsock.
	  This is needed by the patch that went in for issue 7874.
	  chan_iax2 needs to be able to create socket that is lisetning on
	  INADDR_ANY, but also be able to bind sockets to specific
	  addresses. (Thanks to Stevenson on the asterisk-dev mailing list
	  for explaining why this flag was needed.) ........

2007-03-30 22:50 +0000 [r59573]  Jason Parker <jparker@digium.com>

	* configure, main/Makefile, acinclude.m4: Add linux-uclibc host
	  arch..."thingy". Sorry, I don't know what it's called...

2007-03-30 17:51 +0000 [r59452-59522]  Steve Murphy <murf@digium.com>

	* main/cdr.c, main/channel.c, main/pbx.c, res/res_features.c,
	  include/asterisk/cdr.h: several changes via kpflemings review

	* main/cdr.c, main/channel.c, main/pbx.c, res/res_features.c,
	  include/asterisk/cdr.h: These mods fix CDR issues from 8221,
	  8593, 8680, 8743, and perhaps others. Mainly with CDRs generated
	  from transfer situations.

	* configs/extensions.conf.sample: A small clarification to keep
	  bugs from being filed, and confusion from rising, if
	  clearglobalvars is set, and globals are set in the AEL file.
	  (9419)

2007-03-29 17:43 +0000 [r59363]  Russell Bryant <russell@digium.com>

	* res/res_jabber.c: When building a response to a subscription, the
	  "from" must be the full Jabber ID. This fixes some problems where
	  jabber users are not able to add their Asterisk account to their
	  user list, since they are unable to get Asterisk to approve their
	  subscription. (issue #8210, reported by caspy, and verified by
	  bradtem)

2007-03-29 17:38 +0000 [r59361]  Joshua Colp <jcolp@digium.com>

	* /, apps/app_meetme.c: Merged revisions 59360 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r59360 | file | 2007-03-29 13:33:58 -0400 (Thu, 29 Mar 2007) | 2
	  lines Keep a global array of variables indicating whether certain
	  conference rooms are in use. This ensures that two people going
	  into a new dynamic conference when the 'e' option is set don't go
	  into the same conference room. (issue #8835 reported by eliel)
	  ........

2007-03-29 17:17 +0000 [r59304-59358]  Russell Bryant <russell@digium.com>

	* main/rtp.c, /: Merged revisions 59357 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r59357 | russell | 2007-03-29 12:14:33 -0500 (Thu, 29 Mar 2007) |
	  5 lines If an error occurs when reading from an RTP socket, and
	  the error code does not indicate that we should try again, then
	  return NULL instead of a "null frame". This will prevent Asterisk
	  from trying over and over again, and eventually causing the
	  system to crash. (issue #8285, john) ........

	* /: Blocked revisions 59355 via svnmerge ........ r59355 | russell
	  | 2007-03-29 12:10:28 -0500 (Thu, 29 Mar 2007) | 3 lines Backport
	  the change to chan_iax2 to return NULL instead of a "null frame"
	  from its read callback. See revision 59341 to the 1.4 branch for
	  more info. ........

	* channels/chan_iax2.c: When the IAX2 read callback gets called,
	  return NULL instead of a "null frame". This will cause Asterisk
	  to hangup the call instead of keep trying whatever it was doing.
	  Under normal conditions, this function would *never* be called.
	  However, the author of this patch says an error will occur that
	  will cause it to get called every 100 thousand calls or so. When
	  this does happen, it puts the channel in a loop that eventually
	  brings down the system. So, hangup up the call is certainly a
	  better alternative. (issue #8286, john)

	* Makefile: Export the GTK2 library and include information to sub
	  Makefiles.

2007-03-29 16:07 +0000 [r59300-59302]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, cdr/cdr_odbc.c: Merged revisions 59301 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r59301 | tilghman | 2007-03-29 11:04:46 -0500 (Thu, 29 Mar 2007)
	  | 3 lines Issue 9415 - No point to getting a diagnostic field if
	  we aren't doing anything with the information. (Plus, it tends to
	  crash the Postgres ODBC driver.) ........

	* /: Blocked revisions 59299 via svnmerge ........ r59299 |
	  tilghman | 2007-03-29 10:33:10 -0500 (Thu, 29 Mar 2007) | 2 lines
	  Change ENV section to use setenv, instead of putenv (Alexandru
	  Pirvulescu <sigxcpu@gmail.com>, reported via -dev list) ........

2007-03-28 03:38 +0000 [r59281-59289]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* res/res_odbc.c: Another crash that I thought we had fixed already
	  - Issue 9396

	* apps/app_voicemail.c, /: Merged revisions 59283 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r59283 | tilghman | 2007-03-27 18:36:49 -0500 (Tue, 27 Mar 2007)
	  | 2 lines Oops ........

	* apps/app_voicemail.c, /: Merged revisions 59280 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r59280 | tilghman | 2007-03-27 18:31:20 -0500 (Tue, 27 Mar 2007)
	  | 2 lines Fix a few remaining bad mmap(2) return values ........

2007-03-27 23:20 +0000 [r59262-59278]  Russell Bryant <russell@digium.com>

	* /, apps/app_directory.c: Merged revisions 59277 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r59277 | russell | 2007-03-27 18:19:41 -0500 (Tue, 27 Mar 2007) |
	  3 lines Fix the check of the return value from mmap(). Thanks to
	  Corydon for catching this one. ........

	* apps/app_directory.c: Fix app_directory to actually compile with
	  ODBC_STORAGE, and update the code to the latest res_odbc API.

	* apps/Makefile: Fix app_directory when ODBC_STORAGE is being used.
	  The Makefile did not properly ensure that this information got
	  copied from what was selected for app_voicemail. (issue #9224)

	* channels/chan_sip.c: Fix the check that ensures that the CHANNEL
	  function's first argument is "rtpqos". Thanks, Corydon. :)

2007-03-27 18:16 +0000 [r59261]  Steve Murphy <murf@digium.com>

	* pbx/pbx_ael.c: via 9373 (duplicate context in AEL crashes
	  asterisk), kpfleming pointed on asterisk-dev, that DECLINE in
	  this case the proper thing to do. This change now has it doing
	  the proper thing.

2007-03-27 18:05 +0000 [r59256-59259]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 59258 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r59258 | russell | 2007-03-27 13:04:02 -0500 (Tue, 27 Mar 2007) |
	  4 lines Fix the use of the "sourceaddress" option when "bindaddr"
	  is set to 0.0.0.0 instead of having each interface explicitly
	  listed. (issue #7874, patch by stevens) ........

	* channels/chan_sip.c, funcs/func_channel.c: Convert the RTPQOS
	  function to just be additional parameter of the CHANNEL function.
	  This way, it will be possible for other RTP based channel drivers
	  to expose this information in the future.

2007-03-27 15:00 +0000 [r59254]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c, /: Merged revisions 59252 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r59252 | crichter | 2007-03-27 15:56:15 +0200 (Di, 27
	  Mär 2007) | 1 line fixed #9355 ........

2007-03-26 21:45 +0000 [r59230]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* channels/chan_sip.c: Oops, this should be case insensitive

2007-03-26 21:41 +0000 [r59228]  Steve Murphy <murf@digium.com>

	* pbx/pbx_ael.c: fix for 9373 (duplicate context in AEL crashes
	  asterisk). I turned a duplicate context from a WARNING to an
	  ERROR. Now you get a module load failure, and asterisk just
	  exits. That's better than a crash, right\?

2007-03-26 21:37 +0000 [r59227]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* channels/chan_sip.c: Change this to a single dp function to make
	  oej happy.

2007-03-26 20:06 +0000 [r59225]  Steve Murphy <murf@digium.com>

	* main/config.c: Fix for 9257; by eliminating the globals in
	  main/config.c, we make it thread-safe, which is a minimum
	  requirement.

2007-03-26 19:34 +0000 [r59223]  Joshua Colp <jcolp@digium.com>

	* apps/app_speech_utils.c: Add ability to specify no timeout. This
	  means as soon as the prompt is done playing it moves on to the
	  next priority.

2007-03-26 18:33 +0000 [r59215-59217]  Russell Bryant <russell@digium.com>

	* apps/app_voicemail.c: Somehow the code for building the email for
	  voicemail got out of sync. This change makes a few tweaks to get
	  1.4 in sync with trunk. (issue #9301)

	* apps/app_meetme.c: Fix some codec negotiation problems when
	  CallerID support is not enabled in SLA. (issue #9308, reported by
	  twilson)

2007-03-26 18:13 +0000 [r59213]  Joshua Colp <jcolp@digium.com>

	* apps/app_speech_utils.c: Make SpeechBackground obey the digit
	  timeout value.

2007-03-26 17:53 +0000 [r59207-59209]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Rename the new dialplan functions to match
	  the variable name

	* main/rtp.c, channels/chan_sip.c, include/asterisk/rtp.h: The
	  AUDIORTPQOS and VIDEORTPQOS variables are not fully functional in
	  some because they get set in sip_hangup. So, there are common
	  situations where the variables will not be available in the
	  dialplan at all. So, this patch provides an alternate method for
	  getting to this information by introducing AUDIORTPQOS and
	  VIDEORTPQOS dialplan functions. (issue #9370, patch by Corydon76,
	  with some testing by blitzrage)

2007-03-26 17:38 +0000 [r59206]  Steve Murphy <murf@digium.com>

	* main/ast_expr2.fl, main/ast_expr2f.c, pbx/ael/ael_lex.c,
	  pbx/ael/ael.flex: A fix for the flex input files, DONT_COMPILE,
	  and STANDALONE_AEL

2007-03-26 15:25 +0000 [r59202]  Nadi Sarrar <ns@beronet.com>

	* channels/misdn/isdn_lib.c, channels/misdn_config.c,
	  channels/misdn/isdn_lib.h, channels/chan_misdn.c, configure,
	  include/asterisk/autoconfig.h.in, channels/misdn/Makefile,
	  channels/misdn/chan_misdn_config.h, configure.ac: * mISDN >= 1.2
	  provides a dsp pipeline for i.e. echo cancellation modules, make
	  chan_misdn use it. * add a check for linux/mISDNdsp.h to
	  configure.ac and update the autogenerated files: 'configure',
	  'autoconfig.h.in' (the 'configure' script was not in sync with
	  the latest configure.ac, so the diff is a bit bigger than
	  expected).

2007-03-26 15:16 +0000 [r59200]  Joshua Colp <jcolp@digium.com>

	* pbx/ael/ael_lex.c: Have ast_copy_string magically appear in the
	  aelparse binary! DONT_OPTIMIZE should now work once again.

2007-03-24 01:39 +0000 [r59195]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 59194 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r59194 | file | 2007-03-23 21:35:49 -0400 (Fri, 23 Mar 2007) | 2
	  lines Only try to handle a response if it has a response code.
	  (ASA-2007-011) ........

2007-03-23 16:11 +0000 [r59188-59189]  Steve Murphy <murf@digium.com>

	* /: blocking out the fix in 59187... already incorporated here

	* /, apps/app_macro.c: Merged revisions 59186 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r59186 | murf | 2007-03-23 09:57:26 -0600 (Fri, 23 Mar 2007) | 1
	  line Added a few words in the Macro doc strings about the
	  behavior of macros with hangups (et al.), as per 9337 ........

2007-03-22 23:40 +0000 [r59180-59182]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_sip.c: don't allow string input to overrun the
	  buffer to hold it (ASA-2007-010)

	* channels/chan_misdn.c: remove variables that are no longer used
	  (--enable-dev-mode is good, developers should be using it)

2007-03-22 14:40 +0000 [r59145]  Steve Murphy <murf@digium.com>

	* utils/Makefile: The stuff in utils was compiling with -O6 even if
	  DONT_OPTIMIZE is set in menuconfig. Added the include to fix that

2007-03-21 18:08 +0000 [r59081-59089]  Joshua Colp <jcolp@digium.com>

	* main/http.c: Add svg mimetype for pari.

	* res/res_monitor.c, /: Merged revisions 59086 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r59086 | file | 2007-03-21 14:03:20 -0400 (Wed, 21 Mar 2007) | 2
	  lines Indicate the filename changed when it is changed. (issue
	  #9311 reported by jsmith) ........

	* channels/chan_sip.c: Until we can do media level parsing for
	  sendrecv/etc just use the first value found. This crept up when a
	  phone was offered audio+video and returned an inactive video
	  stream. chan_sip thought the phone said to put the person on hold
	  but that was totally wrong. (issue #9319 reported by benbrown)

2007-03-20 21:04 +0000 [r59078]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/logger.c: Fix defines for inline stack backtraces (only used
	  by developers anyway)

2007-03-20 20:42 +0000 [r59076]  Joshua Colp <jcolp@digium.com>

	* channels/iax2-parser.c: Copy len variable as well, should fix
	  remaining IAX2 DTMF issues.

2007-03-20 17:48 +0000 [r59069-59070]  Steve Murphy <murf@digium.com>

	* apps/app_stack.c: Ooops. Sorry, messed up app_stack. This should
	  return it to its previous, untouched, state.

	* apps/app_stack.c, pbx/pbx_ael.c, include/asterisk/ael_structs.h:
	  The fix for the AEL <<security hole>> (bug 9316) is here...

2007-03-20 13:16 +0000 [r59064]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/misdn_config.c,
	  channels/misdn/isdn_lib.h, channels/chan_misdn.c, /,
	  channels/misdn/chan_misdn_config.h: Merged revisions
	  58849-58850,59062-59063 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r58849 | crichter | 2007-03-13 12:58:16 +0100 (Di, 13 Mär 2007) |
	  1 line added method standard_dec for dialing out on groups, to
	  avoid conflicts, which caused issues with some ISDN providers
	  ........ r58850 | crichter | 2007-03-13 13:58:32 +0100 (Di, 13
	  Mär 2007) | 1 line fixed the crypt_keys stuff ........ r59062 |
	  crichter | 2007-03-20 10:18:06 +0100 (Di, 20 Mär 2007) | 1 line
	  avoid sending a disconnect when we already received one. ........
	  r59063 | crichter | 2007-03-20 10:23:22 +0100 (Di, 20 Mär 2007) |
	  1 line modified a loglevel ........

2007-03-19  Jason Parker  <jparker@digium.com>

	* Asterisk 1.4.2 released.

2007-03-19 22:29 +0000 [r59049]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* funcs/func_strings.c: Oops, this should have been a %d all along

2007-03-19 15:52 +0000 [r59042]  Joshua Colp <jcolp@digium.com>

	* funcs/func_cdr.c: Fix typo in help for CDR function. (issue #9295
	  reported by ajohnson)

2007-03-19 15:42 +0000 [r59040]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* configs/sip_notify.conf.sample: Fix unescaped semicolon (reported
	  via -dev list)

2007-03-18 20:37 +0000 [r59037]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Issue #9313, Asterisk crash on SIP return
	  code 0 (reported by qwerty1979)

2007-03-18 16:36 +0000 [r59035]  BJ Weschke <bweschke@btwtech.com>

	* apps/app_followme.c: Don't return a non-zero return code if the
	  profile doesn't exist, to match what the documentation says it
	  already does. (#9307 Reported by kkiely)

2007-03-16 16:12 +0000 [r58992]  Joshua Colp <jcolp@digium.com>

	* apps/app_page.c: Wait for the async thread to exit when hanging
	  up all of the paged phones under all circumstances. (issue #9181
	  reported by PhilSmith)

2007-03-16 01:42 +0000 [r58947-58957]  Russell Bryant <russell@digium.com>

	* configs/sla.conf.sample: fix a couple SLA documentation
	  references

	* doc/ajam.tex (removed), doc/manager.tex (removed), doc/misdn.tex
	  (removed), doc/freetds.txt (added), doc/odbcstorage.txt (added),
	  doc/sla.tex, doc/cygwin.txt (added), doc/model.txt (added),
	  doc/channelvariables.txt (added), doc/ael.txt (added),
	  doc/billing.tex (removed), build_tools/prep_tarball,
	  doc/callingpres.txt (added), doc/enum.txt (added),
	  doc/localchannel.tex (removed), doc/musiconhold-fpm.txt (added),
	  doc/cdrdriver.tex (removed), build_tools/make_buildopts_h,
	  doc/security.txt (added), doc/imapstorage.txt (added),
	  doc/PEERING, main/pbx.c, doc/odbcstorage.tex (removed),
	  doc/freetds.tex (removed), doc/privacy.txt (added), configure.ac,
	  doc/iax.txt (added), doc/ael.tex (removed),
	  doc/channelvariables.tex (removed), doc/enum.tex (removed),
	  doc/security.tex (removed), doc/math.txt (added), Makefile,
	  doc/imapstorage.tex (removed), doc/privacy.tex (removed),
	  doc/realtime.txt (added), doc/dundi.txt (added), doc/mysql.txt
	  (added), apps/app_voicemail.c, doc/cliprompt.txt (added),
	  doc/chaniax.txt (added), doc/app-sms.txt (added),
	  doc/ast_appdocs.tex (removed), doc/realtime.tex (removed),
	  doc/ices.txt (added), doc/dundi.tex (removed),
	  doc/linkedlists.txt (added), doc/queuelog.txt (added),
	  doc/extconfig.txt (added), doc/radius.txt (added),
	  doc/cliprompt.tex (removed), doc/chaniax.tex (removed),
	  doc/hardware.txt (added), doc/mp3.txt (added), doc/app-sms.tex
	  (removed), doc/ices.tex (removed), doc/asterisk.tex (removed),
	  doc/queuelog.tex (removed), doc/configuration.txt (added),
	  doc/asterisk-conf.txt (added), doc/sla.pdf (added),
	  doc/ip-tos.txt (added), doc/hardware.tex (removed), doc/h323.txt
	  (added), doc/mp3.tex (removed), doc/configuration.tex (removed),
	  doc/asterisk-conf.tex (removed), doc/jitterbuffer.txt (added),
	  doc/channels.txt (added), doc/ip-tos.tex (removed),
	  doc/extensions.txt (added), doc/queues-with-callback-members.txt
	  (added), doc/apps.txt (added), makeopts.in, doc/ajam.txt (added),
	  doc/misdn.txt (added), doc/manager.txt (added),
	  doc/jitterbuffer.tex (removed), doc/extensions.tex (removed),
	  doc/billing.txt (added), doc/localchannel.txt (added),
	  doc/queues-with-callback-members.tex (removed), doc/cdrdriver.txt
	  (added), doc/00README.1st (added): Making these documentation
	  changes in the 1.4 branch upset various people, so these chanes
	  will only be done in the trunk.

	* build_tools/prep_tarball: Add the --pdf option to the usage of
	  rubber in prep_tarball

	* Makefile, build_tools/menuselect-deps.in, configure,
	  include/asterisk/autoconfig.h.in, configure.ac, makeopts.in: Add
	  configure script checking for GTK2 and some additional Makefile
	  targets to support gmenuselect

2007-03-15 23:52 +0000 [r58946]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/pbx.c, doc/ast_appdocs.tex: Refashion dump command to match
	  common syntax and update the resulting appdocs TeX file

2007-03-15 23:24 +0000 [r58941]  Russell Bryant <russell@digium.com>

	* doc/asterisk.tex: add a link to the rubber homepage

2007-03-15 23:11 +0000 [r58939]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_setcdruserfield.c, main/pbx.c,
	  apps/app_hasnewvoicemail.c, apps/app_settransfercapability.c:
	  Expand deprecation warnings from simply warning on use to the
	  builtin documentation.

2007-03-15 22:51 +0000 [r58935-58937]  Russell Bryant <russell@digium.com>

	* doc/asterisk.tex, Makefile: Add Asterisk version information to
	  the generated PDF

	* build_tools/prep_tarball: have prep_tarball attempt to build
	  asterisk.pdf

2007-03-15 22:32 +0000 [r58933]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* funcs/func_realtime.c: Function works fine, but the documentation
	  is backwards.

2007-03-15 22:25 +0000 [r58931]  Russell Bryant <russell@digium.com>

	* doc/ajam.tex (added), doc/manager.tex (added), doc/misdn.tex
	  (added), doc/freetds.txt (removed), doc/odbcstorage.txt
	  (removed), configure, doc/sla.tex, doc/cygwin.txt (removed),
	  doc/model.txt (removed), doc/channelvariables.txt (removed),
	  doc/ael.txt (removed), doc/billing.tex (added),
	  doc/callingpres.txt (removed), doc/enum.txt (removed),
	  doc/localchannel.tex (added), doc/musiconhold-fpm.txt (removed),
	  doc/cdrdriver.tex (added), build_tools/make_buildopts_h,
	  doc/security.txt (removed), doc/imapstorage.txt (removed),
	  doc/PEERING, main/pbx.c, doc/odbcstorage.tex (added),
	  doc/freetds.tex (added), doc/privacy.txt (removed), configure.ac,
	  doc/iax.txt (removed), doc/ael.tex (added),
	  doc/channelvariables.tex (added), doc/enum.tex (added),
	  doc/security.tex (added), doc/math.txt (removed), Makefile,
	  doc/imapstorage.tex (added), doc/privacy.tex (added),
	  doc/realtime.txt (removed), doc/dundi.txt (removed),
	  doc/mysql.txt (removed), apps/app_voicemail.c, doc/cliprompt.txt
	  (removed), doc/chaniax.txt (removed), doc/app-sms.txt (removed),
	  doc/ast_appdocs.tex (added), doc/realtime.tex (added),
	  doc/ices.txt (removed), doc/dundi.tex (added),
	  doc/linkedlists.txt (removed), doc/queuelog.txt (removed),
	  doc/extconfig.txt (removed), doc/radius.txt (removed),
	  doc/cliprompt.tex (added), doc/chaniax.tex (added),
	  doc/hardware.txt (removed), doc/mp3.txt (removed),
	  doc/app-sms.tex (added), doc/ices.tex (added), doc/asterisk.tex
	  (added), doc/queuelog.tex (added), doc/configuration.txt
	  (removed), doc/asterisk-conf.txt (removed), doc/sla.pdf
	  (removed), doc/ip-tos.txt (removed), doc/hardware.tex (added),
	  doc/h323.txt (removed), doc/mp3.tex (added),
	  doc/configuration.tex (added), doc/asterisk-conf.tex (added),
	  doc/jitterbuffer.txt (removed), doc/channels.txt (removed),
	  doc/ip-tos.tex (added), doc/extensions.txt (removed),
	  doc/queues-with-callback-members.txt (removed), doc/apps.txt
	  (removed), makeopts.in, doc/ajam.txt (removed), doc/misdn.txt
	  (removed), doc/manager.txt (removed), doc/jitterbuffer.tex
	  (added), doc/extensions.tex (added), doc/billing.txt (removed),
	  doc/localchannel.txt (removed),
	  doc/queues-with-callback-members.tex (added), doc/cdrdriver.txt
	  (removed), doc/00README.1st (removed): Merge changes from
	  svn/asterisk/team/russell/LaTeX_docs. * Convert most of the doc
	  directory into a single LaTeX formatted document so that we can
	  generate a PDF, HTML, or other formats from this information. *
	  Add a CLI command to dump the application documentation into
	  LaTeX format which will only be include if the configure script
	  is run with --enable-dev-mode. * The PDF turned out to be close
	  to 1 MB, so it is not included. However, you can simply run "make
	  asterisk.pdf" to generate it yourself. We may include it in
	  release tarballs or have automatically generated ones on the web
	  site, but that has yet to be decided.

2007-03-15 18:13 +0000 [r58923]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: Don't assume that the pvt structure will
	  still exist after calling schedule_delivery as it may not. (issue
	  #9278 reported by fmachado)

2007-03-14 19:18 +0000 [r58894-58906]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Some people like to put "limitonpeer"
	  instead of "limitonpeers" in their configuration. While we're at
	  it, support "limitonpeerz" and "limitonpeerssssss". (inspired by
	  issue #9172)

	* doc/sla.pdf, doc/sla.tex: Add a more basic example setup to the
	  examples section

	* doc/security.txt, /: Merged revisions 58896 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r58896 | russell | 2007-03-14 11:38:48 -0500 (Wed, 14 Mar 2007) |
	  3 lines Add a note to the security file that the Asterisk CLI and
	  log files may contain sensitive information, and that people
	  should keep this in mind. ........

	* configs/sla.conf.sample, apps/app_meetme.c: By default, don't
	  attempt to do any CallerID handling at all with SLA because it is
	  known to not work properly in some situations. However, add an
	  option to enable it for those that would like to use it anyway.
	  The short story behind this is that to properly handle CallerID
	  with SLA, we need the ability to change the CallerID on an
	  existing call, and we are not ready to handle that.

2007-03-14 01:47 +0000 [r58880]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* funcs/func_strings.c: Issue 9162 -
	  pbx_substitute_variables_helper assumes the buffer is initialized
	  to all zeroes. This fixes a case where it wasn't.

2007-03-13 23:19 +0000 [r58870-58872]  Russell Bryant <russell@digium.com>

	* apps/app_meetme.c: Ensure that the blinky lights show that the
	  trunk stopped ringing when the trunk hangs up before a station
	  has answered it. (issue #9234, reported by francesco_r)

	* configs/sla.conf.sample: fix the reference to the SLA
	  documentation

2007-03-13 11:49 +0000 [r58843-58848]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Merged revisions 58847 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r58847 | oej | 2007-03-13 12:45:52 +0100 (Tue, 13 Mar 2007) | 2
	  lines Issue #9229 - No port in request URI on register to non
	  default SIP ports (neelakantan) ........

	* channels/chan_sip.c: Don't hangup the call on OK or errors on
	  MESSAGE and INFO inside of a dialog (like video update requests).

	* channels/chan_sip.c: Issue #9251 - Clear From URI from user
	  attributes (tgrman)

2007-03-12 16:52 +0000 [r58833]  Joshua Colp <jcolp@digium.com>

	* /: Blocked revisions 58832 via svnmerge ........ r58832 | file |
	  2007-03-12 12:49:49 -0400 (Mon, 12 Mar 2007) | 2 lines We can't
	  use the assembler version of fetchadd_int under Intel Macs.
	  (issue #9254 reported by darrell budic) ........

2007-03-12 13:08 +0000 [r58825-58826]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/chan_misdn.c, /: Merged
	  revisions 57034,57523,57753,58558 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r57034 | crichter | 2007-02-28 17:09:27 +0100 (Mi, 28 Feb 2007) |
	  1 line fixed bugs.digium.com bugs: #9157 and bugs.beronet.com
	  bugs: #302, #303, #304 ........ r57523 | crichter | 2007-03-02
	  19:32:51 +0100 (Fr, 02 Mar 2007) | 1 line fixed typo ........
	  r57753 | crichter | 2007-03-04 11:39:50 +0100 (So, 04 Mar 2007) |
	  1 line fixed another place where the out_cause was hardcoded to
	  16 ........ r58558 | crichter | 2007-03-09 15:43:58 +0100 (Fr, 09
	  Mar 2007) | 1 line we can free channel 31 as well, since we can
	  occupy it ........

	* channels/misdn/isdn_lib.c, channels/misdn/isdn_lib.h,
	  channels/chan_misdn.c, channels/misdn/ie.c,
	  channels/misdn/isdn_msg_parser.c: added UU transceiving and
	  corect handling for rdnis

2007-03-12 01:21 +0000 [r58779-58783]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Allow RFC2833 compensation to compensate for even
	  stupider implementations by queueing up the end frame at the
	  start, not the actual end. (issue #8963 reported by AndrewZ)

	* channels/chan_sip.c, configs/sip.conf.sample: Add
	  matchexterniplocally setting which only substitutes your
	  externip/externhost setting if it matches the localnet setting. I
	  know of at least two people who need opposite settings, so I made
	  it an option! (issue #8821 reported by kokoskarokoska)

2007-03-10 18:11 +0000 [r58638-58705]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Fix a few more places in chan_iax2 where
	  the ast_frame used for receiving a frame was not properly
	  initialized. - Interpolating a frame when the jitterbuffer is in
	  use - decrypting a frame when IAX2 encryption is on - frames in
	  an IAX2 trunk

	* apps/app_meetme.c: Make the compiler happy and initialize a
	  variable.

	* doc/sla.pdf (added), doc/sla.txt (removed), doc/sla.tex (added):
	  Merge some updates to the SLA documentation. I plan to keep
	  working on this to explain all of the expected behavior with call
	  handling, configuration details for specific phones, and other
	  things. However, I got tired of doing it in plain text, so I
	  switched to using LaTeX. I have included the PDF version. I
	  haven't been able to get a nice looking plain text version out of
	  it yet, but I'm not terribly concerned since this is supposed to
	  be more of the manual, while the plain text sample configuration
	  file is the reference.

2007-03-09 21:08 +0000 [r58584-58604]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c: Fix spelling of unavailable in voicemail
	  documentation. (issue #9248 reported by tensai)

	* /, channels/chan_sip.c: Merged revisions 58579 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r58579 | file | 2007-03-09 15:46:43 -0500 (Fri, 09 Mar 2007) | 2
	  lines If we are unable to lookup the host in a c line we have to
	  abort, otherwise the previous data is gone and we will
	  (potentially) have no data when all is said and done. ........

2007-03-08 22:15 +0000 [r58510-58512]  Russell Bryant <russell@digium.com>

	* apps/app_meetme.c: Hang up the channel that put the call on hold
	  in the event processing thread to avoid a race condition. Also,
	  if the station originated the call that it is putting on hold,
	  don't hang up the trunk if it was the only station on the call
	  and it is hanging up due to hold and not a normal hangup.

	* channels/chan_zap.c: Add a missing break statement so that
	  handling the above event does not incorrectly destroy the
	  channel. (issue #9242, andrew)

2007-03-08 21:33 +0000 [r58479]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* res/res_odbc.c: Fix segfault (Issue 9236)

2007-03-08 20:54 +0000 [r58474]  Russell Bryant <russell@digium.com>

	* apps/app_meetme.c: Refactor hold handling a bit so that it does
	  not require keeping the call up when a call is put on hold.

2007-03-08 18:01 +0000 [r58389-58436]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Make early SDP seeding even smarter! We have to check
	  codecs in the make_compatible function too. (issue #9221 reported
	  by marcelbarbulescu)

	* main/dsp.c, /: Merged revisions 58388 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r58388 | file | 2007-03-08 11:04:58 -0500 (Thu, 08 Mar 2007) | 2
	  lines Only print out debug message if the definition that makes
	  the variables shows up was actually defined. (issue #9233
	  reported by serginuez) ........

2007-03-08 13:23 +0000 [r58351-58354]  Kevin P. Fleming <kpfleming@digium.com>

	* main/http.c: this change was not needed; fclose() handles closing
	  the file descriptor already

	* apps/app_meetme.c: fix a compiler warning, and overwriting 'res'
	  value

	* main/http.c: fix two cases where HTTP session file descriptors
	  would not be closed

2007-03-08 01:01 +0000 [r58243-58320]  Russell Bryant <russell@digium.com>

	* channels/chan_zap.c, configure, configure.ac: If we receive
	  ZT_EVENT_REMOVED, destroy the specified channel. (issue #7256,
	  tzafrir) Also, update the configure script to make sure that we
	  don't try to build chan_zap if the installed version of zaptel
	  does not include ZT_EVENT_REMOVED.

	* /, channels/chan_iax2.c: (This bug was reported to me by Kinsey
	  Moore) Merged revisions 58242 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r58242 | russell | 2007-03-07 12:17:07 -0600 (Wed, 07 Mar 2007) |
	  7 lines Fix a problem where the Asterisk channel name could be
	  that of the wrong IAX2 user for a call. This is because the first
	  step of choosing this name is to look for an IAX2 peer that
	  happens to have the same IP/port number that this call is coming
	  from and assuming that is it. However, this is not always
	  correct. So, I have made it change this name after authentication
	  happens since at that point, we have an exact match. ........

2007-03-07 17:52 +0000 [r58240]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c, channels/chan_sip.c: Ensure we have (or should have)
	  at least one matching codec before attempting early bridge SDP
	  seeding. (issue #9221 reported by marcelbarbulescu)

2007-03-07 00:27 +0000 [r58165-58168]  Russell Bryant <russell@digium.com>

	* /: Blocked revisions 58167 via svnmerge ........ r58167 | russell
	  | 2007-03-06 18:27:04 -0600 (Tue, 06 Mar 2007) | 2 lines Fix a
	  misplaced block of code in the 1.2 version of the patch to fix
	  issue #8977 ........

	* main/manager.c, /: Merged revisions 58164 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r58164 | russell | 2007-03-06 18:20:13 -0600 (Tue, 06 Mar 2007) |
	  4 lines If the channels acquired using the manager Redirect
	  action are not up, then don't attempt to do anything with them.
	  It could lead to weird behavior, including crashes. (issue #8977)
	  ........

2007-03-06 23:10 +0000 [r58121]  Steve Murphy <murf@digium.com>

	* /, channels/chan_sip.c: Merged revisions 58115 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r58115 | murf | 2007-03-06 15:52:52 -0700 (Tue, 06 Mar 2007) | 1
	  line Fix for 9220: Eyebeam cannot renew subscriptions for
	  presence info. Reason: re-SUBSCRIBE requests don't include Accept
	  headers, which the rfc says are optional (to put it tersely), (it
	  uses MAY), and luckily, the sip_pvt struct has the format info
	  stored, so we simply leave it if the format is set, and the
	  accept header null. ........

2007-03-06 23:00 +0000 [r58119]  Russell Bryant <russell@digium.com>

	* configs/voicemail.conf.sample: Clarify the documentation of the
	  dialout and sendvoicemail options. (issue #9000, caio1982 and
	  serge-v)

2007-03-06 20:37 +0000 [r58053]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Merged revisions 58052 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r58052 | oej | 2007-03-06 21:33:21 +0100 (Tue, 06 Mar 2007) | 2
	  lines Change error message to proper message ........

2007-03-06 18:01 +0000 [r58023]  Russell Bryant <russell@digium.com>

	* channels/chan_skinny.c: Return an error of transmit_response is
	  called without a session. (issue #9002)

2007-03-05 19:19 +0000 [r57870-57914]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: Since chan_iax2 does not support reception
	  of DTMF with duration ensure that it is set to 0 on the frame.
	  (issue #8521 reported by gdhgdh)

	* apps/app_meetme.c: Don't create a listen channel and record the
	  conference unless the option is turned on. (issue #9204 reported
	  by francesco_r)

	* apps/app_voicemail.c, /: Merged revisions 57869 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r57869 | file | 2007-03-05 12:49:18 -0500 (Mon, 05 Mar 2007) | 2
	  lines Make create_dirpath use our standard for return values. -1
	  is failure, 0 is success. (issue #9205 reported by ballares)
	  ........

2007-03-05 15:20 +0000 [r57826]  Steve Murphy <murf@digium.com>

	* main/pbx.c, /: Merged revisions 57825 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r57825 | murf | 2007-03-05 07:53:57 -0700 (Mon, 05 Mar 2007) | 1
	  line Fixed a typo introduced via 9156 (either the gotos or their
	  doc strings are wrong) ........

2007-03-05 04:19 +0000 [r57768-57798]  Joshua Colp <jcolp@digium.com>

	* main/slinfactory.c: Don't allow a NULL pointer to reach
	  ast_frdup. (issue #9155 reported by cmaj)

	* res/res_jabber.c: Don't reference a potentially NULL pointer.
	  (issue #9199 reported by klolik)

	* main/rtp.c: Preserve marker bit when P2P bridging. (issue #9198
	  reported by edgreenberg)

2007-03-03 15:31 +0000 [r57707]  Steve Murphy <murf@digium.com>

	* pbx/ael/ael-test/ref.ael-vtest13, pbx/ael/ael-test/ref.ael-test2,
	  pbx/ael/ael-test/ref.ael-test4, pbx/ael/ael-test/ref.ael-test7:
	  Updated the regression tests

2007-03-03 06:45 +0000 [r57649]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c, /: Merged revisions 57648 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r57648 | tilghman | 2007-03-03 00:36:55 -0600 (Sat, 03 Mar 2007)
	  | 2 lines Memory leak of a list, if call recording was abandoned
	  ........

2007-03-03 00:59 +0000 [r57620]  Dwayne M. Hubbard <dhubbard@digium.com>

	* main/say.c: submitted patch for Georgian language, issue 9010,
	  submitted by Alexander Shaduri

2007-03-03 00:02 +0000 [r57591]  Russell Bryant <russell@digium.com>

	* configs/sla.conf.sample: add missing configuration template.
	  Thanks to Lacy Moore on asterisk-users for pointing this out\!

2007-03-02  Russell Bryant  <russell@digium.com>

	* Asterisk 1.4.1 released.

2007-03-02 23:03 +0000 [r57556]  Russell Bryant <russell@digium.com>

	* configure, configure.ac: Update the check that is used to
	  determine whether zaptel transcoder support is present. The
	  interface has changed.

2007-03-02 17:06 +0000 [r57477]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 57475 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r57475 | file | 2007-03-02 12:02:46 -0500 (Fri, 02 Mar 2007) | 2
	  lines If a SIP message comes in and goes to a method handler that
	  requires additional values that may not be present then send back
	  an error. ........

2007-03-02 16:55 +0000 [r57426-57473]  Steve Murphy <murf@digium.com>

	* main/pbx.c, /: Merged revisions 57458 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r57458 | murf | 2007-03-02 09:39:33 -0700 (Fri, 02 Mar 2007) | 1
	  line further refinement in wording of goto documentation, as per
	  9156, goto not proceeding to next instruction ........

	* pbx/pbx_ael.c, utils/ael_main.c: I almost had comma escapes
	  right, but 9184 points out the problem-- the escape is removed by
	  pbx_config, and pbx_ael should also, before sending it down into
	  the pbx engine. Also, you have to insert it back in, if you are
	  generating extensions.conf code from the AEL.

2007-03-02 00:20 +0000 [r57364-57396]  Russell Bryant <russell@digium.com>

	* main/file.c: Return the correct digit that interrupted the
	  stream. This fixes exiting the Background application when using
	  the m option. (issue #9176, mjagdis)

	* configs/sla.conf.sample, apps/app_meetme.c, doc/sla.txt,
	  include/asterisk/channel.h: Merge changes from
	  svn/asterisk/team/russell/sla_updates * Originally, I put in the
	  documentation that only Zap interfaces would be supported on the
	  trunk side. However, after a discussion with Qwell, we came up
	  with a way to make IP trunks work as well, using some things
	  already in Asterisk. So, here it is, this now officially supports
	  IP trunks. * Update the SLA documentation to reflect how to setup
	  IP trunks. * Add a section in sla.txt that describes how to set
	  up an SLA system with voicemail. * Simplify the way DTMF
	  passthrough is handled in MeetMe. * Fix a bug that exposed itself
	  when using a Local channel on the trunk side in SLA. The
	  station's channel needs to be passed to the dial API when dialing
	  the trunk. * Change a WARNING message to DEBUG in channel.h. This
	  message is of no use to users.

2007-03-01 22:21 +0000 [r57318]  Joshua Colp <jcolp@digium.com>

	* channels/chan_local.c, /: Merged revisions 57317 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r57317 | file | 2007-03-01 17:19:32 -0500 (Thu, 01 Mar
	  2007) | 2 lines Don't even attempt to optimize things when a
	  proxy channel is involved. It will just explode in weird and
	  unexplaineable ways. (issue #9175 reported by
	  clegall_proformatique) ........

2007-03-01 03:02 +0000 [r57263]  TransNexus OSP Development <support@transnexus.com>

	* doc/osp.txt: 1. Corrected a typo for www.etsi.org. Thank Patrick.

2007-02-28 23:01 +0000 [r57144-57207]  Russell Bryant <russell@digium.com>

	* configs/sla.conf.sample, doc/sla.txt: minor tweaks to the sla
	  docs

	* configs/sla.conf.sample, apps/app_meetme.c: Merge more changes
	  from svn/asterisk/team/russell/sla_updates * Add support for
	  private hold. By setting "hold=private" for a trunk, only the
	  station that put the call on hold will be able to retrieve it
	  from hold. Also, by setting "hold=private" for a station, any
	  call that station puts on hold can only be retrieved by that
	  station.

	* apps/app_meetme.c: Minor formatting change

	* configs/sla.conf.sample, apps/app_meetme.c: Merge changes from
	  svn/asterisk/team/russell/sla_updates * Add support for the
	  "barge=no" option for trunks. If this option is set, then
	  stations will not be able to join in on a call that is on
	  progress on this trunk.

2007-02-28 19:23 +0000 [r57139]  Steve Murphy <murf@digium.com>

	* main/pbx.c, /: Merged revisions 57118 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r57118 | murf | 2007-02-28 12:12:41 -0700 (Wed, 28 Feb 2007) | 1
	  line a small documentation update, to reflect reality in the goto
	  doc strings, as per 9156, Goto does not proceed to next prio if
	  jump fails ........

2007-02-28 18:57 +0000 [r57093]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_agent.c: Merged revisions 57092 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r57092 | file | 2007-02-28 13:55:45 -0500 (Wed, 28 Feb
	  2007) | 2 lines Fix a few more issues with the agent logoff CLI
	  command. (issue #9123 reported by arbrandes) ........

2007-02-28 18:20 +0000 [r57089]  Russell Bryant <russell@digium.com>

	* configs/sla.conf.sample, apps/app_meetme.c: Merge current set of
	  changes from svn/asterisk/team/russell/sla_updates * Add support
	  for station ring delays. Ring delays can be set globally for a
	  station or for specific trunks on the station. * Fix a few bugs
	  in existing code. * Restructure and Reorganize code to improve
	  readability and maintainability. * Improve formatting of the "sla
	  show (trunks|stations)" CLI commands.

2007-02-28 17:55 +0000 [r57053-57055]  Joshua Colp <jcolp@digium.com>

	* apps/app_meetme.c: Picky compiler...

	* apps/app_speech_utils.c: Better handle timeouts when the
	  individual speaks after everything has been played but before the
	  timeout ends.

2007-02-28 17:15 +0000 [r57049]  Steve Murphy <murf@digium.com>

	* pbx/pbx_ael.c: I was surprised that I had not yet downgraded
	  missing goto targets and macro call defs to a warning, in case
	  they are in extensions.conf; I rectified this problem. Also, A
	  goto in a macro to a target in a catch block was not being found;
	  I fixed this too; the cause was that I needed to treat catch
	  statements like an extension in the find_match code.

2007-02-27 17:36 +0000 [r56975]  Russell Bryant <russell@digium.com>

	* apps/app_voicemail.c: Fix voicemail email attachments. I missed
	  the conversion of one of the line endings and there was an extra
	  one where it should not have been. (issue #9128)

2007-02-26 22:01 +0000 [r56922]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_lookupcidname.c, apps/app_lookupblacklist.c: Picky,
	  picky... show deprecation warning in application help, too
	  (reported via list)

2007-02-26 20:42 +0000 [r56888]  Russell Bryant <russell@digium.com>

	* channels/chan_alsa.c: Restore the behavior of Asterisk 1.2 where
	  if a device was not specified in alsa.conf, then we just use the
	  system default, instead of creating our own default of hw:0,0.
	  (issue #9139)

2007-02-26 20:07 +0000 [r56856]  Joshua Colp <jcolp@digium.com>

	* /, pbx/pbx_config.c: Merged revisions 56850 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r56850 | file | 2007-02-26 15:05:02 -0500 (Mon, 26 Feb 2007) | 2
	  lines Obey the clearglobalvars option in extensions reload (or
	  dialplan reload depending on your version). (issue #9146 reported
	  by ramonpeek) ........

2007-02-26 20:04 +0000 [r56847]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Fix a crash in my last change to
	  iax2_indicate(). (issue #9150)

2007-02-26 19:33 +0000 [r56805-56839]  Joshua Colp <jcolp@digium.com>

	* apps/app_record.c: Update app_record documentation to use new CLI
	  command, core show file formats. (issue #9151 reported by junky)

	* main/pbx.c: Use ast_strlen_zero to see if the language and/or
	  context argument is not present for Background instead of just
	  checking if it is NULL. (issue #9141 reported by mjagdis)

2007-02-26 16:51 +0000 [r56785]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Do more complete locking of the
	  chan_iax2_pvt struct in the indicate callback. (Problem brought
	  up by Ben Smithurst on the asterisk-dev list)

2007-02-26 16:36 +0000 [r56783]  Joshua Colp <jcolp@digium.com>

	* main/asterisk.c: Allow both of the show version files and core
	  show file versions CLI commands to work. (issue #9135 reported by
	  mvanbaak)

2007-02-26 01:04 +0000 [r56730-56740]  Russell Bryant <russell@digium.com>

	* apps/app_meetme.c: Move a comment to be in the correct struct.

	* /: Blocked revisions 56729 via svnmerge ........ r56729 | russell
	  | 2007-02-25 18:34:31 -0600 (Sun, 25 Feb 2007) | 4 lines Ensure
	  that lock.h is included in utils.c with AST_API_MODULE defined so
	  that the implementations will be properly included when the
	  AST_INLINE_API functions are not going to be inlined. (issue
	  #9124, festr) ........

2007-02-25 14:46 +0000 [r56685]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/channel.c, /: Merged revisions 56684 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r56684 | tilghman | 2007-02-25 08:38:03 -0600 (Sun, 25 Feb 2007)
	  | 3 lines Issue 9130 - If prev is the last item on the channel
	  list, then evaluating additional conditions (e.g. name prefix)
	  will cause a NULL dereference. ........

2007-02-24 02:02 +0000 [r56569]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Make sure to set a speeddials parent on
	  creation. Don't crash if hold is pressed when no call is active.
	  Don't return in places that we shouldn't..

2007-02-24 00:53 +0000 [r56548]  Kevin P. Fleming <kpfleming@digium.com>

	* codecs/codec_zap.c: update to match zaptel 1.4 API change that
	  was committed a few minutes ago

2007-02-23 23:24 +0000 [r56505]  Russell Bryant <russell@digium.com>

	* main/asterisk.c, /: Merged revisions 56504 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r56504 | russell | 2007-02-23 17:20:55 -0600 (Fri, 23 Feb 2007) |
	  8 lines Fix up a couple more signal handlers to not do bad things
	  that could cause various undesirable results. The other day, I
	  made Asterisk deadlock by hitting Control-C because of a bad
	  signal handler. Now, signal handlers just set a flag and write to
	  an alert pipe for the flag to be handled. Then, there is another
	  thread that is monitoring for these flags. If being run in
	  console mode, it is just the main thread. If Asterisk is in the
	  background, a thread is created to do it. ........

2007-02-23 21:53 +0000 [r56457]  Joshua Colp <jcolp@digium.com>

	* main/sched.c: Change log notice to debug. It is possible for a
	  scheduled item to execute and be deleted at close to the same
	  time and unavoidable. If this happens this message creeps up.

2007-02-23 20:20 +0000 [r56407]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 56406 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r56406 | russell | 2007-02-23 14:17:56 -0600 (Fri, 23 Feb 2007) |
	  4 lines Don't destroy mutexes before unregistering all of the
	  entry points from the core. Also, fix a potential memory leak
	  from not destroying the locks for all of the possible call
	  numbers (about 32k of them). ........

2007-02-23 18:59 +0000 [r56372]  Kevin P. Fleming <kpfleming@digium.com>

	* build_tools/make_version_h: build special version strings for
	  AADK/S800i builds

2007-02-23 17:58 +0000 [r56341]  Russell Bryant <russell@digium.com>

	* apps/app_voicemail.c: The IMAP storage code uses the same code to
	  build the email that is used when voicemail is sent via email
	  using something like sendmail. In the patch from bug 8033 to fix
	  various IMAP storage problems, the line endings in the email file
	  were changed in the code from "\n" to "\r\n". However, this
	  breaks sending regular voicemail to email. So, this change
	  conditionally sets line endings to "\r\n" only if IMAP_STORAGE is
	  enabled. (issue #9128, patch by jarjarbinks, modified by me to
	  not break IMAP storage)

2007-02-22 23:25 +0000 [r56280]  Joshua Colp <jcolp@digium.com>

	* /: Blocked revisions 56279 via svnmerge ........ r56279 | file |
	  2007-02-22 18:19:25 -0500 (Thu, 22 Feb 2007) | 2 lines Always
	  defer Agent logoff if any channels are up until they hang up.
	  (issue #9123 reported by arbrandes) ........

2007-02-22 23:08 +0000 [r56277]  Russell Bryant <russell@digium.com>

	* configs/sla.conf.sample, main/dial.c, apps/app_meetme.c,
	  doc/sla.txt: Merge changes from team/russell/sla_updates. This
	  batch of changes to the SLA code does a few different things. * I
	  made the SLA code event driven instead of having to act in a lot
	  of busy loops while dialing things to wait for state changes.
	  This makes the code more efficient and readable at the same time.
	  * I have implemented a couple of new features. The first is
	  inbound trunk ringing timeouts. This is an option that defines
	  how long to let an incoming call on a trunk to ring. * I have
	  also implemented ring timeouts for stations. They may be
	  specified for the entire station, meaning it is how long to let
	  the station ring before giving up. You can also specify a ring
	  timeout for a specific trunk on a station. So, you can say that
	  you only want a specific station to ring 5 seconds if it is line1
	  ringing, but otherwise, there is no timeout.

2007-02-22 18:49 +0000 [r56231]  Joshua Colp <jcolp@digium.com>

	* main/channel.c, /, channels/chan_sip.c: Merged revisions 56230
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r56230 | file | 2007-02-22 13:44:24 -0500 (Thu, 22 Feb 2007) | 2
	  lines Only change the original or clone channel if it's the
	  channel behind the proxy channel, not if it's just a regular
	  bridged channel. ........

2007-02-22 14:06 +0000 [r56169]  TransNexus OSP Development <support@transnexus.com>

	* doc/osp.txt: Update OSP documentation for v1.4.

2007-02-22 10:33 +0000 [r56125]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Move message from verbose to debug

2007-02-22 02:39 +0000 [r56094]  Steve Murphy <murf@digium.com>

	* sounds/Makefile: updated the sound tarball versions in Makefile

2007-02-22 01:24 +0000 [r56011-56055]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Restructure a little bit of code to reduce
	  nesting. There is no functionality change here.

	* /, channels/chan_sip.c: Merged revisions 56010 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r56010 | russell | 2007-02-21 18:53:25 -0600 (Wed, 21 Feb 2007) |
	  3 lines If we receive a frame that is not in any of the
	  negotiated formats, then drop it. (potentially issue #8781 and
	  SPD-12) ........

2007-02-22 00:35 +0000 [r56008]  Joshua Colp <jcolp@digium.com>

	* main/cli.c: Print out deprecation notice on usage output of CLI
	  commands. (issue #8925 reported by blitzrage)

2007-02-22 00:08 +0000 [r56006]  Kevin P. Fleming <kpfleming@digium.com>

	* main/loader.c: disable unloading of embedded modules... there is
	  a fundamental problem with doing so that will not be fixed in
	  this version of Asterisk due to its invasiveness

2007-02-21 20:35 +0000 [r55957]  Joshua Colp <jcolp@digium.com>

	* /, apps/app_meetme.c: Merged revisions 55956 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r55956 | file | 2007-02-21 15:32:16 -0500 (Wed, 21 Feb 2007) | 2
	  lines Change naughty warning message to provide useful
	  information. If a write now fails on a channel in meetme it will
	  tell you the channel name instead of spitting out the wrong error
	  message. ........

2007-02-21 20:27 +0000 [r55954]  Jason Parker <jparker@digium.com>

	* channels/chan_gtalk.c: Fix locking issue, and accept
	  "transport-accept" as a valid accept message. This should solve
	  issues 8970 and 8503.

2007-02-21 20:22 +0000 [r55951]  Russell Bryant <russell@digium.com>

	* apps/app_meetme.c: Simplify the last change to app_meetme, and
	  move the call to dispose_conf() up into the block where we know a
	  conf exists.

2007-02-21 20:16 +0000 [r55914-55949]  Joshua Colp <jcolp@digium.com>

	* apps/app_meetme.c: Only dispose of the conference if one was
	  created.

	* apps/app_speech_utils.c: Only start playing the next file if we
	  have not been quieted.

	* channels/chan_sip.c: Add a flag that indicates whether a SIP
	  dialog is an outgoing call or not. SIP_OUTGOING originally did it
	  but it was repurposed to the direction of the last transaction,
	  which can cause update_call_counter to falsely decrease the wrong
	  counters. (please don't hurt me oej) (issue #8943 reported by
	  mdu113)

2007-02-21 14:06 +0000 [r55869]  Kevin P. Fleming <kpfleming@digium.com>

	* /, build_tools/make_version: Merged revisions 55868 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r55868 | kpfleming | 2007-02-21 08:03:11 -0600 (Wed, 21
	  Feb 2007) | 2 lines use new tag version script ........

2007-02-21 08:32 +0000 [r55834]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Issue #8848 - Turn off lamp more quickly
	  after transfer (decrement inuse early on transferer's call leg)

2007-02-21 02:01 +0000 [r55799]  Jason Parker <jparker@digium.com>

	* channels/chan_gtalk.c: Fix segfault when buddy couldn't be found.
	  Issue 7764, patch by sailer

2007-02-21 01:03 +0000 [r55751-55758]  Russell Bryant <russell@digium.com>

	* apps/app_meetme.c: Improve the reference counting to fix bugs
	  where people report seeing conferences listed that have no
	  members. (issue #9073)

	* /: Blocked revisions 55750 via svnmerge ........ r55750 | russell
	  | 2007-02-20 18:19:14 -0600 (Tue, 20 Feb 2007) | 9 lines Fix
	  random crashes when using the MeetMe application. This patch
	  converts list handling to use the linked list macros and most
	  importantly, implements reference counting on the ast_conference
	  objects. The reference counting was first backported from 1.4.
	  However, that code has some problems that caused the reference
	  count to never hit zero. Those problems are fixed in this patch
	  and will be resolved in 1.4 and trunk next, with a different
	  patch. (issues #7647, #9073, #9106, BE-115). ........

2007-02-21 00:11 +0000 [r55670-55741]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c: Better handle dropped IMAP connections.
	  (issue #9054 reported by bsmithurst)

	* channels/chan_sip.c: Return behavior I removed. I did not
	  remember that you could just add a localnet entry to make it
	  work.

	* channels/chan_sip.c: Don't test our own address against the
	  localnet settings. At least one person has had issues as a result
	  of this from #7051 so I'm reversing it. (issue #8821 reported by
	  kokoskarokoska)

	* /, channels/chan_agent.c: Merged revisions 55669 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r55669 | file | 2007-02-20 17:39:14 -0500 (Tue, 20 Feb
	  2007) | 2 lines Defer clearing callback information if channels
	  are up until they are hung up. This ensures the hangup process
	  goes smoothly and no channels get hung in limbo. (issue #8088
	  reported by kebl0155) ........

2007-02-20 20:26 +0000 [r55589-55634]  Russell Bryant <russell@digium.com>

	* main/http.c: Add the Asterisk version information to the Server
	  header in HTTP responses. (requested by Pari)

	* include/asterisk/manager.h: Increase the maximum number of
	  manager headers to 128, at the request of Pari.

	* /: Blocked revisions 55588 via svnmerge ........ r55588 | russell
	  | 2007-02-20 13:49:50 -0600 (Tue, 20 Feb 2007) | 3 lines Convert
	  a tab to spaces so that the documentation is printed out properly
	  aligned. ........

2007-02-20 16:53 +0000 [r55555]  Jason Parker <jparker@digium.com>

	* channels/chan_gtalk.c, res/res_jabber.c: No need to cast nor free
	  with strdupa (thanks file) 55555!

2007-02-20 16:41 +0000 [r55553]  Russell Bryant <russell@digium.com>

	* configs/sla.conf.sample: Change the formatting of sla.conf.sample
	  to make it more readable. (issue #9112, blitzrage)

2007-02-19 21:12 +0000 [r55483]  Olle Johansson <oej@edvina.net>

	* res/res_jabber.c: - Not sending arguments to an application is
	  not "out of memory" - Making error messages a bit more clear

2007-02-19 18:11 +0000 [r55435]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c, /: Merged revisions 55434 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r55434 | tilghman | 2007-02-19 12:09:09 -0600 (Mon, 19 Feb 2007)
	  | 2 lines forcename and forcegreetings options should check to
	  see if the recording already exists ........

2007-02-19 14:52 +0000 [r55397]  Doug Bailey <dbailey@digium.com>

	* channels/chan_iax2.c: Changed iax2 process thread to detached to
	  correct memory leak due to left over thread context on thread
	  exit. Modified module unload process to avoid deadlocks on
	  pthread cancels

2007-02-18 12:35 +0000 [r55250-55278]  Olle Johansson <oej@edvina.net>

	* /, apps/app_record.c: Merged revisions 55277 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r55277 | oej | 2007-02-18 13:32:13 +0100 (Sun, 18 Feb 2007) | 2
	  lines Documentation update (#9053, jsmith) ........

	* /: Block patch that was made only for 1.2 (already implemented in
	  1.4 and trunk)

2007-02-17 17:39 +0000 [r55219]  Joshua Colp <jcolp@digium.com>

	* apps/app_queue.c: Add missing membername option to AddQueueMember
	  documentation. (issue #9088 reported by seanbright)

2007-02-17 17:10 +0000 [r55217]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Fix an issue where callerid would not be
	  displayed on some phones. Issue 8995, initial patch and research
	  done by wedhorn

2007-02-17 03:55 +0000 [r55086-55154]  Joshua Colp <jcolp@digium.com>

	* apps/app_dial.c, /: Merged revisions 55153 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r55153 | file | 2007-02-16 22:53:45 -0500 (Fri, 16 Feb 2007) | 2
	  lines Answer the channel before recording privacy information.
	  (issue #8926 reported by lmamane) ........

	* apps/app_queue.c: Make the 'i' option of Queue actually work.
	  (issue #8986 reported by utis)

	* /, channels/chan_sip.c: Merged revisions 55073 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r55073 | file | 2007-02-16 20:09:50 -0500 (Fri, 16 Feb 2007) | 2
	  lines Allow chan_sip to handle attended transfers from a SIP
	  phone that is sitting behind chan_agent. Yes folks, all it took
	  was one line of code. (issue #8784 reported by pzieba) ........

2007-02-17 00:40 +0000 [r55006-55052]  Russell Bryant <russell@digium.com>

	* configure, include/asterisk/autoconfig.h.in, configure.ac: If the
	  pg_config application is found, but there is probably executing
	  it, then consider postgres unavailable. (issue #8637)

	* codecs/gsm/Makefile: Filter out yet another architecture that
	  does not work with the optimizations in the built-in libgsm.
	  (issue 8637, ovi)

	* /, apps/app_meetme.c, configs/meetme.conf.sample: Merged
	  revisions 55005 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r55005 | russell | 2007-02-16 16:48:22 -0600 (Fri, 16 Feb 2007) |
	  9 lines Revert the change I did in revisions 54955, 54969, and
	  54970, in 1.2, 1.4, and trunk. I decided that once a conference
	  is created from meetme.conf, it is acceptable behavior that the
	  pin can not be changed until the conference goes away. I also
	  added a note in meetme.conf to describe this behavior. We still
	  have another issue in 1.4 and trunk where some conferences with
	  no users don't go away. That is the real bug that needs to be
	  addressed here. ........

2007-02-16 22:18 +0000 [r55002]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_agent.c: Merged revisions 54999 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r54999 | file | 2007-02-16 17:13:45 -0500 (Fri, 16 Feb
	  2007) | 2 lines Do not send indications through ast_indicate in
	  chan_agent but instead go directly to the technology. This way
	  when indications are emulated they happen on the Agent channel
	  and do not screw up formats on the channels. (issue #8439
	  reported by punkgode) ........

2007-02-16 21:12 +0000 [r54969]  Russell Bryant <russell@digium.com>

	* /, apps/app_meetme.c: Merged revisions 54955 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r54955 | russell | 2007-02-16 14:56:58 -0600 (Fri, 16 Feb 2007) |
	  5 lines For conferences that are configured in meetme.conf, check
	  the configuration file every time someone joins the conference
	  instead of only when the conference is first created. This is to
	  ensure that changes to the pin numbers in the config file are
	  always honored. (issue #9073) ........

2007-02-16 18:51 +0000 [r54924]  Joshua Colp <jcolp@digium.com>

	* apps/app_dial.c: Need to check macro extension as well as macro
	  context for directed pickup.

2007-02-16 18:03 +0000 [r54888-54898]  Russell Bryant <russell@digium.com>

	* pbx/pbx_config.c: Fix setting "autofallthrough" to yes by
	  default. It was set to enabled in pbx.c. However, if the option
	  was not present in extensions.conf, then pbx_config.c would set
	  it back to disabled.

	* res/res_features.c: Clean up a few coding guidelines issues -
	  spaces to tabs, use sizeof() to pass the size of a static buffer,
	  add spaces ...

2007-02-16 17:25 +0000 [r54886]  Jason Parker <jparker@digium.com>

	* main/asterisk.c: Clarify a restart message. It's silly, but the
	  reporter had a very valid point. Issue 9079

2007-02-16 17:02 +0000 [r54884]  Joshua Colp <jcolp@digium.com>

	* apps/app_dial.c: Allow directed pickup to pick up the real
	  context instead of the macro context if a Macro is used. (issue
	  #8984 reported by jamesb63)

2007-02-16 12:06 +0000 [r54772-54787]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Issue #7541 - Handle multipart attachments
	  to SIP messages - even if boundary is quoted.

	* /, res/res_agi.c: Merged revisions 54771 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r54771 | oej | 2007-02-16 12:38:03 +0100 (Fri, 16 Feb 2007) | 2
	  lines Issue #9069 - If we open with TH we should not close with
	  /TD. (seanbright) ........

2007-02-16 00:48 +0000 [r54481-54714]  Joshua Colp <jcolp@digium.com>

	* apps/app_speech_utils.c: Don't let dtmf leak over into the engine
	  and let it skew the results... also give DTMF results priority.
	  (issue #9014 reported by surftek)

	* apps/app_dial.c, /: Merged revisions 54622 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r54622 | file | 2007-02-15 11:14:40 -0500 (Thu, 15 Feb 2007) | 2
	  lines Use a separate variable to indicate execution should
	  continue instead of the return value. (issue #8842 reported by
	  pluto70) ........

	* apps/app_dial.c: Forward begin DTMF frames as well as end. (issue
	  #9068 reported by mhardeman)

2007-02-14 18:44 +0000 [r54439]  Olle Johansson <oej@edvina.net>

	* /: Block patch only needed in 1.2

2007-02-14 16:56 +0000 [r54375]  Matt Frederickson <creslin@digium.com>

	* channels/chan_zap.c, /: Merged revisions 54373 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r54373 | mattf | 2007-02-14 10:25:49 -0600 (Wed, 14 Feb 2007) | 2
	  lines When handling glare on a PRI, move the requested channel
	  rather than hang up the old one. Fix for 8957 and 9011. ........

2007-02-14 01:09 +0000 [r54290]  Joshua Colp <jcolp@digium.com>

	* main/channel.c: Add G722 to ast_best_codec. If anyone disagrees
	  with it's placement, feel free to change it. (issue #9045
	  reported by gork)

2007-02-13 21:31 +0000 [r54204-54235]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Remove a couple of leftover debug messages

	* include/asterisk/devicestate.h: Fix the documentation on the
	  return values from device state provider registration and
	  deletion.

	* channels/chan_sip.c: If we fail to create the SIP socket, then
	  return -1 from reload_config() so that load_module() will return
	  AST_MODULE_LOAD_DECLINE. Otherwise, the console will just get
	  spammed with error messages every time chan_sip tries to send a
	  message.

2007-02-13 18:41 +0000 [r54180]  Olle Johansson <oej@edvina.net>

	* /: Blocking patch for 1.2 only

2007-02-12 19:17 +0000 [r54066-54103]  Russell Bryant <russell@digium.com>

	* main/dial.c, include/asterisk/dial.h: Change
	  ast_set_state_callback() to ast_dial_set_state_callback()

	* main/dial.c, apps/app_meetme.c, apps/app_page.c,
	  include/asterisk/dial.h: - Add the ability to register a callback
	  to monitor state changes in an asynchronous dial operation. -
	  Rename the various references to "status" to "state" in the dial
	  API

2007-02-12 16:34 +0000 [r54026]  Joshua Colp <jcolp@digium.com>

	* configure, configure.ac: Make the --without-oss argument work.
	  (issue #9026 reported by puzzled)

2007-02-12 15:38 +0000 [r54002]  Russell Bryant <russell@digium.com>

	* configs/users.conf.sample: Fix a typo where "vmpassword" should
	  be "vmsecret"

2007-02-10 09:09 +0000 [r53878-53881]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/chan_h323.c: Fix VLDTMF reception

	* apps/app_echo.c: Much simpler than previous one ;-)

	* main/channel.c: Provide correct DTMF duration

	* main/cli.c: Bring deprecated 'debug channel <x|all>' command back

2007-02-10 06:06 +0000 [r53850]  Kevin P. Fleming <kpfleming@digium.com>

	* configure, configure.ac, acinclude.m4: don't display the
	  --with-imap message unless --with-imap was specified without a
	  path use '-n' instead of '! -z' for tests

2007-02-10 01:02 +0000 [r53783-53821]  Russell Bryant <russell@digium.com>

	* apps/app_meetme.c: Add some output for "show application
	  SLAStation/SLATrunk"

	* channels/chan_sip.c: Change some text to properly state "On
	  Hold", which was already done in trunk.

	* configs/sla.conf.sample, include/asterisk/app.h,
	  include/asterisk/utils.h, main/dial.c, apps/app_meetme.c,
	  channels/chan_sip.c, doc/sla.txt (added),
	  include/asterisk/linkedlists.h, include/asterisk/dial.h: Merge
	  team/russell/sla_rewrite This is a completely new implementation
	  of the SLA functionality introduced in Asterisk 1.4. It is now
	  functional and ready for testing. However, I will be adding some
	  additional features over the next week, as well. For information
	  on how to set this up, see configs/sla.conf.sample and
	  doc/sla.txt. In addition to the changes in app_meetme.c for the
	  SLA implementation itself, this merge brings in various other
	  changes: chan_sip: - Add the ability to indicate HOLD state in
	  NOTIFY messages. - Queue HOLD and UNHOLD control frames even if
	  the channel is not bridged to another channel. linkedlists.h: -
	  Add support for rwlock based linked lists. dial.c: - Add the
	  ability to run ast_dial_start() without a reference channel to
	  inherit information from.

	* apps/app_echo.c: When the Echo() application receives the digit
	  '#', echo that back as well. Since we already sent the BEGIN
	  frame for that digit, it makes sense to send the END as well.

2007-02-09 23:52 +0000 [r53779-53781]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_gtalk.c: another dependency

	* apps/app_adsiprog.c, apps/app_voicemail.c, res/res_config_odbc.c,
	  funcs/func_odbc.c, res/res_adsi.c: add some inter-module
	  dependencies

	* build_tools/get_moduleinfo, build_tools/get_makeopts: fix awk
	  scripts to work when both MODULEINFO and MAKEOPTS are present in
	  a source file

2007-02-09 19:33 +0000 [r53749]  Joshua Colp <jcolp@digium.com>

	* apps/app_dial.c: Temporarily change musicclass on channel to one
	  specified in Dial so that the 'm' option functions properly.
	  (issue #8969 reported by christianbee)

2007-02-09 16:42 +0000 [r53715]  Kevin P. Fleming <kpfleming@digium.com>

	* doc/imapstorage.txt, configure, configure.ac: clarify the fact
	  that voicemail IMAP storage cannot be built against a distro's
	  binary c-client library package (at least not at this time)

2007-02-08 23:18 +0000 [r53672]  Olle Johansson <oej@edvina.net>

	* main/acl.c: Don't output debug unless we asked for it

2007-02-08 17:54 +0000 [r53601]  Joshua Colp <jcolp@digium.com>

	* apps/app_speech_utils.c: Fix timeout issue when utterance is
	  longer then timeout itself.

2007-02-08 13:47 +0000 [r53530-53532]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/loader.c: Issue 9007 - Mutex not released on early return

	* apps/app_voicemail.c, /: Merged revisions 53529 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53529 | tilghman | 2007-02-08 07:36:10 -0600 (Thu, 08 Feb 2007)
	  | 2 lines Issue 9003 - If fullname is empty, quote() passes back
	  "\"" ........

2007-02-07 23:52 +0000 [r53464-53497]  Russell Bryant <russell@digium.com>

	* main/db1-ast/Makefile: When building libdb1.a, put the additional
	  flags needed at the beginning of ASTCFLAGS, instead of at the
	  end. This way, we ensure that we find the local headers first
	  before accidentally trying to use headers that exist in locations
	  specified in the ASTCFLAGS passed from the main Makefile. (issue
	  #8637, ovi)

	* main/Makefile: The clean target actually needs to run "distclean"
	  on editline. This is because we need to make sure that its
	  configure script gets executed again, because the CFLAGS we want
	  to pass to editline may have changed.

2007-02-07 17:53 +0000 [r53434]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: We can not reliably do P2P bridging with DTMF passing
	  back with compensation if we need to listen for DTMF frames.
	  (issue #8962 reported by caio1982)

2007-02-07 17:39 +0000 [r53429]  Russell Bryant <russell@digium.com>

	* main/rtp.c: When parsing the NTP timestamp in a sender report
	  message, you are supposed to take the low 16 bits of the integer
	  part, and the high 16 bits of the fractional part. However, the
	  code here was erroneously taking the low 16 bits of the
	  fractional part. It then shifted the result 16 bits down, so the
	  result was always zero. This fix makes it grab the appropriate
	  high 16 bits, instead. (issue #8991, pointed out by
	  andre_abrantes)

2007-02-07 17:04 +0000 [r53358-53399]  Joshua Colp <jcolp@digium.com>

	* apps/app_playback.c: Directly load say.conf in load_module
	  instead of calling the reload function. (issue #8946 reported by
	  junky)

	* /, channels/chan_iax2.c: Merged revisions 53357 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53357 | file | 2007-02-07 10:38:48 -0500 (Wed, 07 Feb 2007) | 2
	  lines Fix a few potential memory leaks with realtime users and
	  peers. (issue #8999 reported by bsmithurst) ........

2007-02-07 15:33 +0000 [r53355]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, apps/app_macro.c: Merged revisions 53354 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53354 | tilghman | 2007-02-07 09:30:02 -0600 (Wed, 07 Feb 2007)
	  | 2 lines Issue 7440 - Macro called from Macro from the h
	  extension exits prematurely ........

2007-02-07 09:22 +0000 [r53324]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/chan_misdn.c, /: Merged
	  revisions 52843 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r52843 | crichter | 2007-01-30 15:38:08 +0100 (Di, 30 Jan 2007) |
	  1 line fixed some possible segfaults. also fixed an very
	  important bug which occurs on high load (when calls are very fast
	  generated) ........

2007-02-07 05:24 +0000 [r53246-53294]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* res/res_jabber.c: Text fix for jabber reload command (reported by
	  bkruse via IRC)

	* main/manager.c, /: Merged revisions 53245 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53245 | tilghman | 2007-02-06 00:58:28 -0600 (Tue, 06 Feb 2007)
	  | 2 lines Issue 8987 - Status could return two responses
	  (mnicholson) ........

2007-02-05 23:43 +0000 [r53222]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Formatting

2007-02-05 17:06 +0000 [r53150-53152]  Joshua Colp <jcolp@digium.com>

	* apps/app_playback.c: Ensure say_cfg is NULL when the module is
	  loaded. (issue #8946 reported by junky)

	* apps/app_playback.c: Unregister Playback CLI commands as well as
	  dialplan application. (issue #8946 reported by junky)

2007-02-05 00:18 +0000 [r53143]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Add some comments on queue system behaviour
	  and how it affects the SIP channel

2007-02-03 21:05 +0000 [r53138]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Make SIPDtmfMode application work with
	  recent capability changes, and also fix an RTP stack issue when
	  the auto option was used. (issue #8972 reported by mdu113)

2007-02-03 20:44 +0000 [r53135-53136]  Russell Bryant <russell@digium.com>

	* apps/app_dial.c, /: Merged revisions 53133 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53133 | russell | 2007-02-03 14:38:13 -0600 (Sat, 03 Feb 2007) |
	  4 lines set the DIALSTATUS variable to contain "INVALIDARGS" when
	  the dial application exits early because of invalid arguments
	  instead of just leaving it empty. (issue #8975) ........

	* /: Blocked revisions 53134 via svnmerge ........ r53134 | russell
	  | 2007-02-03 14:39:45 -0600 (Sat, 03 Feb 2007) | 2 lines Revert
	  some changes that accidentally got committed as a part of another
	  fix. ........

2007-02-03 10:02 +0000 [r53131]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/ast_h323.cxx: Remove quote from H.323 vendor string
	  because due to compatibilities with CS1000 reported at
	  www.voip-info.org

2007-02-02 21:26 +0000 [r53129]  BJ Weschke <bweschke@btwtech.com>

	* UPGRADE.txt, apps/app_queue.c: I'm baaaaaaaaaack. :) Post a
	  warning to the console that things might possibly be
	  misconfigured when queue member's states are still 'Not in Use'
	  when we're about to bridge them with a caller from queue. Also,
	  put some documentation quoted from oej's queues.txt efforts
	  started in /trunk today. This commit puts #7433 into feedback
	  state for 1.4, and pending no further negative feedback, it will
	  finally be closed.

2007-02-02 17:15 +0000 [r53114-53120]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Correct a copy/pasted error message line for RTCP.

	* main/config.c, /: Merged revisions 53117 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53117 | file | 2007-02-02 10:58:09 -0600 (Fri, 02 Feb 2007) | 2
	  lines Pass the glob expanded filename to process_text_line so
	  that error messages contain the actual filename, not the original
	  include one. (issue #8959 reported by tzafrir) ........

	* Makefile: Add systemname to asterisk.conf generation per recent
	  discussions about it. (issue #8968 reported by blitzrage)

2007-02-02 00:24 +0000 [r53109]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c, configs/sip.conf.sample: Disable the direct
	  p2p RTP call setup in SIP. You can enable it in sip.conf, but it
	  is now considered experimental until we solve the
	  AST_CONTROL_ANSWER with payload and videocaps stuff.

2007-02-01 23:16 +0000 [r53108]  Jason Parker <jparker@digium.com>

	* /: Blocked revisions 53107 via svnmerge ........ r53107 | qwell |
	  2007-02-01 17:14:09 -0600 (Thu, 01 Feb 2007) | 2 lines Fix a
	  small typo. Synopsis lines shouldn't have a newline ........

2007-02-01 22:24 +0000 [r53097-53104]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 53103 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53103 | file | 2007-02-01 16:21:56 -0600 (Thu, 01 Feb 2007) | 2
	  lines Copy noncodeccapability over to the joint variable so that
	  telephone-event will get transmitted in the sent INVITE. ........

	* main/db1-ast/hash/hash.c: Huh... fix the berkeley DB to compile
	  here as well, but it apparently required both dev mode and no
	  optimizations to creep up.

	* /, channels/chan_sip.c: Merged revisions 53095 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53095 | file | 2007-02-01 15:47:11 -0600 (Thu, 01 Feb 2007) | 2
	  lines Don't negotiate RFC2833 when not configured to do so.
	  (issue #8799 reported by mdu113) ........

2007-02-01 21:24 +0000 [r53093]  Russell Bryant <russell@digium.com>

	* funcs/func_strings.c: Fix the FIELDQTY function to not crash.
	  (reported by blitzrage and Corydon on IRC)

2007-02-01 21:15 +0000 [r53091]  Olle Johansson <oej@edvina.net>

	* /: Going backwards, blame file.

2007-02-01 21:11 +0000 [r53086-53088]  Joshua Colp <jcolp@digium.com>

	* /, res/res_musiconhold.c: Merged revisions 53084 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r53084 | file | 2007-02-01 15:03:10 -0600 (Thu, 01 Feb
	  2007) | 2 lines Return previous behavior of having MOH pick up
	  where it was left off. (issue #8672 reported by sinistermidget)
	  ........

	* funcs/func_strings.c: Make func_strings build under dev mode.
	  Didn't I do this today already in the berkeley DB?

2007-02-01 21:05 +0000 [r53079-53085]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: - Clean INC_COUNT flag when we decrement
	  call counter - If it's still set at time of dialog destruction,
	  make sure we decrement the device call counter properly before we
	  destroy the dialog

	* apps/app_queue.c: Change debug level for state change message
	  that is not really informative when debugging app_queue

	* channels/chan_sip.c: Cleaning up the devicestate callback
	  function

2007-02-01 20:13 +0000 [r53075-53077]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* funcs/func_strings.c: Oops.

	* /, funcs/func_strings.c: Merged revisions 53074 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53074 | tilghman | 2007-02-01 14:07:35 -0600 (Thu, 01 Feb 2007)
	  | 2 lines Bug 8965 ........

2007-02-01 19:33 +0000 [r53072]  Joshua Colp <jcolp@digium.com>

	* main/asterisk.c: Add missing 'F' letter to getopt so it magically
	  becomes a valid option. (issue #8960 reported by tzafrir)

2007-02-01 19:21 +0000 [r53070]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/pbx.c, /, funcs/func_strings.c: Merged revisions 53069 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53069 | tilghman | 2007-02-01 13:13:53 -0600 (Thu, 01 Feb 2007)
	  | 2 lines No wonder FIELDQTY doesn't work with functions... the
	  documentation in pbx.c was wrong ........

2007-02-01 17:37 +0000 [r53064]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Fix silly logic. We really want to write
	  UDPTL frames out when the call is up.

2007-02-01 16:35 +0000 [r53062]  Olle Johansson <oej@edvina.net>

	* configs/sip.conf.sample: Add explanation of port= in combination
	  with defaultip= (thanks jsmith)

2007-02-01 13:17 +0000 [r53060]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c: we update the name on any first reply of
	  our setup

2007-02-01 11:07 +0000 [r53057]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/chan_h323.c: chan_h323 is very stable, so let it built
	  by default

2007-02-01 00:24 +0000 [r53050-53052]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: When going on hold have the side that was put on hold
	  reinvite back to Asterisk. When going off hold have the side that
	  was taken off hold reinvited back to the other party.

	* main/rtp.c: Add more frame types to forward in the RTP bridge
	  loops.

2007-01-31 21:32 +0000 [r52859-53046]  Russell Bryant <russell@digium.com>

	* main/cdr.c, main/manager.c, pbx/pbx_spool.c,
	  channels/chan_skinny.c, channels/chan_h323.c, main/http.c,
	  pbx/pbx_dundi.c, apps/app_rpt.c, channels/chan_mgcp.c,
	  main/pbx.c, channels/chan_zap.c, /, apps/app_meetme.c,
	  channels/chan_sip.c, apps/app_queue.c, channels/chan_iax2.c:
	  Merged revisions 53045 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53045 | russell | 2007-01-31 15:25:11 -0600 (Wed, 31 Jan 2007) |
	  3 lines Fix a bunch of places where pthread_attr_init() was
	  called, but pthread_attr_destroy() was not. ........

	* apps/app_userevent.c: Remove an extra \r\n from manager user
	  events. (issue #8955, mnicholson)

	* main/rtp.c, /: Merged revisions 53039 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r53039 | russell | 2007-01-31 11:41:51 -0600 (Wed, 31 Jan 2007) |
	  3 lines Use the proper format string to print unsigned values in
	  the rtp debug output. (issue #8954, wmis) ........

	* apps/app_queue.c: Only changed the paused status in an existing
	  queue member if the paused column exists.

	* apps/app_queue.c: Instead of always creating a realtime queue
	  member as unpaused, read the "paused" column and use that value
	  for the paused status of the member. (issue #8949, jmls)

	* contrib/init.d/rc.suse.asterisk: Update init script for SuSE 10.
	  (issue #8363, johnlange)

	* doc/cdrdriver.txt: Add documentation for using cdr_pgsql. (issue
	  #8942, lters)

	* configure, include/asterisk/autoconfig.h.in, configure.ac,
	  codecs/codec_gsm.c: When we are checking for a system installed
	  version of libgsm, we need to check for gsm.h as well.
	  Furthermore, when checking for this header, it may be located in
	  a gsm/ sub directory, so check for that, as well. (issue #8773)

	* /: Blocked revisions 52954 via svnmerge ........ r52954 | russell
	  | 2007-01-30 13:41:52 -0600 (Tue, 30 Jan 2007) | 4 lines Don't
	  print a message indicating that we don't know what to do with a
	  proceeding control frame in ast_request_and_dial(). We just need
	  to ignore it. (reported by JerJer on #asterisk-dev) ........

	* channels/chan_sip.c: Only set the DTMF flag on the rtp structure
	  if the DTMF mode is actually RFC2833, not just that it is not
	  INFO. This makes it get set for inband DTMF as well, which is not
	  valid. (issue #8936)

	* main/asterisk.c, /: Merged revisions 52903 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r52903 | russell | 2007-01-30 11:12:04 -0600 (Tue, 30 Jan 2007) |
	  9 lines The SIGHUP handler was implemented to allow admins to
	  send SIGHUP to a running Asterisk process to reload the
	  configuration. However, doing the actual reload in the signal
	  handler itself is a very bad thing to do, because the reload
	  process includes calling non-reentrant functions such as
	  malloc/calloc/etc. If Asterisk is running in the background, then
	  the reload will happen immediately. However, if running in
	  console mode, the reload doesn't work until something is typed at
	  the console. That sort of defeats the purpose, but I don't see an
	  easy way to get around it at this point. ........

	* /: Blocked revisions 52857 via svnmerge ........ r52857 | russell
	  | 2007-01-30 09:35:23 -0600 (Tue, 30 Jan 2007) | 5 lines Comment
	  out the parts in the Makefile that make codec_zap get built. It
	  will not yet build against zaptel 1.2, so I am disabling it to
	  prevent further bug reports until it gets merged. (issue #8940)
	  ........

2007-01-30 15:29 +0000 [r52856]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: Drop the deprecated show commands since the
	  original ones were changed back. (issue #8937 reported by
	  PCadach)

2007-01-30 08:46 +0000 [r52807-52809]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/chan_h323.c: Revert reprecation of h.323 gk cycle
	  command from pre-1.4 version instead of duplicated h323 cycle gk

	* res/res_odbc.c: Don't play with free()'d pointers

	* configure, acinclude.m4: Handle non-standard OpenH323/PWLib
	  library names

2007-01-30 00:15 +0000 [r52763]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 52762 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r52762 | russell | 2007-01-29 18:15:06 -0600 (Mon, 29 Jan 2007) |
	  5 lines Fix the extraction of the timestamp from video frames. It
	  was using the mapping for a mini-frame instead of a video-frame,
	  which caused it to get invalid data. (issue #8795, mihai)
	  ........

2007-01-29 23:43 +0000 [r52717]  Joshua Colp <jcolp@digium.com>

	* apps/app_mixmonitor.c, /: Merged revisions 52716 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r52716 | file | 2007-01-29 18:39:39 -0500 (Mon, 29 Jan
	  2007) | 2 lines Now that filename is part of the structure and
	  since it comes before postprocess... we have to add it to our
	  postprocess line. (reported on asterisk-dev by Boris Bakchiev)
	  ........

2007-01-29 22:58 +0000 [r52688-52695]  Russell Bryant <russell@digium.com>

	* main/Makefile: Add a missing quotation mark. This was pointed out
	  by jcmoore on #asterisk-dev.

	* main/manager.c: Remove a recursive lock of the manager session.
	  This was pointed out by zandbelt in issue #8711.

2007-01-29 22:12 +0000 [r52679]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* pbx/pbx_config.c: Argument number correction

2007-01-29 21:36 +0000 [r52611-52647]  Russell Bryant <russell@digium.com>

	* main/Makefile: ASTLDFLAGS needs to be passed to the editline
	  configure script as LDFLAGS. (issue #8928, zandbelt)

	* main/rtp.c: Fix a problem with packet-to-packet bridging and DTMF
	  mode translation. P2P bridging can only be used when the DTMF
	  modes don't match if the core is monitoring DTMF in both
	  directions. Then, the core will handle the translation.
	  Otherwise, this bridging method can not be used. (issue #8936)

	* main/manager.c: The session lock can not be held while calling
	  action callbacks. If so, then when the WaitEvent callback gets
	  called, then no event can happen because the session can't be
	  locked by another thread. Also, the session needs to be locked in
	  the HTTP callback when it reads out the output string. This fixes
	  the deadlock reported in both 8711 and 8934. Regarding issue
	  8711, there still may be an issue. If there is a second action
	  requested before the processing of the first action is finished,
	  there could still be some corruption of the output string buffer
	  used to build the result. (issue #8711, #8934)

2007-01-29 18:59 +0000 [r52572]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c: Use ast_calloc instead of malloc.

2007-01-29 17:57 +0000 [r52535]  Steve Murphy <murf@digium.com>

	* apps/app_voicemail.c, main/say.c: this is for 8778 (pt_BR
	  backport to 1.4). It was committed to trunk via 7663. But it
	  wasn't so much an enhancement as a fix for the bad language
	  output for portuguese in Brazil, so, after a lot of prodding from
	  patient Brazilians, here is the same fix for 1.4

2007-01-29 17:33 +0000 [r52523]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c: Set quota information to 0 when creating a
	  vm_state. (issue #8924 reported by neutrino88)

2007-01-29 16:54 +0000 [r52506]  Russell Bryant <russell@digium.com>

	* main/jitterbuf.c, include/jitterbuf.h: Clean up a few things in
	  the last commit to the adaptive jitterbuffer code. - Specifically
	  indicate to the compiler that the "dropem" variable only needs
	  one but. - Change formatting to conform to coding guidelines.

2007-01-29 04:18 +0000 [r52494]  Jim Dixon <telesistant@hotmail.com>

	* main/jitterbuf.c, include/jitterbuf.h: Fixed problem with
	  jitterbuf, whereas it would not complain about, and would allow
	  itself to be overfilled (per the max_jitterbuf parameter). Now it
	  rejects any data over and above that size, and complains about
	  it.

2007-01-28 05:15 +0000 [r52462]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* configure, configure.ac: Suggested change to fix normal usage of
	  --with-tds=/usr/local (Sean Bright, via asterisk-dev mailing
	  list)

2007-01-27 02:13 +0000 [r52335-52416]  Joshua Colp <jcolp@digium.com>

	* /, apps/app_queue.c: Merged revisions 52415 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r52415 | file | 2007-01-26 21:09:10 -0500 (Fri, 26 Jan 2007) | 2
	  lines Make COMPLETECALLER and COMPLETEAGENT output to queue_log
	  follow documentation. (issue #7677 reported by amilcar) ........

	* main/manager.c: Have the manager interface send back an "Already
	  logged in" message instead of "Invalid/Unknown Command" when the
	  client authenticates for a second time. (issue #8509 reported by
	  pari)

	* /, channels/chan_iax2.c: Merged revisions 52360 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r52360 | file | 2007-01-26 19:03:23 -0500 (Fri, 26 Jan 2007) | 2
	  lines Make the last context entry read in the dominant one.
	  (issue #8918 reported by pj) ........

	* main/file.c: Fix core show file formats CLI command.

2007-01-25 19:18 +0000 [r52163-52265]  Joshua Colp <jcolp@digium.com>

	* /, main/jitterbuf.c: Merged revisions 52264 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r52264 | file | 2007-01-25 14:15:29 -0500 (Thu, 25 Jan 2007) | 2
	  lines Allow dequeueing of frames with negative timestamp by
	  moving jitterbuffer frames check to jb_next. (issue #8546
	  reported by harmen) ........

	* channels/chan_sip.c: Drop out variables I accidentally put in.

	* channels/chan_sip.c: Decrement onHold count if we are hung up on
	  and still on hold. (issue #8909 reported by alexh42)

	* apps/app_mixmonitor.c, /: Merged revisions 52162 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r52162 | file | 2007-01-24 20:48:52 -0500 (Wed, 24 Jan
	  2007) | 2 lines Add another note about audio files being played
	  back to each bridged party. (issue #8718 reported by ppyy)
	  ........

2007-01-25 01:37 +0000 [r52107-52160]  Russell Bryant <russell@digium.com>

	* apps/app_voicemail.c, configs/users.conf.sample: By suggestion
	  from kpfleming last week, change "vmpassword" to "vmsecret".

	* configure, configure.ac: Remove libnsl as a required lib for
	  libiksemel to work. This change was already made in the trunk.
	  (issue #8762)

	* /: Blocked revisions 52137 via svnmerge ........ r52137 | russell
	  | 2007-01-24 18:39:50 -0600 (Wed, 24 Jan 2007) | 3 lines Fix a
	  seg fault when running this application with no arguments from
	  AGI. (issue #8905, junky) ........

	* include/asterisk/dial.h: Fix the formatting of doxygen comments
	  to properly indicate that the comment documents the previous
	  entity, as opposed to the next one.

2007-01-24 18:26 +0000 [r52052]  Steve Murphy <murf@digium.com>

	* utils/check_expr.c, utils/Makefile, /: Merged revisions 52002 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r52002 | murf | 2007-01-24 10:43:50 -0700 (Wed, 24 Jan 2007) | 1
	  line updated check_expr via 8322 (refactoring of expression
	  checking impl); elfring contributed a nice code reorg, I
	  contributed some time to get it working again, better messages
	  ........

2007-01-24 18:20 +0000 [r52016-52049]  Joshua Colp <jcolp@digium.com>

	* main/dial.c (added), apps/app_page.c, main/Makefile,
	  include/asterisk/dial.h (added): Merge in dialing API and the
	  app_page that uses it. (issue #BE-118)

	* channels/chan_sip.c: Fix changing channel formats when joint
	  capability changes and there are no audio formats... I didn't
	  break it originally! (issue #8535 reported by ivoc)

2007-01-24 17:14 +0000 [r52000]  Russell Bryant <russell@digium.com>

	* configure: rebuild configure script to reflect last chan_h323
	  related changes.

2007-01-24 12:57 +0000 [r51979-51989]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c: added fix from #8899

	* channels/chan_misdn.c, /: Merged revisions 51966 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r51966 | crichter | 2007-01-24 11:48:09 +0100 (Mi, 24
	  Jan 2007) | 1 line fixed the busy problem (dialstatus was not
	  busy when we called a busy extension) ........

2007-01-24 09:30 +0000 [r51931]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Show capabilities *and* preference in
	  general settings in "sip show settings" (reported by Clona/Telio
	  - Thanks!)

2007-01-24 08:04 +0000 [r51895]  Paul Cadach <paul@odt.east.telecom.kz>

	* acinclude.m4: Allow x64 builds of H.323 (please, rebuild
	  configure)

2007-01-24 00:59 +0000 [r51829-51848]  Russell Bryant <russell@digium.com>

	* main/channel.c, /: Merged revisions 51843 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r51843 | russell | 2007-01-23 18:57:28 -0600 (Tue, 23 Jan 2007) |
	  6 lines Fix an issue related to synchronization of recordings
	  when using Monitor(). The bug is a miscalculation of the amount
	  to seek the stream for writing to disk when the number of samples
	  coming in and out of a channel do not match up. (issue #8298,
	  #8887, report and patch by guillecabeza, patch files created and
	  testing done by whoiswes) ........

	* apps/app_while.c, /: Merged revisions 51828 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r51828 | russell | 2007-01-23 18:17:50 -0600 (Tue, 23 Jan 2007) |
	  4 lines Don't set a new value for the END_ variable on the
	  channel before using the old value. If you do, it will lead to
	  accessing a memory address that has been free()'d. (issue #8895,
	  arkadia) ........

2007-01-23 22:46 +0000 [r51788]  Joshua Colp <jcolp@digium.com>

	* channels/chan_oss.c, channels/chan_phone.c, channels/chan_zap.c,
	  channels/chan_sip.c, channels/chan_skinny.c,
	  channels/chan_features.c, channels/chan_alsa.c,
	  channels/chan_gtalk.c, channels/chan_iax2.c: Update channel
	  drivers to use module referencing so that unloading them while in
	  use will not result in crashes. (issue #8897 reported by junky)

2007-01-23 22:04 +0000 [r51750-51781]  Russell Bryant <russell@digium.com>

	* main/manager.c: Fix some bugs in process_message(). The manager
	  session lock needs to be held when sending some sort of response,
	  or calling one of the manager action callbacks. This resolves an
	  issue where people using the GUI would get random crashes when
	  they start clicking around a lot. (issue #8711, reported and
	  debugged by zandbelt)

	* main/http.c: Fix setting the default port of 8088 on 64-bit or
	  big-endian machines.

	* main/manager.c: When traversing the list of manager actions, the
	  iterator needs to be initialized to the list head *after* locking
	  the list. Also, lock the actions list in one place it is being
	  accessed where it was not being done.

2007-01-23 20:32 +0000 [r51683-51716]  Steve Murphy <murf@digium.com>

	* res/res_features.c: this mod from 8593 (dstchannel in cdr is
	  empty when transfer call).

	* main/callerid.c: via 8748 (callerid.c loses name when returning
	  PRIVATE_NUMBER flag), the user suggested this mod, saying it
	  would allow 'WITHHELD' to appear in the name field, which would
	  be useful

2007-01-23 10:28 +0000 [r51648-51649]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/chan_misdn.c, /,
	  channels/misdn/isdn_msg_parser.c: Merged revisions 50495,50506
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r50495 | crichter | 2007-01-11 14:27:52 +0100 (Do, 11 Jan 2007) |
	  6 lines * more additions to make the RESTART message work * added
	  fix for misdn_call to allow SETUPs with empty extensions,
	  replaced the strtok_r functions with strsep for that (inspired by
	  Sandro Cappellazzo, thanks) ........ r50506 | crichter |
	  2007-01-11 15:45:38 +0100 (Do, 11 Jan 2007) | 1 line when we get
	  L2 UP, the L1 is UP definitely too, so we set the L1 state up as
	  well. ........

	* channels/misdn/isdn_lib.c, channels/misdn/isdn_lib.h,
	  channels/chan_misdn.c: manually merged r49922 and r50335, because
	  of conflicts. this commint includes addition of the ISDN RESTART
	  Message

2007-01-23 06:51 +0000 [r51615]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/chan_h323.c, channels/Makefile: Do not abort Asterisk
	  startup if h323 configuration file not found (reported by
	  mithraen)

2007-01-23 03:00 +0000 [r51513-51558]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Only change audio formats on the channel if
	  we have an audio format to change to. (issue #8535 reported by
	  ivoc)

	* /, res/res_musiconhold.c: Merged revisions 51512 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r51512 | file | 2007-01-22 20:41:35 -0500 (Mon, 22 Jan
	  2007) | 2 lines Yield before reading from zaptel timing source
	  under Solaris so that other threads get a chance to do things.
	  (issue #7875 reported by bob) ........

2007-01-22 19:41 +0000 [r51411]  Russell Bryant <russell@digium.com>

	* /: Blocked revisions 51410 via svnmerge ........ r51410 | russell
	  | 2007-01-22 13:39:30 -0600 (Mon, 22 Jan 2007) | 3 lines Merge
	  codec_zap support for the transcoder card. This is a standalone
	  codec module so it will not affect anything else. ........

2007-01-22 19:28 +0000 [r51409]  Steve Murphy <murf@digium.com>

	* pbx/pbx_ael.c: This fixes 8836, according to dnatural

2007-01-22 19:13 +0000 [r51360-51407]  Joshua Colp <jcolp@digium.com>

	* apps/app_mixmonitor.c, /: Merged revisions 51406 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r51406 | file | 2007-01-22 14:08:52 -0500 (Mon, 22 Jan
	  2007) | 2 lines Move filestream creation to Mixmonitor loop. This
	  will prevent a blank file from being created if no frames ever
	  pass through to be recorded. (issue #7589 reported by
	  steve_mcneil) ........

	* /: Blocked revisions 51359 via svnmerge ........ r51359 | file |
	  2007-01-22 11:23:03 -0500 (Mon, 22 Jan 2007) | 2 lines Explicitly
	  declare what codecs are supported by default globally since using
	  a bitmask for all may include ones we don't need. (issue #8357
	  reported by gknispel_proformatique) ........

2007-01-20 06:53 +0000 [r51348-51350]  Jason Parker <jparker@digium.com>

	* configs/say.conf.sample: Fix Italian numeral support in say.conf
	  for "_[2-9]00" case. "2131" would've translated to something
	  along the lines of (pardon my..Italian {or lack thereof})
	  "duecentocentotrentuno", which makes no sense at all.

	* configs/say.conf.sample: Fix German language support in say.conf
	  Properly support 21, 31, 41, 51, 61, 71, 81, and 91.
	  einundzwanzig has the same format as zweiundzwanzig (as do all
	  other "_ZX" spoken numerals) Fix support for numbers in the
	  10,000,000 to 99,999,999 range. Add support for numbers in the
	  100,000,000 to 999,999,999 range.

2007-01-20 00:13 +0000 [r51302-51343]  Russell Bryant <russell@digium.com>

	* apps/app_meetme.c: Remove an unused instance of an unnamed enum.

	* apps/app_meetme.c: Remove another duplicated definition

	* apps/app_meetme.c: Remove a variable that was declared twice.

	* codecs/gsm/Makefile: Add a couple more processors that need
	  optimizations excluded. (issue #8637)

	* channels/chan_gtalk.c: Fix VLDTMF support in chan_gtalk.
	  AST_FRAME_DTMF and AST_FRAME_DTMF_END are actually the same
	  thing. So, a digit would have been interpreted incorrectly here.
	  Since the channel driver will always have the begin and end
	  callbacks called for a digit, only support the button-down and
	  button-up messages.

	* .cleancount: Bump the cleancount since my last commit changed the
	  channel structure.

	* channels/chan_oss.c, main/rtp.c, main/channel.c,
	  channels/chan_phone.c, channels/chan_misdn.c,
	  channels/chan_skinny.c, channels/chan_features.c,
	  channels/chan_h323.c, channels/chan_alsa.c, channels/chan_mgcp.c,
	  channels/chan_zap.c, channels/chan_local.c, main/frame.c,
	  channels/chan_sip.c, channels/chan_agent.c,
	  include/asterisk/channel.h, channels/chan_gtalk.c,
	  channels/chan_iax2.c: Merge the changes from the
	  /team/group/vldtmf_fixup branch. The main bug being addressed
	  here is a problem introduced when two SIP channels using SIP INFO
	  dtmf have their media directly bridged. So, when a DTMF END frame
	  comes into Asterisk from an incoming INFO message, Asterisk would
	  try to emulate a digit of some length by first sending a DTMF
	  BEGIN frame and sending a DTMF END later timed off of incoming
	  audio. However, since there was no audio coming in, the DTMF_END
	  was never generated. This caused DTMF based features to no longer
	  work. To fix this, the core now knows when a channel doesn't care
	  about DTMF BEGIN frames (such as a SIP channel sending INFO
	  dtmf). If this is the case, then Asterisk will not emulate a
	  digit of some length, and will instead just pass through the
	  single DTMF END event. Channel drivers also now get passed the
	  length of the digit to their digit_end callback. This improves
	  SIP INFO support even further by enabling us to put the real
	  digit duration in the INFO message instead of a hard coded 250ms.
	  Also, for an incoming INFO message, the duration is read from the
	  frame and passed into the core instead of just getting ignored.
	  (issue #8597, maybe others...)

	* main/asterisk.c: Merged revisions 51300 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r51300 | russell | 2007-01-19 10:44:09 -0600 (Fri, 19 Jan 2007) |
	  4 lines Fix a memory leak on command line tab completion. The
	  container for the matches was freed, but the individual matches
	  themselves were not. (issue #8851, arkadia) ........

2007-01-19 00:17 +0000 [r51272-51274]  Dwayne M. Hubbard <dhubbard@digium.com>

	* channels/chan_zap.c: chan_zap compiles without libpri after
	  committing 7877 patch

	* channels/chan_zap.c, /: Merged revisions 51271 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r51271 | dhubbard | 2007-01-18 17:47:10 -0600 (Thu, 18 Jan 2007)
	  | 3 lines issue 7877: chan_zap module reload does not use
	  default/initialized values on subsequent loads. Reset
	  configuration variables to default values prior to parsing
	  configuration file. ........

2007-01-18 23:36 +0000 [r51270]  Kevin P. Fleming <kpfleming@digium.com>

	* /: block this patch since it is already here

2007-01-18 22:50 +0000 [r51265]  Jason Parker <jparker@digium.com>

	* apps/app_voicemail.c, main/channel.c, main/pbx.c,
	  funcs/func_strings.c, main/app.c: Add some more checks for
	  option_debug before ast_log(LOG_DEBUG, ...) calls. Issue 8832,
	  patch(es) by tgrman

2007-01-18 21:54 +0000 [r51262]  Russell Bryant <russell@digium.com>

	* Makefile, configure, main/Makefile, acinclude.m4, makeopts.in:
	  Ensure that the locations given to the Asterisk configure script
	  for ncurses, curses, termcap, or tinfo are further passed along
	  to the editline configure script. This fixes some
	  cross-compilation environments. (issue #8637, reported by ovi,
	  patch by me)

2007-01-18 21:14 +0000 [r51256]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, main/stdtime/localtime.c: Merged revisions 51255 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r51255 | tilghman | 2007-01-18 15:11:34 -0600 (Thu, 18
	  Jan 2007) | 2 lines If a timezone is not specified, assume
	  localtime (instead of gmtime) (Issue #7748) ........

2007-01-18 19:17 +0000 [r51251]  Joshua Colp <jcolp@digium.com>

	* apps/app_speech_utils.c: Only start timeout once we reach the end
	  of the files to play back.

2007-01-18 18:42 +0000 [r51245]  Jason Parker <jparker@digium.com>

	* main/cli.c: Fix an issue with file name completion in "module
	  load" and "load". Issue 8846

2007-01-18 18:36 +0000 [r51243]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Copy MOH settings when calling a peer so
	  that if they put someone on hold or get put on hold themselves
	  they get the right music class. (issue #8840 reported by mdu113)

2007-01-18 18:28 +0000 [r51241]  Jason Parker <jparker@digium.com>

	* main/channel.c: Fix an issue with deprecated commands

2007-01-18 17:49 +0000 [r51236]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* contrib/scripts/vmdb.sql, /: Merged revisions 51235 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r51235 | tilghman | 2007-01-18 11:42:17 -0600 (Thu, 18
	  Jan 2007) | 2 lines Document all the fields, including the
	  indication that "uniqueid" should not be renamed. ........

2007-01-18 17:18 +0000 [r51233]  Russell Bryant <russell@digium.com>

	* main/manager.c: Make the "hasmanager" option in users.conf
	  actually have an effect. (issue #8740, LnxPrgr3)

2007-01-18 00:48 +0000 [r51211-51213]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c: Build the IMAP remote directory string
	  better and properly. Fix an issue with encoding the GSM voicemail
	  when attaching to the voicemail. (issue #8808 reported by
	  akohlsmith)

	* main/rtp.c: Pass data as well for hold/unhold/vidupdate frames.
	  (issue #8840 reported by mdu113)

2007-01-17 23:31 +0000 [r51198-51205]  Russell Bryant <russell@digium.com>

	* funcs/func_odbc.c: Fix some instances where when loading
	  func_odbc, a double-free could occur. Also, remove an unneeded
	  error message. If the failure condition is actually a memory
	  allocation failure, a log message will already be generated
	  automatically.

	* channels/chan_zap.c: Instead of dividing the offset by 2
	  directly, make it more clear that the offset is being scaled by
	  the size of the elements in the buffer. (Inspired by a discussing
	  on the asterisk-dev list about this code)

	* /, channels/chan_sip.c: Merged revisions 51197 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r51197 | russell | 2007-01-17 15:17:21 -0600 (Wed, 17 Jan 2007) |
	  3 lines Move the check for a failure of ast_channel_alloc() to
	  before locking the pvt structure again. Otherwise, on a failure,
	  this will cause a deadlock. ........

2007-01-17 20:56 +0000 [r51195]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, main/utils.c: Merged revisions 51194 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r51194 | tilghman | 2007-01-17 14:52:21 -0600 (Wed, 17 Jan 2007)
	  | 4 lines When ast_strip_quoted was called with a zero-length
	  string, it would treat a NULL as if it were the quoting character
	  (and would thus return the string in memory immediately following
	  the passed-in string). ........

2007-01-17 17:36 +0000 [r51186]  Jason Parker <jparker@digium.com>

	* apps/app_voicemail.c: re-add "password" for realtime voicemail

2007-01-17 06:36 +0000 [r51182]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Return the correct result when directly writing out a
	  packet so that the core doesn't then decide to handle it the
	  regular way again. (issue #8833 reported by rcourtna)

2007-01-17 01:29 +0000 [r51176]  Kevin P. Fleming <kpfleming@digium.com>

	* apps/app_voicemail.c: a few more coding style cleanups and one
	  bug fix (from AnthonyL)

2007-01-17 00:46 +0000 [r51172]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: Move rescheduling of lagrq/pings into the
	  scheduler callback.

2007-01-17 00:20 +0000 [r51165-51170]  Jason Parker <jparker@digium.com>

	* main/rtp.c: Fix issue with dtmf continuation packets when the
	  dtmf digit is 0... Issue 8831

	* apps/app_voicemail.c, contrib/scripts/vmdb.sql: Fix an issue with
	  IMAP storage and realtime voicemail. Also update the vmdb sql
	  script for IMAP specific options. Issue 8819, initial patches by
	  bsmithurst (slightly modified by me)

	* doc/voicemail_odbc_postgresql.txt: change documentation to
	  reflect new procedure in 1.4/trunk

2007-01-16 21:51 +0000 [r51159-51162]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, doc/voicemail_odbc_postgresql.txt (added): Merged revisions
	  51161 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r51161 | tilghman | 2007-01-16 15:50:04 -0600 (Tue, 16 Jan 2007)
	  | 2 lines Add documentation walkthrough on getting Postgres to
	  work with voicemail (from Issue 8513) ........

	* apps/app_voicemail.c, /: Merged revisions 51158 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r51158 | tilghman | 2007-01-16 15:26:06 -0600 (Tue, 16 Jan 2007)
	  | 2 lines Postgres driver doesn't like a NULL pointer when
	  retrieving the length (Bug 8513) ........

2007-01-16 17:46 +0000 [r51150]  Matt O'Gorman <mogorman@digium.com>

	* apps/app_voicemail.c: minor things i missed before i get jumped
	  on

2007-01-16 17:39 +0000 [r51148]  Joshua Colp <jcolp@digium.com>

	* /, res/res_features.c: Merged revisions 51145 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r51145 | file | 2007-01-16 12:36:50 -0500 (Tue, 16 Jan 2007) | 2
	  lines Return previous behavior. ParkedCalls will be able to do
	  DTMF based transfers again. trunk however will get an option to
	  allow this to be set on/off. (issue #8804 reported by nortex)
	  ........

2007-01-16 17:36 +0000 [r51146]  Jason Parker <jparker@digium.com>

	* main/file.c: Display more useful output when streaming files.
	  Include the channel name to which the file is being played. Issue
	  8828, patch by junky.

2007-01-16 05:55 +0000 [r51087]  Joshua Colp <jcolp@digium.com>

	* channels/chan_zap.c, /: Merged revisions 51085 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r51085 | file | 2007-01-16 00:53:31 -0500 (Tue, 16 Jan 2007) | 2
	  lines Add none as a valid callgroup/pickupgroup option. I
	  consider it a bug that it would inherit it all the way down and
	  not have any way to reset it to nothing - so that's why it is in
	  1.2. (issue #8296 reported by gkloepfer) ........

2007-01-16 01:15 +0000 [r51057]  Russell Bryant <russell@digium.com>

	* main/config.c: It is possible for the config pointer to be NULL
	  here, so it needs to be checked before dereferencing it.

2007-01-16 00:22 +0000 [r51030]  Matt O'Gorman <mogorman@digium.com>

	* apps/app_voicemail.c, configs/users.conf.sample: Patch allows for
	  changing voicemail password in users.conf from voicemail main,
	  written by AnthonyL bug #8436

2007-01-15 23:49 +0000 [r50994]  Russell Bryant <russell@digium.com>

	* Makefile.rules: Filter out a few CFLAGS that are not valid
	  CXXFLAGS.

2007-01-15 23:10 +0000 [r50988]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /: Blocked revisions 50987 via svnmerge ........ r50987 |
	  tilghman | 2007-01-15 17:09:02 -0600 (Mon, 15 Jan 2007) | 2 lines
	  Check return value before dereferencing (Bug 8822) ........

2007-01-15 21:08 +0000 [r50957]  Matt O'Gorman <mogorman@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 50946 via svnmerge from
	  https://svn.digium.com/svn/asterisk/branches/1.2 ........ r50946
	  | mogorman | 2007-01-15 14:44:53 -0600 (Mon, 15 Jan 2007) | 4
	  lines Solves issue with forwarding voicemails from folders other
	  than inbox. patch by anthonyl. ........

2007-01-15 18:23 +0000 [r50921]  Jason Parker <jparker@digium.com>

	* main/asterisk.c: re-add deprecated "show version" CLI command.

2007-01-15 16:36 +0000 [r50895]  Joshua Colp <jcolp@digium.com>

	* main/manager.c: Move event processing into do_message so that it
	  gets executed again when events are tripped.

2007-01-15 15:03 +0000 [r50867]  Kevin P. Fleming <kpfleming@digium.com>

	* configure, include/asterisk/autoconfig.h.in, main/Makefile,
	  configure.ac, Makefile.rules, acinclude.m4, makeopts.in: use the
	  ACX_PTHREAD macro from the Autoconf macro archive for setting up
	  compiler pthreads support... should improve portability to
	  platforms with unusual pthreads requirements

2007-01-14 21:59 +0000 [r50820]  Joshua Colp <jcolp@digium.com>

	* main/astmm.c: Add missing newlines for two memory CLI commands.

2007-01-14 05:13 +0000 [r50782]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/db1-ast/db/db.c, main/db1-ast/recno/rec_get.c,
	  main/db1-ast/btree/bt_seq.c, main/db1-ast/hash/hash_func.c,
	  main/db1-ast/btree/bt_utils.c, main/db1-ast/recno/rec_seq.c,
	  main/db1-ast/btree/bt_overflow.c, main/db1-ast/btree/bt_search.c,
	  main/db1-ast/btree/bt_conv.c, main/db1-ast/btree/bt_close.c,
	  main/db1-ast/btree/bt_put.c, main/db1-ast/recno/rec_utils.c,
	  main/db1-ast/recno/rec_open.c, main/db1-ast/hash/hash_bigkey.c,
	  main/db1-ast/recno/rec_delete.c, main/db1-ast/hash/hash_buf.c,
	  main/db1-ast/hash/hash_page.c, main/db1-ast/recno/rec_close.c,
	  main/db1-ast/recno/rec_put.c, main/db1-ast/include/ndbm.h,
	  main/db1-ast/btree/bt_debug.c, main/db1-ast/mpool/mpool.c,
	  main/db1-ast/btree/bt_split.c, main/db1-ast/btree/bt_open.c,
	  main/db1-ast/btree/bt_delete.c, main/db1-ast/hash/hash_log2.c,
	  main/db1-ast/hash/hsearch.c, /, main/db1-ast/btree/bt_page.c,
	  main/db1-ast/recno/rec_search.c, main/db1-ast/btree/bt_get.c,
	  main/db1-ast/hash/hash.c: Merged revisions 50781 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r50781 | tilghman | 2007-01-13 23:01:16 -0600 (Sat, 13
	  Jan 2007) | 2 lines Bug 8814 - db should look for its header
	  using a relative path, instead of the system path (Fixes FreeWRT)
	  ........

2007-01-13 16:45 +0000 [r50754]  Kevin P. Fleming <kpfleming@digium.com>

	* Makefile, build_tools/make_sample_voicemail (added): when
	  building the sample greetings for maibox 1234@default during
	  'make samples', build a greeting for each language and file
	  format the user selected to install with menuselect (reported by
	  Brian Capouch on asterisk-dev)

2007-01-13 06:00 +0000 [r50674-50727]  Joshua Colp <jcolp@digium.com>

	* main/channel.c: Only write a frame out to the channel if one
	  exists. There are cases where one may not and would therefore
	  cause the channel driver to segfault. (issue #8434 reported by
	  slimey)

	* res/res_snmp.c: Only join the snmp thread on an unload if the
	  thread is actually running. (issue #8810 reported by junky)

2007-01-12 19:24 +0000 [r50647]  Jason Parker <jparker@digium.com>

	* configs/voicemail.conf.sample: Update documentation to state that
	  you shouldn't use realtime static with voicemail.conf

2007-01-12 16:42 +0000 [r50602]  Joshua Colp <jcolp@digium.com>

	* main/manager.c: We need to check for res being 0 in do_message
	  itself, otherwise our headers will get lost.

2007-01-12 14:42 +0000 [r50562]  Kevin P. Fleming <kpfleming@digium.com>

	* main/pbx.c, /: Merged revisions 50561 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r50561 | kpfleming | 2007-01-12 08:34:15 -0600 (Fri, 12 Jan 2007)
	  | 2 lines minor documentation clarification ........

2007-01-11 05:53 +0000 [r50377-50468]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Remove check for channel state as it can
	  definitely be something other then ring, and also clean up the
	  code a bit. This should solve the parking issues and maybe some
	  attended transfer issues people have been seeing.

	* main/rtp.c, channels/chan_sip.c, include/asterisk/rtp.h: Add
	  support to see whether NAT was detected (yay symmetric RTP) and
	  also add a check in chan_sip so that if NAT has been detected and
	  the reinvite behind nat option has been turned off, then just do
	  partial bridge. (issue #8655 reported by mnicholson)

	* apps/app_speech_utils.c: Merge speech-multi branch which adds
	  support for joining multiple sound files together to be played
	  one after another in SpeechBackground.

	* main/config.c: Fix parsing when using something like ldap
	  settings. (done by anthonyl)

	* channels/chan_sip.c: Fix chan_sip not working issue. Let's not
	  prematurely return 0. (issue #8783 reported by st41ker)

2007-01-10 16:45 +0000 [r50346]  Jason Parker <jparker@digium.com>

	* cdr/cdr_manager.c: Reverse some logic in cdr_manager, which made
	  it fail to load if the config file existed. Issue 8777

2007-01-10 04:55 +0000 [r50266-50298]  Joshua Colp <jcolp@digium.com>

	* apps/app_dial.c, /: Merged revisions 50295 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r50295 | file | 2007-01-09 23:51:06 -0500 (Tue, 09 Jan 2007) | 2
	  lines Add another return value to dial_exec_full that indicates
	  execution is going to continuing at a new
	  extension/context/priority and to just let it slide. (issue #8598
	  reported by jon) ........

	* main/pbx.c: Ensure data's existence before trying to access it.
	  (issue #8774 reported by rcourtna)

2007-01-10 02:17 +0000 [r50228]  Russell Bryant <russell@digium.com>

	* Makefile, /: Merged revisions 50227 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r50227 | russell | 2007-01-09 21:16:45 -0500 (Tue, 09 Jan 2007) |
	  6 lines Make the number that represents the major version number
	  a single digit instead of 2. Using two digits makes it an octal
	  number when put into version.h, which breaks the compilation of
	  any out of tree module that checks the version for any version
	  after 1.2.7 (reported by Matteo Brancaleoni on the asterisk-dev
	  mailing list, who gave credit to vihai for pointing it out)
	  ........

2007-01-09 17:11 +0000 [r50186]  Jason Parker <jparker@digium.com>

	* main/cli.c: Re-add CLI command that should have only been
	  deprecated in 1.4. Thanks kshumard! (reported in person, so no
	  associated issue #)

2007-01-09 13:40 +0000 [r50151]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c, /: Merged revisions 50150 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r50150 | tilghman | 2007-01-09 07:30:04 -0600 (Tue, 09 Jan 2007)
	  | 4 lines The advent of realtime has enabled people to use commas
	  in the fullname field. This could cause an issue with sending
	  voicemails, when the field is unquoted. (Issue 8595) ........

2007-01-09 11:25 +0000 [r50124]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: - handle re-invites properly in sip_hangup()
	  - Add some invitestate status changes just to be sure

2007-01-08 23:39 +0000 [r50098]  Jason Parker <jparker@digium.com>

	* apps/app_voicemail.c: Fix an issue with voicemail and users.conf,
	  where it wouldn't ever parse a password, since it was using
	  "secret" instead of "password" Issue 8761, reported by and patch
	  suggestion from ssokol.

2007-01-08 21:11 +0000 [r50073]  Matt O'Gorman <mogorman@digium.com>

	* apps/app_senddtmf.c: we can't unlock a channel if we cant find
	  it. - AnthonyL bug #8741

2007-01-08 18:21 +0000 [r50032]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Disable the more intense packet2packet bridging until
	  the bugs can be worked out.

2007-01-08 14:26 +0000 [r49925-50006]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Issue #8677 - Handle failure of T.38
	  re-invite This is not a fix, but adding an error message to tell
	  the admin that we have a bad configuration. We should not send
	  T.38 re-invites to devices that can't handle it (with the current
	  architecture where you have to hard-code t.38 support per
	  device). To really fix this, we need to figure out a way to tell
	  the incoming call that the re-invite failed, so we can signal
	  failure on that end and go back to the original call.

	* channels/chan_sip.c: Issue #8524, support multiple via header
	  values (tardieu) Thanks!

	* channels/chan_sip.c: We only need one forward declaration

	* channels/chan_sip.c: Issue 8735: Terminate state when extension
	  is unavailable for subscription

2007-01-08 05:11 +0000 [r49890]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 49889 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r49889 | file | 2007-01-08 00:10:07 -0500 (Mon, 08 Jan 2007) | 2
	  lines Ensure we use the default refresh value of 60 if the remote
	  server does not send one. (issue #8746 reported by maethor)
	  ........

2007-01-08 03:53 +0000 [r49866]  Kevin P. Fleming <kpfleming@digium.com>

	* configure, configure.ac: since we use AC_PATH_TOOL to find tools,
	  we should use the results it provides for us (reported by Brian
	  Capouch on the asterisk-dev list)

2007-01-07 21:44 +0000 [r49831-49834]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, apps/app_dictate.c: Merged revisions 49833 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r49833 | tilghman | 2007-01-07 15:43:10 -0600 (Sun, 07 Jan 2007)
	  | 2 lines If openstream fails, then we crash (Issue 8564)
	  ........

	* channels/chan_sip.c: Second condition was a subset of the first,
	  so hold was never decremented, thus hint stayed stuck (Issue
	  8747)

2007-01-06 00:24 +0000 [r49742]  Jason Parker <jparker@digium.com>

	* main/pbx.c, res/res_features.c, pbx/pbx_config.c: Save 1 whopping
	  byte of allocated memory! This looks like it may have been a
	  chicken/egg scenario.. You had to call a cleanup func, because
	  everything was allocated. Then since you had to call a cleanup
	  func, you were forced to allocate - ie; strdup("").

2007-01-05 23:51 +0000 [r49710-49715]  Kevin P. Fleming <kpfleming@digium.com>

	* configure, acinclude.m4: one more time...

	* configure, acinclude.m4: proper fix for r49712

	* configure, acinclude.m4: if --with-foo=<path> is specific for a
	  configure option, ensure that it is used for header file checking
	  as well

	* main/manager.c: ast_func_read() needs a writable copy of the
	  function name to be passed

2007-01-05 23:16 +0000 [r49705]  Jason Parker <jparker@digium.com>

	* channels/chan_zap.c, codecs/codec_zap.c: Make codec_zap and
	  chan_zap also depend on zaptel. This fixes an issue (8727) with
	  zaptel being in a different directory, using --with-zaptel.

2007-01-05 22:52 +0000 [r49676-49680]  Kevin P. Fleming <kpfleming@digium.com>

	* main/manager.c: don't 'consume' the params list before we try to
	  use it again

	* res/res_monitor.c, main/config.c, apps/app_setcdruserfield.c,
	  main/manager.c, include/asterisk/jabber.h, apps/app_senddtmf.c,
	  main/db.c, channels/chan_zap.c, channels/chan_sip.c,
	  apps/app_meetme.c, res/res_features.c, channels/chan_agent.c,
	  utils/astman.c, include/asterisk/manager.h, channels/chan_iax2.c,
	  apps/app_queue.c, res/res_jabber.c: reduce stack consumption for
	  AMI and AMI/HTTP requests by nearly 20K in most cases

2007-01-05 22:14 +0000 [r49675]  Joshua Colp <jcolp@digium.com>

	* main/channel.c: Don't keep repeating the warning over and over
	  when the end of the call is reached. (issue #8724 reported by
	  xrg)

2007-01-05 17:09 +0000 [r49581-49636]  Kevin P. Fleming <kpfleming@digium.com>

	* /, channels/chan_sip.c, channels/chan_skinny.c,
	  channels/chan_iax2.c: Merged revisions 49635 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r49635 | kpfleming | 2007-01-05 10:56:40 -0600 (Fri, 05 Jan 2007)
	  | 2 lines ensure that threads which are supposed to be detached
	  (because we aren't going to wait on them) are created properly
	  ........

	* channels/chan_iax2.c: revert the dynamic_list insertion change...
	  that was not the right thing to do

	* channels/chan_iax2.c: create the IAX2 processing threads as
	  background threads so they will use smaller stacks when we create
	  a dynamic thread, put it on the dynamic_list right away so we
	  don't lose track of it

2007-01-04 23:00 +0000 [r49568]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: It's possible for the iax2 pvt to
	  disappear, so if it has... don't bother looking for dpentries.

2007-01-04 22:51 +0000 [r49553]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/threadstorage.h, main/asterisk.c,
	  build_tools/cflags.xml, include/asterisk.h, main/Makefile,
	  main/threadstorage.c (added), main/utils.c: add support for
	  tracking thread-local-storage objects that exist via
	  'threadstorage' CLI commands

2007-01-04 22:28 +0000 [r49551]  Joshua Colp <jcolp@digium.com>

	* main/config.c: Only free comments and line buffer once we reach
	  the first level. (issue #8678 reported by ssokol, fixed by
	  anthonyl)

2007-01-04 21:58 +0000 [r49460-49536]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/iax2-parser.c, main/frame.c: don't mark these
	  allocations as 'cache' allocations when caching has been disabled

	* channels/iax2-parser.c: if we're going to decrement the frame
	  count when we free a frame, we should inrement it when we create
	  one :-)

	* channels/iax2-parser.c, channels/iax2-parser.h,
	  channels/chan_iax2.c: only do IAX2 frame caching for voice and
	  video frames

	* main/frame.c: don't do frame header caching in the core if
	  LOW_MEMORY is defined

	* channels/iax2-parser.c: don't define this type either if
	  LOW_MEMORY is enabled

2007-01-04 18:11 +0000 [r49459]  Matt O'Gorman <mogorman@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 49447 via svnmerge from
	  https://svn.digium.com/svn/asterisk/branches/1.2 ........ r49447
	  | mogorman | 2007-01-04 11:45:16 -0600 (Thu, 04 Jan 2007) | 2
	  lines converted a lot of 256 to PATH_MAX and some white space
	  fixes. ........

2007-01-04 18:06 +0000 [r49457-49458]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/iax2-parser.c: don't do frame caching in LOW_MEMORY mode

	* codecs/Makefile: make building of codec_gsm against the system
	  GSM library actually work

2007-01-04 16:50 +0000 [r49413]  Matt O'Gorman <mogorman@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 49412 via svnmerge from
	  https://svn.digium.com/svn/asterisk/branches/1.2 ........ r49412
	  | mogorman | 2007-01-04 10:48:43 -0600 (Thu, 04 Jan 2007) | 3
	  lines good catch russell sorry i missed that. fix magic number
	  with proper sizeof ........

2007-01-04 04:33 +0000 [r49388]  Russell Bryant <russell@digium.com>

	* funcs/func_realtime.c: Fix the REALTIME() dialplan function.
	  ast_build_string() advances the string pointer to the position to
	  begin the next write into the buffer. So, this pointer can not be
	  used to copy the contents of the string later. The beginning of
	  the buffer must be saved. Interestingly enough, this code could
	  not have ever worked. (Pointed out by Sebb on IRC, thanks!)

2007-01-03 23:32 +0000 [r49355]  Matt O'Gorman <mogorman@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 49354 via svnmerge from
	  https://svn.digium.com/svn/asterisk/branches/1.2 ........ r49354
	  | mogorman | 2007-01-03 17:22:47 -0600 (Wed, 03 Jan 2007) | 6
	  lines When using ODBC_STORAGE VoicemailMain doesn't create the
	  subdirectories for a mailbox such as the INBOX directory. this
	  patch solves that problem, was written by anthony be-125 ........

2007-01-03 09:06 +0000 [r49313]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/misdn_config.c,
	  doc/misdn.txt, channels/misdn/isdn_lib.h, channels/chan_misdn.c,
	  /, channels/misdn/ie.c, channels/misdn/isdn_msg_parser.c,
	  configs/misdn.conf.sample: Merged revisions
	  48319,48321,48467,48552,48576,49135,49303 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48319 | crichter | 2006-12-06 15:35:25 +0100 (Mi, 06 Dez 2006) |
	  1 line changed a few debugs to higher debug levels ........
	  r48321 | crichter | 2006-12-06 16:48:45 +0100 (Mi, 06 Dez 2006) |
	  1 line added the export and import of the MISDN_ADDRESS_COMPLETE
	  Variable to inidcate wether the extension is already completely
	  dialed or if there might come additional digits by information
	  elements. also added some docs for that. ........ r48467 |
	  crichter | 2006-12-14 14:03:49 +0100 (Do, 14 Dez 2006) | 1 line
	  removed FIXUP state. added check for channel allocation conflict
	  when we create a setup while the other site creates a setup on
	  the same channel, besides the check we resolve this conflict.
	  ........ r48552 | crichter | 2006-12-18 11:19:39 +0100 (Mo, 18
	  Dez 2006) | 1 line when our PTP Partner sends us a SETUP with a
	  preselected channel we just accept it, even when we're NT. added
	  some checks for segfaults. ........ r48576 | crichter |
	  2006-12-19 14:08:51 +0100 (Di, 19 Dez 2006) | 1 line when we
	  reject a channel, because it's in use already, we shouldn't
	  process the setup anymore. made the channel allocation a bit
	  easier and more understandable, removed a few unused lines
	  ........ r49135 | crichter | 2007-01-02 11:07:22 +0100 (Di, 02
	  Jan 2007) | 1 line added check for channel ranges in the
	  set/empty channel functions. set pmp_l1_check default to no.
	  added misdn restart pid cli command. added cleaning of channel
	  when we send a RELEASE_COMPLETE. ........ r49303 | crichter |
	  2007-01-03 09:24:00 +0100 (Mi, 03 Jan 2007) | 9 lines * Added
	  check for bridging in misdn_call to avoid setting
	  echocancellation when 2 mISDN channels are involved and when
	  bridging is set. That lead to a kernel panic before under
	  different situations, because we switched about 2 times between
	  hardware bridging and echocancelation * readded MISDN_URATE
	  variable which got lost before, this should make app_v110 work
	  again * fixed typo ........

2007-01-03 03:21 +0000 [r49282]  Kevin P. Fleming <kpfleming@digium.com>

	* Makefile, Makefile.rules: various Makefile improvements to get
	  chan_vpb (and any other C++ modules) to build properly

2007-01-03 01:19 +0000 [r49259]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: Check pvt structure presence before passing
	  to send_command. This gets rid of the irritating message about a
	  packet without pvt structure. This happens because the scheduled
	  item is getting cancelled at almost the exact moment it is
	  getting executed.

2007-01-02 22:30 +0000 [r49237]  Steve Murphy <murf@digium.com>

	* main/ast_expr2.fl, main/ast_expr2f.c, pbx/ael/ael_lex.c,
	  pbx/ael/ael.flex: This is a slight modification to Josh's edits
	  for #8579; both files edited were the produced by flex; so the
	  source files need to be changed instead, and the generated files
	  regenerated.

2007-01-02 19:58 +0000 [r49212]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Small cleanup of add_t38sdp - it's always
	  enabled at that point in the code

2007-01-02 17:33 +0000 [r49189]  Jason Parker <jparker@digium.com>

	* main/pbx.c: Allow fractions of a second in the Wait()
	  application, like it says it allows.

2007-01-02 13:59 +0000 [r49165]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_zap.c: remove comment that is unrelated to this
	  function

2007-01-02 12:08 +0000 [r49145]  Olle Johansson <oej@edvina.net>

	* configs/features.conf.sample: Adding note on effect of
	  applicationmap features on re-invites

2007-01-01 23:34 +0000 [r49098-49102]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_zap.c, build_tools/menuselect-deps.in, configure,
	  configure.ac, codecs/codec_zap.c: check specifically for VLDTMF
	  and transcoding support in the system's Zaptel installation, and
	  make only the modules that need those features dependent on them
	  (this will allow building the other Zaptel-using parts of
	  Asterisk against older versions of Zaptel or those on other
	  platforms that haven't caught up yet to the Linux version)

	* Makefile: use a simpler (and portable) method to ensure that
	  menuselect is built as a host binary

	* Makefile: revert this change until a better solution can be
	  found... 'env -i' was not being used properly, but even when
	  changed to do so, this process fails during cross-compilation
	  because the menuselect build still sees 'CC' as set to the
	  cross-compiler

2007-01-01 20:14 +0000 [r49096]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: remove incomplete implementation of dnsmgr.
	  Let's fix this in trunk.

2006-12-30 18:31 +0000 [r49063-49073]  Joshua Colp <jcolp@digium.com>

	* pbx/pbx_config.c: IAX has been deprecated for quite some time so
	  we had better use IAX2 when creating the dial string for users.
	  (issue #8697 reported by ssokol)

	* channels/chan_zap.c: Use asprintf to build the channel names
	  instead of custom function. I believe the custom function is
	  doing some things that are not portable across all
	  implementations. (issue #8570 reported by hterag & issue #8692
	  reported by nicolasg)

	* main/rtp.c: If the Packet2Packet bridge is being broken because
	  of a masquerade then attempt to read a frame in so the masquerade
	  actually happens. Otherwise weirdness will occur. (issue #8696
	  reported by kjotte)

	* channels/chan_iax2.c: Initialize the packet queue in load_module
	  instead of just declaring the list with the default value. (issue
	  #8695 reported by ssokol)

2006-12-30 00:40 +0000 [r49061]  Steve Murphy <murf@digium.com>

	* pbx/pbx_ael.c: A fix for 8661, where the CUT func needed to have
	  comma args converted to vertical bars. I hope this change does
	  little harm.

2006-12-29 00:50 +0000 [r49042-49048]  Kevin P. Fleming <kpfleming@digium.com>

	* /: put this value into the correct property

	* /, BUGS: Merged revisions 49045 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r49045 | kpfleming | 2006-12-28 18:32:32 -0600 (Thu, 28 Dec 2006)
	  | 2 lines location of the bug posting guidelines has changed
	  ........

	* sample.call: simple commit to test CIA integration

2006-12-28 21:26 +0000 [r49032-49035]  Jason Parker <jparker@digium.com>

	* main/cli.c: Fix some deprecated commands. Issue 8682, patch by me

	* main/http.c: saw this in passing... fix a small typo

2006-12-28 20:08 +0000 [r49028]  Kevin P. Fleming <kpfleming@digium.com>

	* sounds/Makefile: new versions of sounds

2006-12-28 19:52 +0000 [r49024]  Jason Parker <jparker@digium.com>

	* main/http.c: make the uris_lock a rwlock instead of a mutex lock
	  - needs to be forward ported to trunk

2006-12-28 19:43 +0000 [r49022]  Joshua Colp <jcolp@digium.com>

	* configure, include/asterisk/autoconfig.h.in, configure.ac,
	  include/asterisk/lock.h: Backport support for read/write locks.

2006-12-28 19:21 +0000 [r49020]  Steve Murphy <murf@digium.com>

	* main/ast_expr2.fl, main/ast_expr2.c, main/frame.c,
	  pbx/ael/ael.tab.c, main/ast_expr2.y, main/ast_expr2f.c,
	  pbx/ael/ael_lex.c, include/asterisk/ael_structs.h,
	  pbx/ael/ael.tab.h, utils/ael_main.c: removed <err.h> as in trunk
	  from the ael stuff. Also, threw in a minor fix to frame.c to
	  avoid build-killing compiler warnings.

2006-12-27 22:28 +0000 [r49009]  Joshua Colp <jcolp@digium.com>

	* main/ast_expr2f.c, pbx/ael/ael_lex.c: ast_copy_string is not
	  available when LOW_MEMORY is used and things are being built in
	  the utils directory, so we need to resort to the old method of
	  strncpy. (issue #8579 reported by mottano)

2006-12-27 22:06 +0000 [r48998-49006]  Kevin P. Fleming <kpfleming@digium.com>

	* main/enum.c, main/asterisk.c, main/rtp.c, main/term.c,
	  main/cdr.c, main/channel.c, main/udptl.c, main/pbx.c,
	  main/dnsmgr.c, main/frame.c, main/manager.c, main/file.c,
	  main/http.c, main/logger.c: since these variables all have static
	  duration, none of them need initializers (they default to zero
	  anyway)

	* include/asterisk/options.h, main/asterisk.c, main/file.c: move
	  extern declaration for this option to a header file where it
	  belongs provide an initial value for 'languageprefix' option,
	  instead of relying on randomness to provide a useful value

2006-12-27 21:06 +0000 [r48993-48997]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Only include acl.h and lock.h once

	* channels/chan_sip.c: Only set rfc2833compensate flag once
	  (handle_common_options)

	* channels/chan_sip.c: - Remove checking for T38 options twice.
	  Keeping them in handle_common_options

2006-12-27 18:33 +0000 [r48987-48988]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_sip.c: make the option actually match the
	  documentation

	* channels/iax2-parser.c, include/asterisk/utils.h,
	  include/asterisk/astmm.h, main/frame.c, main/astmm.c: allow 'show
	  memory' and 'show memory summary' to distinguish memory
	  allocations that were done for caching purposes, so they don't
	  look like memory leaks

2006-12-27 17:59 +0000 [r48975-48985]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c, configs/sip.conf.sample: Be a bit more
	  politically correct

	* channels/chan_sip.c, configs/sip.conf.sample: Issue #8575 - Buggy
	  cisco MWI support. Normally we try not to change our software for
	  bugs in other devices. But in this case, the Cisco phones are so
	  widespread so we try to implement a fix while waiting for a
	  bugfix from Cisco.

	* channels/chan_sip.c: - Make sure handle_common_options return 1
	  when we found a common option - Move uncommon (only global)
	  option away from handle_common_options Reported by rizzo. Thanks!

	* channels/chan_sip.c: Issue 8599 (rizzo) Change invitestate before
	  re-sending invite with auth.

	* /, channels/chan_sip.c: Fix bogus content-length in t38 sdp.
	  (rizzo, #8600)

2006-12-26 05:20 +0000 [r48960-48966]  Joshua Colp <jcolp@digium.com>

	* apps/app_meetme.c: Get rid of a needless memory allocation and
	  only create a conference structure in find_conf_realtime if data
	  was read from realtime. (issue #8669 reported by robl)

	* main/rtp.c, channels/chan_sip.c, include/asterisk/rtp.h: Add an
	  API call that initializes an RTP structure. We need this because
	  chan_sip is cheeky and uses a temporary RTP structure for codec
	  purposes, and the API calls that are used rely on the lock.
	  (Pointed out on asterisk-dev by Andy Wang)

	* configure, configure.ac: Clean up autoconf file (gets rid of
	  warnings seen when rebuilding configure) and rebuild configure.

2006-12-25 05:21 +0000 [r48931-48956]  Russell Bryant <russell@digium.com>

	* /, funcs/func_math.c: Merged revisions 48955 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48955 | russell | 2006-12-25 00:19:48 -0500 (Mon, 25 Dec 2006) |
	  6 lines Fix an error introduced by copying and pasting the
	  handling of the >= operator for the MATH function. If a single
	  equal sign was used as an operator, the function would treat it
	  is as if it were the >= operator. Now, it properly handles it as
	  an invalid operator. (issue #8665, patch by tempest1) ........

	* channels/chan_oss.c: Fix a typo in an error message that
	  indicated that the MGCP channel type could not be registered,
	  instead of the correct type, OSS.

	* /, channels/chan_iax2.c: Merged revisions 48943 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48943 | russell | 2006-12-24 02:23:07 -0500 (Sun, 24 Dec 2006) |
	  3 lines Check for the proper return value on an error in a call
	  to mmap(). This was reported by Andy Wang on the asterisk-dev
	  list. Thanks! ........

	* /, channels/chan_sip.c: Merged revisions 48939 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48939 | russell | 2006-12-24 01:47:29 -0500 (Sun, 24 Dec 2006) |
	  3 lines Remove a couple of misplaced dots in log messages. This
	  was reported by Andrea Spadaccini on the asterisk-dev mailing
	  list. ........

	* main/http.c: Implement locking for the list of URI handlers to
	  make it thread-safe.

2006-12-23  Kevin P. Fleming  <kpfleming@digium.com>

	* Asterisk 1.4.0 released.

2006-12-22 22:33 +0000 [r48870-48906]  Jason Parker <jparker@digium.com>

	* Makefile, main/stdtime/localtime.c: Minor fixes for Solaris.

	* channels/chan_skinny.c: Fix for issue 7774 - patch by alamantia

2006-12-21 20:26 +0000 [r48783]  Joshua Colp <jcolp@digium.com>

	* /, redhat/asterisk.spec: Merged revisions 48782 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48782 | file | 2006-12-21 15:25:01 -0500 (Thu, 21 Dec 2006) | 2
	  lines Add new silence sound files to the spec for Redhat. (issue
	  #8652 reported by alvaro_palma_aste) ........

2006-12-20 02:56 +0000 [r48592-48637]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c: vms doesn't exist on non-IMAP storage
	  builds.

	* apps/app_voicemail.c: Pass 'vms' pointer to record_and_review so
	  it is then passed to the IMAP store file function. (issue #8614
	  reported by punknow)

	* doc/snmp.txt: find is not the same as bind when it comes to
	  documentation. (issue #8626 reported by johann8384)

2006-12-19 21:28 +0000 [r48586]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/Makefile: suppress compiler warnings in this module
	  until it can be improved

2006-12-19 21:12 +0000 [r48585]  Joshua Colp <jcolp@digium.com>

	* apps/app_dial.c, /: Merged revisions 48584 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48584 | file | 2006-12-19 16:10:26 -0500 (Tue, 19 Dec 2006) | 2
	  lines Free localuser structure when we fail to dial (issue #8612
	  reported by rizzo) ........

2006-12-19 21:03 +0000 [r48583]  Luigi Rizzo <rizzo@icir.org>

	* apps/app_sms.c: fix a bogus datalen in the frames generated by
	  app_sms (causing noisy output if you listen to the output!) This
	  affects trunk as well, whereas 1.2 is ok.

2006-12-19 14:57 +0000 [r48577]  Kevin P. Fleming <kpfleming@digium.com>

	* res/res_config_odbc.c, funcs/func_odbc.c: use the proper variable
	  type for these unixODBC API calls, eliminating warnings on 64-bit
	  platforms that use the 'new' 64-bit types for ODBC API calls

2006-12-19 03:46 +0000 [r48571]  Joshua Colp <jcolp@digium.com>

	* Makefile: Use env -i to start a fresh environment when going to
	  build menuselect. This is more portable then using unset. (issue
	  #8543 reported by jtodd)

2006-12-18 17:23 +0000 [r48566]  Luigi Rizzo <rizzo@icir.org>

	* include/asterisk/channel.h: unbreak the macro used for
	  incrementing the frame counters. I don't know when the bug was
	  introduced, but with the typical usage c->fin =
	  FRAMECOUNT_INC(c->fin) the frame counters stay to 0. affects
	  trunk as well (fix coming).

2006-12-18 17:15 +0000 [r48564]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: Put thread into proper list if we abort
	  handling due to an error, and also hold the lock while putting it
	  back into the proper idle list so we don't prematurely get a
	  signal. (issue #8604 reported by arkadia)

2006-12-18 11:59 +0000 [r48513-48554]  Kevin P. Fleming <kpfleming@digium.com>

	* codecs/lpc10/Makefile, main/Makefile, codecs/gsm/Makefile,
	  utils/astman.c, utils/smsq.c, codecs/ilbc/Makefile,
	  utils/ael_main.c: remove some now-unnecessary explicit includes
	  of autoconfig.h clean up per-file dependencies during 'make
	  clean'

	* build_tools/prep_tarball: need an additional argument here to
	  make the downloads actually occur

	* configure, include/asterisk/autoconfig.h.in, configure.ac,
	  acinclude.m4: use m4 quoting for AC_MSG_NOTICE calls, to keep
	  these calls from thinking they have multiple arguments

	* codecs/ilbc, formats, utils/Makefile, agi/Makefile, Makefile,
	  funcs, build_tools/mkdep (removed), codecs/lpc10, main/db1-ast,
	  main, codecs/gsm, pbx, res, channels, codecs, utils, agi,
	  main/Makefile, apps, Makefile.moddir_rules, Makefile.rules, cdr:
	  simplify dependency tracking system, using the compiler's
	  built-in method for generating them, and only doing dependency
	  tracking if developer mode is enabled via the configure script

	* Makefile, include/asterisk.h, main/stdtime/localtime.c: since we
	  really, really have to have autoconfig.h included before all
	  other headers (especially system headers), the Makefile will now
	  force it to happen (this will fix build problems with files like
	  ast_expr2f.c, where we can't control the inclusion order in the
	  file itself)

	* funcs/func_curl.c: instead of initializing the curl library every
	  time the CURL() function is invoked, do it only once per thread
	  (this allows multiple calls to CURL() in the dialplan for a
	  channel to run much more quickly, and also to re-use connections
	  to the server) (thanks to JerJer for frequently complaining about
	  this performance problem)

2006-12-15 19:55 +0000 [r48502-48506]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Turn payload_lock into bridge_lock and make it
	  encompass all RTP structure contents that may relate to bridge
	  information, including who we are bridged to.

	* channels/chan_iax2.c: Hold call structure lock in places where a
	  qualify or peer action can destroy it.

	* channels/chan_iax2.c: Lock network retransmission queue in all
	  places that it is used.

2006-12-15 10:55 +0000 [r48481-48487]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Issue #8592 - treat 504 as 503 (imported
	  from 1.2)

	* channels/chan_sip.c: Update to latest IANA spec

2006-12-15 06:28 +0000 [r48461-48478]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: Use a wakeup variable so that we don't wait
	  on IO indefinitely if packets need to be retransmitted.

	* main/rtp.c, include/asterisk/rtp.h: Payload values on the RTP
	  structure can change AFTER a bridge has started. This comes from
	  the packet handling of the SIP response when indication that it
	  was answered has been sent. Therefore we need to protect this
	  data with a lock when we read/write. (issue #8232 reported by
	  tgrman)

	* main/rtp.c: Remove direct RTCP bridging. I've come to the
	  conclusion that we should handle this through the core and not
	  just forward it on. Should solve a few bugs.

2006-12-12  Kevin P. Fleming  <kpfleming@digium.com>

	* Asterisk 1.4.0-beta4 released.

2006-12-12 04:13 +0000 [r48401]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c: Use S_OR in my previous app_voicemail. This
	  is the way it should have been done.

2006-12-11 23:02 +0000 [r48396-48399]  Matt O'Gorman <mogorman@digium.com>

	* sounds/Makefile: new sounds package with 100% more silence

	* /, apps/app_externalivr.c: Merged revisions 48394 via svnmerge
	  from https://svn.digium.com/svn/asterisk/branches/1.2 ........
	  r48394 | mogorman | 2006-12-11 15:55:43 -0600 (Mon, 11 Dec 2006)
	  | 4 lines app_externalivr needs a real silence file, and
	  additional changes to add silence files into core instead of
	  extra patch provided by bug 8177 with minor additions. ........

2006-12-11 21:31 +0000 [r48391]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c: Return non-existant callerid handling to
	  that which it was before. In 1.4 and trunk callerid can be
	  allocated but not have any contents so we have to use
	  ast_strlen_zero before passing it to the relevant functions.
	  (issue #8567 reported by pabelanger)

2006-12-11 05:37 +0000 [r48382]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* funcs/func_strings.c: STRFTIME() does not actually require an
	  argument (issue 8540)

2006-12-11 05:36 +0000 [r48377-48381]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Merge in my latest RTP changes. Break out RTP and
	  RTCP callback functions so they no longer share a common one.

	* apps/app_meetme.c: Use the correct API call to say a device state
	  changed. (Yes, I'm a nub.)

	* apps/app_meetme.c: Don't access the conference structure after it
	  has been freed.

2006-12-11 00:47 +0000 [r48375]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_nbscat.c, /, apps/app_festival.c, apps/app_mp3.c,
	  res/res_agi.c, apps/app_zapras.c, apps/app_externalivr.c,
	  apps/app_ices.c, res/res_musiconhold.c: Merged revisions 48374
	  via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48374 | tilghman | 2006-12-10 18:33:59 -0600 (Sun, 10 Dec 2006)
	  | 5 lines When doing a fork() and exec(), two problems existed
	  (Issue 8086): 1) Ignored signals stayed ignored after the exec().
	  2) Signals could possibly fire between the fork() and exec(),
	  causing Asterisk signal handlers within the child to execute,
	  which caused nasty race conditions. ........

2006-12-10 03:04 +0000 [r48372]  Steve Murphy <murf@digium.com>

	* channels/chan_zap.c, /: Merged revisions 48371 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48371 | murf | 2006-12-09 19:14:13 -0700 (Sat, 09 Dec 2006) | 1
	  line This version applies the patch suggested by stevens in bug
	  7836 (make inbound channel RINGING state consistent with other
	  channels). ........

2006-12-09 15:59 +0000 [r48362-48363]  Russell Bryant <russell@digium.com>

	* channels/chan_iax2.c: Use locking when accessing the
	  registrations list. This list is not actually used very often, so
	  the likelihood of there being a problem is pretty small, but
	  still possible. For example, if the CLI command to list the
	  registrations was called at the same time that a reload was
	  occurring and the registrations list was getting destroyed and
	  rebuilt, a crash could occur. In passing, go ahead and convert
	  this list to use the linked list macros.

	* /: Blocked revisions 48361 via svnmerge ........ r48361 | russell
	  | 2006-12-09 10:45:37 -0500 (Sat, 09 Dec 2006) | 6 lines Use
	  locking when accessing the registrations list. This list is not
	  actually used very often, so the likelihood of there being a
	  problem is pretty small, but still possible. For example, if the
	  CLI command to list the registrations was called at the same time
	  that a reload was occurring and the registrations list was
	  getting destroyed and rebuilt, a crash could occur. ........

2006-12-07 18:17 +0000 [r48357]  Russell Bryant <russell@digium.com>

	* /, res/res_musiconhold.c: Merged revisions 48356 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r48356 | russell | 2006-12-07 13:14:13 -0500 (Thu, 07
	  Dec 2006) | 3 lines Ensure that the file position is not
	  incremented beyond the total number of files available for
	  playback. (issue #8539, ulogic) ........

2006-12-07 15:33 +0000 [r48349]  Steve Murphy <murf@digium.com>

	* main/manager.c, UPGRADE.txt, CHANGES: Here lies the fixes that
	  killed bug 8423 -- OriginateSuccess and OriginateError incomplete
	  channel name. May it rest in peace.

2006-12-06 16:25 +0000 [r48326]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Issue #8258 - fix handling of 487 being
	  retransmitted to Asterisk

2006-12-06 16:15 +0000 [r48323]  Russell Bryant <russell@digium.com>

	* configs/iax.conf.sample, /: Merged revisions 48322 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r48322 | russell | 2006-12-06 11:05:54 -0500 (Wed, 06
	  Dec 2006) | 3 lines Fix the name of the rtignoreregexpire option
	  in the sample configuration file. (issue #8526, arkadia) ........

2006-12-06 12:27 +0000 [r48316-48317]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Don't send Contact on MESSAGE

2006-12-05 20:42 +0000 [r48279]  Jason Parker <jparker@digium.com>

	* configure.ac: Fix curl version number testing to be much more
	  friendly to non-bash shells. Issue 8508, patch by me. This
	  *SHOULD* be POSIX compliant now..

2006-12-05 17:29 +0000 [r48264-48270]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Merging the invitestate-1.4 branch after
	  successful testing. Will check if I can solve this with less
	  changes in 1.2.

	* configs/sip.conf.sample: Add missing s from another repository.
	  (thanks jcmoore!)

	* configs/sip.conf.sample: Updating sip.conf.sample with
	  information about T38 not working when chan_local or chan_agent
	  is involved in the call. I don't know how big a fix that would be
	  to solve, but this is the current state of affairs. (Chan_sip
	  currently checks if the other side of the bridge has a SIP tech.
	  We could/should implement another check, possibly for udptl_write
	  or some flag in the ast_channel structure).

2006-12-05 01:41 +0000 [r48252-48254]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c: Oops, forgot to release the odbc handle

	* apps/app_voicemail.c, /: Merged revisions 48251 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48251 | tilghman | 2006-12-04 19:26:08 -0600 (Mon, 04 Dec 2006)
	  | 6 lines If the recording in the database is too large, it will
	  fail to retrieve with an mmap error. Not too sure why this
	  doesn't happen when we put it in the database, also, but since
	  that doesn't seem to be broken, I'm not going to fix it (at least
	  until someone reports it). Solution is to ask for the file in
	  smaller chunks. (Bug 8385) ........

2006-12-04 21:48 +0000 [r48237-48248]  Jason Parker <jparker@digium.com>

	* apps/app_voicemail.c: Fix an issue which didn't allow
	  unavail/greet/busy/etc messages from being saved into ODBC (and
	  probably IMAP).

	* /: Blocked revisions 48246 via svnmerge ........ r48246 | qwell |
	  2006-12-04 15:20:34 -0600 (Mon, 04 Dec 2006) | 7 lines Revert
	  change from 8016 - this breaks other stuff... Needs further
	  review. Tip: When you've reported a bug about something and
	  somebody has put up a patch for it.. It's not a good idea to open
	  a completely new bug and say that something is broken because of
	  the patch in the other bug - PLEASE mention something in the bug
	  where the patch was actually created. ........

	* /: Blocked revisions 48236 via svnmerge ........ r48236 | qwell |
	  2006-12-04 13:06:26 -0600 (Mon, 04 Dec 2006) | 4 lines Fix an
	  issue where a message isn't saved correctly when using ODBC
	  storage and reviewing a message. Issue 8016 - patch by sokhapkin.
	  ........

2006-12-04 18:16 +0000 [r48234]  Joshua Colp <jcolp@digium.com>

	* /: Blocked revisions 48233 via svnmerge ........ r48233 | file |
	  2006-12-04 13:14:46 -0500 (Mon, 04 Dec 2006) | 2 lines If the
	  generic bridge tells us not to retry, and we have a frame to spit
	  out then break the bridge. Props to markit in #asterisk-bugs for
	  bringing this up. ........

2006-12-04 17:54 +0000 [r48228-48230]  Jason Parker <jparker@digium.com>

	* configs/voicemail.conf.sample: Add documentation to
	  voicemail.conf.sample for ODBC storage. Issue 8499 - patch by
	  blitzrage.

	* doc/snmp.txt: Attempt to document some of the dependencies that
	  are needed for net-snmp Issue 8499 - initial patch by blitzrage.

2006-12-03 06:34 +0000 [r48223]  Russell Bryant <russell@digium.com>

	* sounds/Makefile: When "fetch" is in use, instead of "wget",
	  --continue is not a valid option. (issue #8451)

2006-12-02 21:45 +0000 [r48199-48219]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: - Removing one of two pieces of code to
	  handle 481 response on INVITE - Move handling of REFER response
	  to handle_response_refer()

	* main/rtp.c, channels/chan_sip.c, include/asterisk/rtp.h,
	  configs/sip.conf.sample: - Disable RTP hold timers while T.38 fax
	  transmission happens - Encapsulate RTP timers in the rtp
	  structure so we have one for video and one for audio The video
	  one is not used in 1.4, really. Will be used for RTP keepalives
	  when we can send something that video phones support in the RTP
	  stream. I now this is a big architectual change at this stage for
	  1.4, but decided it was needed to avoid future bug reports. -
	  Document the RTP NAT keepalive option in sip.conf.sample Issue
	  7679 in the bug tracker. Please test.

2006-12-02 03:50 +0000 [r48195]  Russell Bryant <russell@digium.com>

	* include/asterisk/utils.h: Backport the comment containing the
	  warning regarding the limitations on the usage of this function.
	  It is thread safe, but not technically reentrant.

2006-12-01 23:37 +0000 [r48193]  Kevin P. Fleming <kpfleming@digium.com>

	* apps/app_dial.c, /: Merged revisions 48192 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48192 | kpfleming | 2006-12-01 17:30:59 -0600 (Fri, 01 Dec 2006)
	  | 2 lines if Dial() is going to send music-on-hold to the calling
	  party, it has to send PROGRESS first to ensure that the reverse
	  audio path has been setup first (BE-106) ........

2006-12-01 23:16 +0000 [r48190]  Russell Bryant <russell@digium.com>

	* Makefile, configure, configure.ac, makeopts.in, sounds/Makefile:
	  FreeBSD 6.1 does not include wget by default. However, it has
	  fetch which will work just fine for our purposes of downloading
	  the sounds packages. So, check for both wget and fetch and the
	  configure script and use what was found to download them. If
	  neither one was found, and sound packages are selected that must
	  be downloaded, the install process will print out an informative
	  error message indicating the situation. Also, fix a couple places
	  where "make" was hard coded into some output messages by
	  replacing them with the $(MAKE) variable. (issue #8451, initial
	  patch by pabelanger, with additional modifications by me)

2006-12-01 20:25 +0000 [r48184-48186]  Jason Parker <jparker@digium.com>

	* configs/extensions.conf.sample, /: Merged revisions 48183 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48183 | qwell | 2006-12-01 14:19:10 -0600 (Fri, 01 Dec 2006) | 2
	  lines Fix a small typo - issue 8848, reported by pabelanger
	  ........

2006-12-01 19:38 +0000 [r48179]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/cli.c: Double-unlock error (reported by blitzrage on IRC)

2006-12-01 17:41 +0000 [r48177]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c, configs/sip.conf.sample: - Backport of the
	  "limitonpeers" patch from trunk, to fix a lot of issues with
	  queues and SIP device states - Remove support for T.38 early
	  media, since it's impossible. (Two patches in one - extra friday
	  evening offer due to being off line from svn today... :-)

2006-11-30 21:18 +0000 [r48168]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c, include/asterisk/rtp.h, channels/chan_gtalk.c: Do not
	  do a partial bridge for Google Talk since we need to handle STUN.
	  (issue #8448 reported by phsultan)

2006-11-30 20:51 +0000 [r48166]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Issue 8319 - change noncecount before
	  using it.

2006-11-30 20:28 +0000 [r48143-48162]  Joshua Colp <jcolp@digium.com>

	* /: Blocked revisions 48161 via svnmerge ........ r48161 | file |
	  2006-11-30 15:27:29 -0500 (Thu, 30 Nov 2006) | 2 lines Don't
	  write AST_FRAME_NULL or AST_FRAME_IAX frames out to the channel
	  driver. (issue #8390 reported by hselasky) ........

	* /, channels/chan_iax2.c: Merged revisions 48157 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48157 | file | 2006-11-30 15:06:43 -0500 (Thu, 30 Nov 2006) | 2
	  lines Only print out debug message if bridged channel is not
	  NULL. (issue #8412 reported by jubilex) ........

	* /, res/res_features.c: Merged revisions 48154 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48154 | file | 2006-11-30 14:04:11 -0500 (Thu, 30 Nov 2006) | 2
	  lines Do not listen for DTMF on the bridge that comes into
	  existence when ParkedCall is executed. This means native bridging
	  can now occur for this. (issue #8406 reported by kebl0155)
	  ........

	* main/cdr.c, /: Merged revisions 48151 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48151 | file | 2006-11-30 13:42:45 -0500 (Thu, 30 Nov 2006) | 2
	  lines Print certain CDR messages out at the NOTICE level versus
	  WARNING since they can occur when used with the CDR applications
	  and are perfectly fine. (issue #8367 reported by dartvader)
	  ........

	* /: Blocked revisions 48146 via svnmerge ........ r48146 | file |
	  2006-11-30 13:17:54 -0500 (Thu, 30 Nov 2006) | 2 lines Remember
	  the pointer to the allocated block of memory so that we can free
	  it and not cause a memory leak. (issue #8449 reported by arkadia)
	  ........

	* /, configs/sip.conf.sample: Merged revisions 48142 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r48142 | file | 2006-11-30 12:55:23 -0500 (Thu, 30 Nov
	  2006) | 2 lines Document 'port' for SIP peers, came up because of
	  the current mailing list thread. (issue #8450 reported by
	  blitzrage) ........

2006-11-30 14:29 +0000 [r48129-48135]  Olle Johansson <oej@edvina.net>

	* doc/manager.txt: Explain status reports and make codefreeze more
	  happy :-)

	* /, channels/chan_sip.c: Clean up bad dialogs properly. Caused by
	  GS 487 adapter without CSEQ on separate line in the REGISTER
	  request. Imported from 1.2.

2006-11-29 21:05 +0000 [r48115]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c: Use MAILTMPLEN instead of sizeof in
	  mm_login. (issue #8420 reported by slimey)

2006-11-29 19:56 +0000 [r48113]  Olle Johansson <oej@edvina.net>

	* configs/sip.conf.sample: Explain the use device status system
	  implemented in SIP for subscriptions, queues and manager a bit
	  better. Like in 1.2, you will get more detailed information if
	  you set a call limit for a device. When the call limit is
	  reached, the status system will report a device as busy. For
	  queues, setting a call limit per SIP device is propably a
	  requirement. In most cases, it will work much better if you only
	  use type=peer and not type=friend. We might decide to backport
	  the new setting from trunk to apply all call limits to the peer
	  part of a friend only.

2006-11-29 16:50 +0000 [r48107]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c, /: Merged revisions 48106 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48106 | file | 2006-11-29 11:47:10 -0500 (Wed, 29 Nov 2006) | 2
	  lines If the frame was duplicated before writing out then we need
	  to free it. (issue #8429 reported by edguy3) ........

2006-11-29 08:03 +0000 [r48105]  Olle Johansson <oej@edvina.net>

	* configs/sip.conf.sample: Clarify RTP timers. Sorry, grandma.

2006-11-29 04:26 +0000 [r48101]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c: Don't crash if the mailstream was not
	  created.

2006-11-28 18:26 +0000 [r48095]  Jason Parker <jparker@digium.com>

	* Makefile: Export several more variables in top level Makefile.
	  Inspired by issue 8438.

2006-11-28 16:57 +0000 [r48054-48088]  Joshua Colp <jcolp@digium.com>

	* channels/chan_phone.c, /: Merged revisions 48087 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r48087 | file | 2006-11-28 11:56:01 -0500 (Tue, 28 Nov
	  2006) | 2 lines According to the research I have done we never
	  needed to include compiler.h in the first place so let's not!
	  (issue #8430 reported by edguy3) ........

	* apps/app_voicemail.c, /: Merged revisions 48053 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48053 | file | 2006-11-27 13:03:57 -0500 (Mon, 27 Nov 2006) | 2
	  lines Use the proper function to get the new message count
	  instead of always using the filesystem. (issue #8421 reported by
	  slimey) ........

2006-11-27 17:20 +0000 [r48049]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, res/res_musiconhold.c: Merged revisions 48045 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r48045 | tilghman | 2006-11-27 11:15:54 -0600 (Mon, 27
	  Nov 2006) | 2 lines Random MOH wasn't really random (bug 8381)
	  ........

2006-11-27 17:17 +0000 [r48046]  Russell Bryant <russell@digium.com>

	* main/manager.c: Remove a couple of unused variables (issue #8380,
	  casper)

2006-11-27 15:32 +0000 [r48038]  Joshua Colp <jcolp@digium.com>

	* pbx/pbx_spool.c, /: Merged revisions 48037 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r48037 | file | 2006-11-27 10:30:37 -0500 (Mon, 27 Nov 2006) | 2
	  lines Do not reference the freed outgoing structure in the debug
	  message. (issue #8425 reported by arkadia) ........

2006-11-27 06:41 +0000 [r48031]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Change logging message

2006-11-26 00:26 +0000 [r48015-48017]  Steve Murphy <murf@digium.com>

	* funcs/func_cdr.c: might as well also document the raw values of
	  the flag vars

	* /, funcs/func_cdr.c: A little bit of func_cdr documentation
	  upgrade-- no bug# involved, although 8221 may have inspired it.

2006-11-25 09:28 +0000 [r48002]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Not having a HINT is not an ERROR. In 1.4
	  and future releases, you can disable subscription support totally
	  or per peer in sip.conf with allowsubscribe = yes | no

2006-11-24 17:17 +0000 [r47992]  Steve Murphy <murf@digium.com>

	* main/translate.c: bug 8189 posted this fix for main/translate.c
	  for PLC

2006-11-24 15:46 +0000 [r47989]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/misdn_config.c,
	  channels/chan_misdn.c, /: Merged revisions 47968 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r47968 | crichter | 2006-11-23 17:10:23 +0100 (Do, 23
	  Nov 2006) | 1 line fixed a litle bug regarding HOLD/RETRIEVE.
	  beatufied some logs, changed some loglevels. changed the default
	  value of block_on_alarm ........

2006-11-23 11:01 +0000 [r47959]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Don't allocate unused variable.

2006-11-22 21:47 +0000 [r47944]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Video will never reach Packet2Packet bridging and can
	  do more harm then good.

2006-11-21 17:32 +0000 [r47897]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: If we have the non standard G726-32 setting turned on
	  we want to return G726-32 to the SDP, not our AAL2 string. (issue
	  #8330 reported by voipgate)

2006-11-21 15:20 +0000 [r47892]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Apparently Exosip sends a 101 after a 100
	  provisional response. Let's not treat that as early media.
	  (discovered at the AVTF meeting in Paris).

2006-11-20 20:01 +0000 [r47863-47864]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c: Oops, merge missed release of odbc object

	* apps/app_voicemail.c, /: Merged revisions 47862 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47862 | tilghman | 2006-11-20 13:59:07 -0600 (Mon, 20 Nov 2006)
	  | 2 lines Failing to trap -1 error from mmap causes segfault
	  (Issue 8385) ........

2006-11-20 19:51 +0000 [r47850-47860]  Joshua Colp <jcolp@digium.com>

	* main/frame.c, /: Merged revisions 47859 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47859 | file | 2006-11-20 14:50:21 -0500 (Mon, 20 Nov 2006) | 2
	  lines Don't forget to byte swap if we are exiting the smoother
	  feed early. (issue #8287 reported by arturs) ........

	* /: Blocked revisions 47855 via svnmerge ........ r47855 | file |
	  2006-11-20 11:16:22 -0500 (Mon, 20 Nov 2006) | 2 lines Free
	  history items at the end of use of the temporary SIP pvt
	  structure. (issue #8383 reported by benh) ........

	* main/rtp.c: Only remove/destroy the RTCP I/O item if it exists.

	* .cleancount, apps/app_dial.c, apps/app_directed_pickup.c,
	  include/asterisk/channel.h: Use a separate variable in the
	  channel structure to store the context that the channel was
	  dialed from. (issue #8382 reported by jiddings)

2006-11-20 11:45 +0000 [r47843-47845]  Olle Johansson <oej@edvina.net>

	* configs/sip.conf.sample: Explain properly how videosupport works.
	  Committ from Asterisk Video Task Force meeting in Paris!

	* /, channels/chan_sip.c: Make sure we destroy scheduled items and
	  not use them ever again after destruction (rizzo)

2006-11-18 17:59 +0000 [r47823]  Luigi Rizzo <rizzo@icir.org>

	* channels/chan_sip.c: fix bug 7450 - Parsing fails if From header
	  contains angle brackets (the bug was only in a corner case where
	  the < was right after the opening quote, and the fix is trivial).

2006-11-16 23:19 +0000 [r47781-47782]  Jason Parker <jparker@digium.com>

	* apps/app_db.c, apps/app_dial.c: Fix a couple of typos. Initially
	  pointed out by mrobinson.

	* /: Blocked revisions 47780 via svnmerge ........ r47780 | qwell |
	  2006-11-16 17:16:35 -0600 (Thu, 16 Nov 2006) | 2 lines Fix a
	  couple of typos in applications.. Initially spotted by mrobinson.
	  ........

2006-11-16 23:00 +0000 [r47777]  Kevin P. Fleming <kpfleming@digium.com>

	* /, doc/billing.txt: update documentation regarding IAX2 transfers
	  and CDRs Merged revisions 47776 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47776 | kpfleming | 2006-11-16 16:57:31 -0600 (Thu, 16 Nov 2006)
	  | 2 lines update clearly wrong documentation regarding cdr_custom
	  ........

2006-11-16 21:11 +0000 [r47762-47764]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Compare technology using the pointers
	  instead of a straight comparison based on name. (issue #8228
	  reported by dean bath)

	* /: Blocked revisions 47761 via svnmerge ........ r47761 | file |
	  2006-11-16 15:29:28 -0500 (Thu, 16 Nov 2006) | 2 lines Look for
	  the header file specifically in all cases, not just the existence
	  of the directory. (issue #8358 reported by mrness) ........

2006-11-16 20:09 +0000 [r47758]  Kevin P. Fleming <kpfleming@digium.com>

	* configure, configure.ac: check for pre-1.4 versions of Zaptel and
	  abort the configure script if found with an appropriate error
	  message

2006-11-16 19:24 +0000 [r47755]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c, configs/sip.conf.sample: Make the HOLD
	  notification optional, in order to avoid a lot of extra database
	  lookups for all those realtime users out there.

2006-11-16 18:29 +0000 [r47748-47751]  Joshua Colp <jcolp@digium.com>

	* channels/chan_local.c, /: Merged revisions 47750 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r47750 | file | 2006-11-16 13:26:50 -0500 (Thu, 16 Nov
	  2006) | 2 lines Because of the way chan_local is written we
	  should be extra careful and make sure our callback functions have
	  a tech_pvt. (issue #8275 reported by mflorell) ........

	* apps/app_meetme.c: Don't unreference the SLA object if there is
	  no SLA object in the devicestate callback. (issue #8354 reported
	  by loloski)

2006-11-16 16:51 +0000 [r47733-47744]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Don't fixup if there's nothing to fixup

	* UPGRADE.txt: Warn users about change in canreinvite

	* channels/chan_sip.c, configs/sip.conf.sample: - CANCEL is never
	  authenticated (according to the RFC) - Update docs on
	  canreinvite. "nonat" is the recommended setting for most users
	  with phones behind a NAT.

2006-11-15 22:31 +0000 [r47712]  Joshua Colp <jcolp@digium.com>

	* channels/chan_local.c, /: Merged revisions 47711 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r47711 | file | 2006-11-15 17:29:30 -0500 (Wed, 15 Nov
	  2006) | 2 lines Make sure that the pvt structure exists before
	  trying to do fixup on Local channels. (issue #7937 reported by
	  mada123, fix by alamantia with mods by me) ........

2006-11-15 21:56 +0000 [r47709]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c: Fix ODBC_STORAGE for when context is NULL

2006-11-15 21:33 +0000 [r47707]  Joshua Colp <jcolp@digium.com>

	* main/channel.c: We need to ensure timelimit stuff is included as
	  well so warnings get played. (issue #8050 reported by KNK)

2006-11-15 20:50 +0000 [r47701]  Kevin P. Fleming <kpfleming@digium.com>

	* main/file.c: don't try to call fclose() if fopen() failed

2006-11-15 20:31 +0000 [r47698]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: - Improve SIP history - Never send reply to
	  ACK (again...)

2006-11-15 20:31 +0000 [r47684-47697]  Kevin P. Fleming <kpfleming@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 47677 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47677 | kpfleming | 2006-11-15 11:56:42 -0600 (Wed, 15 Nov 2006)
	  | 4 lines ensure that message duration is included in email
	  notifications for forwarded messages (BE-96, fix by me after
	  corydon used his clue-bat on me) ensure that duration in the
	  message metadata is updated if prepending is done during
	  forwarding (related to BE-96) remove prototype for API call that
	  does not exist ........

	* main/config.c, /: Merged revisions 47686,47688-47689 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r47686 | kpfleming | 2006-11-15 13:42:05 -0600 (Wed, 15
	  Nov 2006) | 2 lines clear the category's variable tail pointer as
	  well when variables are detached from it ........ r47688 |
	  kpfleming | 2006-11-15 13:47:43 -0600 (Wed, 15 Nov 2006) | 2
	  lines when appending a list of variable to a category, ensure the
	  tail pointer points to the last variable in the list ........
	  r47689 | kpfleming | 2006-11-15 13:58:46 -0600 (Wed, 15 Nov 2006)
	  | 2 lines when re-writing the config file, don't repeat the path
	  if it hasn't changed ........

	* main/config.c, /: Merged revisions 47682 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47682 | kpfleming | 2006-11-15 12:39:47 -0600 (Wed, 15 Nov 2006)
	  | 2 lines ouch... don't use printf, use ast_log/ast_verbose
	  ........

2006-11-15 17:46 +0000 [r47672]  Luigi Rizzo <rizzo@icir.org>

	* main/cli.c: fix longest match search in find_cli. Trunk already
	  fixed. 1.2 not affected (well, i have no idea, the code is
	  totally different there).

2006-11-15 15:25 +0000 [r47649-47656]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Send error message when we can't allocate
	  SIP dialog, possibly due to limitation of file descriptors.
	  (imported from 1.2)

2006-11-15 04:45 +0000 [r47645]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: If NAT detection is turned on or already detected
	  then say NAT is active when setting the remote RTP peer when
	  doing early bridging. (issue #8365 reported by marcelbarbulescu)

2006-11-15 00:19 +0000 [r47641]  Kevin P. Fleming <kpfleming@digium.com>

	* main/term.c: more formatting cleanup, and avoid running off the
	  end of the string

2006-11-15 00:14 +0000 [r47639]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Turn notice about unknown RTCP packet type into a
	  debug message instead.

2006-11-15 00:05 +0000 [r47635]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/misdn/isdn_lib.c: silence compiler warning on 64-bit
	  platforms (this variable is an 'int' anyway, comparing it to
	  'signed long' is not useful)

2006-11-14 22:17 +0000 [r47625-47632]  Joshua Colp <jcolp@digium.com>

	* apps/app_voicemail.c, /: Merged revisions 47631 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47631 | file | 2006-11-14 17:15:10 -0500 (Tue, 14 Nov 2006) | 2
	  lines Update copyright information in the ADSI logo blob.
	  ........

	* channels/chan_sip.c: Only keep the video RTP structure around if
	  1. Video support is enabled and 2. A video codec is enabled on
	  the dialog

	* funcs/func_uri.c: Small documentation clarification for
	  URIENCODE. (issue #8294 reported by salaud)

2006-11-14 18:54 +0000 [r47621]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c: Conversion of res_odbc API to include ast_
	  prefix did not completely transition app_voicemail when
	  ODBC_STORAGE is used (reported on IRC by caio1982, not in
	  bugtracker)

2006-11-14 16:45 +0000 [r47617]  Joshua Colp <jcolp@digium.com>

	* apps/app_amd.c: Use LOG_DEBUG to print out the indication that
	  app_amd is using default settings instead of using LOG_NOTICE.
	  This stops needless logging of this information under normal
	  circumstances. (issue #8361 reported by Seb7)

2006-11-14 16:22 +0000 [r47597-47613]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Update documentation to fit the
	  implementation...

	* /, channels/chan_sip.c: Issue #8272 - Don't destroy dialog in
	  retransmission system if it's an OPTION packet from peerpoke

2006-11-13 21:28 +0000 [r47584]  Joshua Colp <jcolp@digium.com>

	* /, cdr/cdr_pgsql.c: Merged revisions 47583 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47583 | file | 2006-11-13 16:26:36 -0500 (Mon, 13 Nov 2006) | 2
	  lines Initialize global pointers for connection and result to
	  NULL. (issue #8356 reported by james) ........

2006-11-13 20:20 +0000 [r47581]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /, channels/chan_sip.c: Merged revisions 47580 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47580 | tilghman | 2006-11-13 14:18:30 -0600 (Mon, 13 Nov 2006)
	  | 2 lines Having more than 255 old messages caused corruption in
	  the new/old count ........

2006-11-13 19:15 +0000 [r47576]  Steve Murphy <murf@digium.com>

	* main/config.c: This solves bug 8342, whereby a crash occurs under
	  certain circumstances while reading a config file with comments--
	  a call to CB_ADD shouldn't happen if withcomments is zero

2006-11-13 19:11 +0000 [r47573]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/cli.c, channels/chan_sip.c: Re-enable old deprecated
	  commands

2006-11-13 19:10 +0000 [r47572]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: - Don't reply to INVITE already replied
	  to when we get BYE - Declare errmsg as int. Oops.

2006-11-13 18:18 +0000 [r47564]  Steve Murphy <murf@digium.com>

	* pbx/ael/ael-test/ref.ael-test3: Eager people beat me to fixing
	  the messed if, but we all forgot to update the regressions. Until
	  now.

2006-11-13 17:13 +0000 [r47553]  Steve Murphy <murf@digium.com>

	* pbx/pbx_ael.c: AEL need not complain about parkedcalls not being
	  found... just confuses users

2006-11-13 17:08 +0000 [r47542-47551]  Joshua Colp <jcolp@digium.com>

	* /, apps/app_sms.c: Merged revisions 47549 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47549 | file | 2006-11-13 12:05:32 -0500 (Mon, 13 Nov 2006) | 2
	  lines When sending an SMS with a user data header properly set
	  the UDH flag in the first byte. (issue #8347 reported by
	  hoffmeis) ........

	* main/cli.c: Free full command string upon unregistering of CLI
	  command. Backported from revision 47536 from rizzo.

2006-11-13 16:00 +0000 [r47540]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Only produce error message about sip history
	  once

2006-11-13 05:48 +0000 [r47527]  Russell Bryant <russell@digium.com>

	* configure, acinclude.m4: AC_PROG_SED is included in autoconf
	  2.60, but apparently it is not included in 2.59. So, to maintain
	  compatability with 2.59 since it is a small change, copy this
	  macro into acinclude.m4 and rename it to AST_PROG_SED. (issue
	  #8345)

2006-11-13 05:46 +0000 [r47523-47526]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* res/res_odbc.c, /: Merged revisions 47525 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47525 | tilghman | 2006-11-12 23:45:11 -0600 (Sun, 12 Nov 2006)
	  | 2 lines If the execute fails a second time, make sure that we
	  don't pass back a stale handle ........

	* channels/chan_zap.c, /: Merged revisions 47522 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47522 | tilghman | 2006-11-12 18:34:44 -0600 (Sun, 12 Nov 2006)
	  | 2 lines Don't play dialtone if the seizing the channel fails
	  (Bug 7754) ........

2006-11-12 16:12 +0000 [r47507-47513]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Issue 8314 - Restore auto-framing (Thanks
	  DEA!!!)

	* channels/chan_sip.c: Part of issue 8078 - parse even if udptl is
	  UDPTL in sdp...

	* channels/chan_sip.c: - Don't destroy SIP dialog because of a
	  failed T.38 re-invite. Wait for a bye. Final response to a
	  re-invite does not mean that the session dies, only that the
	  re-invite fails. - Keep RTP active during processing of T.38
	  re-invite. If the re-invite fails, RTP needs to remain as before
	  the re-invite. Issue 8338 - darren1713. Please test.

	* channels/chan_sip.c: -Remove blocking of ptime: parsing in sdp
	  -Add some comments to t.38 code

2006-11-12 06:23 +0000 [r47492-47497]  Russell Bryant <russell@digium.com>

	* /, channels/chan_iax2.c: Merged revisions 47496 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r47496 | russell | 2006-11-12 01:09:03 -0500 (Sun, 12 Nov 2006) |
	  4 lines Only do the check to determine whether the channel
	  calling this function is an IAX2 channel when getting the IP
	  address using the special argument, CURRENTCHANNEL. (issue #8341,
	  jcovert) ........

	* Makefile: Add the target "menuconfig" as an alias for the
	  "menuselect" target. This is just a favor to users so that if you
	  accidentally type "make menuconfig" instead of "make menuselect",
	  it still works. (inspired by a comment on IRC from wangster
	  calling me an "especially devious asterisk developer" for having
	  it be menuselect instead of menuconfig. :) )

	* main/term.c: Tweak the formatting of this new function to better
	  conform to coding guidelines.

2006-11-11 02:04 +0000 [r47490]  Matt O'Gorman <mogorman@digium.com>

	* main/term.c, /, main/logger.c, include/asterisk/term.h: woohoo
	  safe output!

2006-11-10 22:23 +0000 [r47480]  Matt Frederickson <creslin@digium.com>

	* channels/chan_zap.c: Make sure we don't use 32 bits when we only
	  need one bit.

2006-11-10 21:42 +0000 [r47463-47476]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: ...and make sure that the dialog is
	  destroyed, even if we don't get any answer on the bye... This is
	  the channel that remains dead after the SIP transfer

	* channels/chan_sip.c: Add debug output while trying to trace bug
	  in bug report

	* channels/chan_sip.c: Make sure we destroy dialog...

	* /, channels/chan_sip.c: Small cleanup of handle_request_invite()
	  - imported from 1.2 with changes

2006-11-10 19:47 +0000 [r47462]  Matt Frederickson <creslin@digium.com>

	* channels/chan_zap.c: Fix for #7321. Be able to explicitly hide
	  callerid name for switches that bork on it.

2006-11-10 18:56 +0000 [r47454]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Issue 8010 - Fix support for multipart
	  SDP (alphaque)

2006-11-10 17:13 +0000 [r47444]  Luigi Rizzo <rizzo@icir.org>

	* build_tools/prep_moduledeps: grep -m is not available on BSD, so
	  use head -1 instead

2006-11-10 16:53 +0000 [r47437]  Joshua Colp <jcolp@digium.com>

	* apps/app_chanspy.c: Only split up extension and context if a
	  value exists. (issue #8332 reported by loloski)

2006-11-10 16:51 +0000 [r47436]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* channels/chan_mgcp.c, main/cli.c, channels/chan_sip.c,
	  channels/chan_skinny.c, channels/chan_h323.c,
	  channels/chan_iax2.c: Discussion of these CLI changes resulted in
	  more consistency (Bug 8236)

2006-11-10 16:36 +0000 [r47432-47433]  Kevin P. Fleming <kpfleming@digium.com>

	* apps/app_queue.c: if adding a queue member is LOG_NOTICE, then
	  removing them should be LOG_NOTICE, not LOG_DEBUG

	* apps/app_queue.c: reflect addition/removal of dynamic queue
	  members in queue_log, so that people using dialplan replacement
	  for AgentCallbackLogin can still track login/logout (issue #7736,
	  reported/patched by whoiswes but this commit was written by me
	  and covers all three paths for AQM/RQM)

2006-11-10 13:04 +0000 [r47414-47418]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Rip out half implementation of 491 response
	  support, since it wasn't implemented properly and caused memory
	  leaks in the case of us getting 491's, which Asterisk actually
	  sends... Since it is a bit too complicated to fix this, I'll rip
	  it out of 1.4 and put it on the to-do-list for future releases.
	  Now, we handle this as congestion, which it really is. Issue
	  #8331

	* channels/chan_sip.c: Fix bit definition for SIP_PAG2_CALL_ONHOLD.
	  Thanks fenlander!

2006-11-10 03:44 +0000 [r47398-47405]  Joshua Colp <jcolp@digium.com>

	* channels/chan_h323.c: Fix building of chan_h323 by completeing
	  some structure definitions. (issue #8327 reported by Mithraen)

	* apps/app_voicemail.c: Do conversion in a more easier to read and
	  working way for \r, \n, and \t. (issue #8324 reported by
	  johnlange)

2006-11-09 21:26 +0000 [r47391]  Russell Bryant <russell@digium.com>

	* apps/app_voicemail.c, channels/chan_zap.c,
	  build_tools/prep_moduledeps: Work around an issue that caused
	  menuselect to display a bogus description for app_voicemail and
	  chan_zap. These modules use some preprocessor directives to
	  determine what it will report to Asterisk as its description.
	  However, the way we extract this information from the source
	  files for menuselect is not smart enough to figure this out.
	  (issue #8326, #8328)

2006-11-09 16:53 +0000 [r47380]  Joshua Colp <jcolp@digium.com>

	* channels/chan_phone.c, /: Merged revisions 47379 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r47379 | file | 2006-11-09 11:48:05 -0500 (Thu, 09 Nov
	  2006) | 2 lines Don't include compiler.h on kernels 2.6.18 and
	  higher as, well, it's apparently going to be removed. This should
	  make all you FC6 fans happy as your Asterisk will now build
	  without any mods. ........

2006-11-09 16:28 +0000 [r47352-47377]  Russell Bryant <russell@digium.com>

	* main/cli.c: fix tab completion for "core debug channel" and "core
	  no debug channel"

	* main/cli.c: Fix "core show channel". Also, fix tab completion for
	  both "core show channel" and "core show channels".

	* main/cli.c: Fix "core debug channel <whatever>". I guess someone
	  needs to go through and audit every CLI command that changed
	  number of arguments ...

	* main/asterisk.c: revert the previous change, which actually
	  modified the deprecated command, "show profile". Now, actually
	  apply the change to "core show profile".

	* main/asterisk.c: Fix argument parsing for the "core show profile"
	  CLI command (fixed by rizzo in his branch, team/rizzo/astobj2)

	* main/cli.c: Fix another CLI command, "core show uptime" ...
	  (issue #8323, reported by johnlange, fixed by myself)

	* main/asterisk.c: fix "core show version" to reflect the new
	  number of arguments for this CLI command (issue #8316, kshumard)

2006-11-08 23:14 +0000 [r47344-47348]  Steve Murphy <murf@digium.com>

	* main/channel.c: This update fixes 7531

	* channels/chan_skinny.c: Committed in behalf of 8190.

2006-11-08 21:46 +0000 [r47333-47338]  Kevin P. Fleming <kpfleming@digium.com>

	* main/frame.c: the battle over CLI command formats has broken
	  stuff...

	* channels/chan_sip.c: add simple fix for SDP to report proper
	  sample rate for G.722 media sessions

2006-11-08 17:03 +0000 [r47323-47331]  Russell Bryant <russell@digium.com>

	* utils/streamplayer.c: I occasionally get email from users that
	  are trying to figure out what this does, or due to some
	  misunderstanding as to what it is supposed to do, can't get it to
	  work. So, I have added some text here to hopefully explain what
	  this application does and does not do.

	* channels/chan_gtalk.c: Make this module build again

	* configure, configure.ac, acinclude.m4: Copy the macros from
	  libtool.m4 to our own acinclude.m4 such that libtool is no longer
	  required to be installed to be able to generated the configure
	  script.

2006-11-08 07:43 +0000 [r47309-47310]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Destroy dialog properly at unload (rizzo)

2006-11-07 23:46 +0000 [r47303]  Steve Murphy <murf@digium.com>

	* channels/chan_oss.c, main/channel.c, channels/chan_phone.c,
	  channels/chan_misdn.c, channels/chan_skinny.c,
	  channels/chan_features.c, channels/chan_h323.c,
	  channels/chan_alsa.c, channels/chan_nbs.c, channels/chan_mgcp.c,
	  include/asterisk/stringfields.h, apps/app_voicemail.c,
	  main/pbx.c, channels/chan_vpb.cc, channels/chan_local.c,
	  channels/chan_zap.c, channels/chan_sip.c, res/res_features.c,
	  channels/chan_agent.c, main/utils.c, include/asterisk/channel.h,
	  channels/chan_gtalk.c, channels/chan_iax2.c: These mods are to
	  solve the problem in bug 7506. It's a lot of rework to solve a
	  fairly small problem... such is life.

2006-11-07 20:14 +0000 [r47284-47287]  Joshua Colp <jcolp@digium.com>

	* channels/chan_local.c: Make MOH work as it did before in
	  chan_local, without this then it can go funky when transfers and
	  MOH are involved. (issue #7671 reported by jmls)

2006-11-07 18:56 +0000 [r47279]  Kevin P. Fleming <kpfleming@digium.com>

	* configs/musiconhold.conf.sample: clean up sample config, and make
	  native file playback the more obvious default choice

2006-11-07 18:38 +0000 [r47275]  Matt O'Gorman <mogorman@digium.com>

	* apps/app_voicemail.c: large overhaul to voicemail imap support.
	  Allows support for more imap servers, also a better
	  implementation of several parts of the original work. patch
	  provided by 8033 with major upgrades.

2006-11-07 17:30 +0000 [r47268]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Issue 8303 (lrizzo) - break instead of
	  continue.

2006-11-07 13:13 +0000 [r47250]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Fixing the attack shield so it doesn't
	  produce attacks... Issue 8265 - never reply to an ACK

2006-11-07 01:25 +0000 [r47239]  Russell Bryant <russell@digium.com>

	* /, res/res_musiconhold.c: Merged revisions 47238 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r47238 | russell | 2006-11-06 20:22:58 -0500 (Mon, 06
	  Nov 2006) | 5 lines If random order is enabled for files mode
	  music on hold, set a random initial position, instead of always
	  starting at the first file, and doing the random operation only
	  when switching to the next file. (bug reported by John Lange on
	  the asterisk-dev mailing list) ........

2006-11-04 18:32 +0000 [r47199]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Issue #8284: Fixes to Invite/replaces and
	  transfer from "john" Thank you!

2006-11-04 18:10 +0000 [r47192-47196]  Russell Bryant <russell@digium.com>

	* main/cli.c: Fix another bug in "core set debug" ...

	* main/asterisk.c, main/cli.c: Really fix the "core set debug" and
	  "core set verbose" CLI commands.

	* main/cli.c: fix the "atleast" option to the "core set verbose"
	  and "core set debug" CLI commands

2006-11-03 23:17 +0000 [r47176]  Steve Murphy <murf@digium.com>

	* channels/chan_sip.c: This fix introduced via bug 8233

2006-11-03 17:53 +0000 [r47107-47108]  Luigi Rizzo <rizzo@icir.org>

	* bootstrap.sh: align bootstrap.sh with the version in trunk (needs
	  to be blocked as it is already in trunk)

	* configure.ac: add proper environment vars to detect modules on
	  freebsd. (already applied to trunk so it needs to be blocked
	  there)

2006-11-02 23:49 +0000 [r47051-47053]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/rtp.c, main/udptl.c, channels/chan_skinny.c, res/res_agi.c,
	  channels/chan_h323.c, apps/app_queue.c, res/res_jabber.c: More
	  changes making the CLI more consistent with "category verb
	  arguments" (continuation of issue 8236)

	* main/config.c, main/cli.c, main/channel.c, main/manager.c,
	  channels/chan_skinny.c, channels/chan_features.c, res/res_agi.c,
	  main/http.c, main/file.c, main/logger.c, main/image.c,
	  res/res_indications.c, main/asterisk.c, res/res_odbc.c,
	  channels/chan_mgcp.c, apps/app_voicemail.c, main/pbx.c,
	  channels/chan_local.c, main/frame.c, channels/chan_sip.c,
	  res/res_features.c, channels/chan_agent.c, res/res_crypto.c,
	  res/res_musiconhold.c, channels/chan_iax2.c, apps/app_queue.c:
	  Reverse change of "show" to "list" and make several other
	  commands more consistent with "category verb arguments"

2006-11-02 19:56 +0000 [r46992-47015]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Move check for codec translation to
	  sip_call() instead of in add_sdp. No one bothers with the result
	  of add_sdp anyway... Yet...

	* channels/chan_sip.c: Disable code for T38 over TCP and RTP since
	  there's no trace of actual functionality for it :-)

2006-11-02 17:49 +0000 [r46965]  Russell Bryant <russell@digium.com>

	* /, res/res_musiconhold.c: Merged revisions 46964 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r46964 | russell | 2006-11-02 12:47:56 -0500 (Thu, 02
	  Nov 2006) | 3 lines ignore files in a music on hold directory
	  that begin with '.' (issue #8249, cboie) ........

2006-11-02 17:17 +0000 [r46963]  Nadi Sarrar <ns@beronet.com>

	* channels/misdn/isdn_lib.c: find_free_chan_in_stack usage fix

2006-11-02 16:45 +0000 [r46937]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_sip.c: don't send INVITE when we have determined
	  that we can't offer any audio formats due to lack of transcoding
	  support (or incorrect configuration)

2006-11-02 16:06 +0000 [r46930]  Joshua Colp <jcolp@digium.com>

	* /, channels/chan_sip.c: Merged revisions 46920 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r46920 | file | 2006-11-02 11:02:27 -0500 (Thu, 02 Nov 2006) | 2
	  lines Repeat after me oej: I will at least make sure my code
	  compiles before I commit it. ........

2006-11-02 15:24 +0000 [r46901]  Olle Johansson <oej@edvina.net>

	* /, channels/chan_sip.c: Dont overwrite pkt->flags (from 1.2)

2006-11-02 14:02 +0000 [r46845-46883]  Russell Bryant <russell@digium.com>

	* /, main/callerid.c: Add the missing call to free described in
	  issue #8268. Also, add a bunch of missing calls to free in
	  callerid_feed_jp().

	* main/say.c: fix saying one hundred and two hundred in hebrew
	  (issue #7810, eldadran)

	* Makefile, configure, codecs/gsm/Makefile, configure.ac,
	  build_tools/strip_nonapi, makeopts.in: Fixes for
	  cross-compilation on mips (issue #8058, ywalther, with some
	  modifications)

	* aclocal.m4, build_tools/menuselect-deps.in, configure,
	  build_tools/embed_modules.xml, configure.ac: Add a check in the
	  configure script to determine whether ld is GNU ld or not. This
	  is needed because module embedding only works for gnu ld. GNU ld
	  is now listed as a dependency for all of the module embedding
	  options in menuselect. (issue #8143)

2006-11-01 20:35 +0000 [r46822]  Matt O'Gorman <mogorman@digium.com>

	* channels/chan_gtalk.c: bind address support from bug 8164

2006-11-01 19:49 +0000 [r46802]  Steve Murphy <murf@digium.com>

	* res/res_config_odbc.c: a fix for bug 8251; the var_val needs to
	  accept longer strings or mass confusion and a lot of lost time is
	  the result

2006-11-01 18:39 +0000 [r46780]  Joshua Colp <jcolp@digium.com>

	* main/Makefile: Force poll() emulation for Darwin to always be on.
	  It's too broken to consider being used. This resolves the console
	  issue OSX users have been seeing. I would have liked to autoconf
	  this but I haven't been able to come up with a test case that
	  works. Que sera.

2006-11-01 18:26 +0000 [r46778]  Russell Bryant <russell@digium.com>

	* res/res_monitor.c, /: Merged revisions 46776 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r46776 | russell | 2006-11-01 13:24:17 -0500 (Wed, 01 Nov 2006) |
	  9 lines soxmix and Asterisk expect different file extensions for
	  certain formats. This was already handled for the wav49 format.
	  However, it was not handled for ulaw and alaw. I fixed this in
	  such a way that using the alternate extensions for ulaw and alaw
	  will only happen if we know we're calling soxmix, and not a
	  custom script defined using the MONITOR_EXEC variable. The wav49
	  processing was left alone so that external scripts will see no
	  behavior change. (issue #7550, reported by mnicholson, proposed
	  patch by junky, committed fix is a bit different) ........

2006-11-01 18:21 +0000 [r46775]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: It's another round of chan_iax2 fixes!
	  Should hopefully fix the deadlock issues people have been
	  reporting. IAXtel now has qualify turned on for 800 peers and it
	  is handling it fine.

2006-11-01 17:48 +0000 [r46760]  Steve Murphy <murf@digium.com>

	* main/config.c: Cleanups suggested by Russell.

2006-11-01 16:39 +0000 [r46744]  Russell Bryant <russell@digium.com>

	* channels/chan_zap.c: Prevent an infinite loop when config
	  processing gets to a jitterbuffer option

2006-10-31 22:02 +0000 [r46716]  Jason Parker <jparker@digium.com>

	* main/translate.c: Fix "core show translation" output. Issue
	  #8243, patch by Damin.

2006-10-31 21:47 +0000 [r46711-46714]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/translate.h, main/translate.c: add an API so
	  that translators can activate/deactivate themselves when needed

	* include/asterisk/translate.h, main/translate.c: revert changes
	  that were the wrong way to address this... proper fix coming

	* main/translate.c: let's set the seen flag early enough to
	  actually make a difference...

	* include/asterisk/translate.h, main/translate.c: don't re-do setup
	  operations for translators that can dynamically register
	  themselves

2006-10-31 15:49 +0000 [r46663]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* /: Blocked revisions 46662 via svnmerge ........ r46662 |
	  tilghman | 2006-10-31 09:46:04 -0600 (Tue, 31 Oct 2006) | 3 lines
	  Move thread-unsafe initializer to the module loading code; add
	  the corresponding function to the module unload to fix a memory
	  leak. ........

2006-10-31 10:56 +0000 [r46583-46631]  Olle Johansson <oej@edvina.net>

	* main/enum.c, funcs/func_enum.c, include/asterisk/enum.h: Issue
	  #8089 - Fix the ENUM support (picking one record by number).
	  Thanks otmar!

	* /, channels/chan_sip.c, configs/sip.conf.sample: Support ;rport
	  when we're supposed to support ;rport. Issue #7473.

	* /, channels/chan_sip.c: If peer fails ACL check, fail peer at
	  REGISTER

	* channels/chan_sip.c: Fix T38 too. Thanks, tgrman !

2006-10-31 06:30 +0000 [r46554-46563]  Russell Bryant <russell@digium.com>

	* contrib/init.d/rc.redhat.asterisk: Start Asterisk later in the
	  boot process to ensure it starts after stuff like MySQL (issue
	  #8253, Alric)

	* /, main/utils.c: Merged revisions 46560 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r46560 | russell | 2006-10-31 01:18:36 -0500 (Tue, 31 Oct 2006) |
	  3 lines When handling the case where the hostname is just an IPV4
	  numeric address, be sure to set the address type. (issue #8247,
	  alexr) ........

	* /, res/res_agi.c: Merged revisions 46557 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r46557 | russell | 2006-10-31 01:13:09 -0500 (Tue, 31 Oct 2006) |
	  3 lines fix some copy/paste bugs in the checking of arguments for
	  the "control stream file" AGI command (issue #8255, mnicholson)
	  ........

	* main/translate.c: Add a small tweak to the code that checks to
	  see whether destination formats are translatable based on the
	  source format. If we have already determined that there is no
	  translation path in one direction, don't bother checking the
	  other direction.

2006-10-30 22:19 +0000 [r46511-46526]  Kevin P. Fleming <kpfleming@digium.com>

	* main/translate.c: when unregistering a translator, don't rebuild
	  the translation matrix unless needed when filtering formats out
	  of an offer, ensure we check for translation ability in both
	  directions

	* include/asterisk/linkedlists.h: ensure that items removed from a
	  list are always unlinked from the list (next pointer set to NULL)

2006-10-30 21:09 +0000 [r46474-46506]  Joshua Colp <jcolp@digium.com>

	* configure, configure.ac: Don't explicitly link in crypt as it is
	  not used on some platforms.

	* channels/chan_iax2.c: We need to lock the pvt structure during
	  retransmission as another worker thread may be doing something as
	  well.

2006-10-30 16:27 +0000 [r46382-46433]  Olle Johansson <oej@edvina.net>

	* main/asterisk.c, apps/app_voicemail.c, include/asterisk/file.h,
	  include/asterisk/doxyref.h, channels/chan_sip.c,
	  main/ast_expr2f.c, include/asterisk/module.h,
	  formats/format_ogg_vorbis.c, main/app.c,
	  include/asterisk/channel.h, include/asterisk/lock.h,
	  include/asterisk/frame.h: Issue #8246 - Doxygen fixes from
	  kshumard. An extra big thankyou is given to everyone that
	  contributes to doxygen! THANK YOU!

	* main/rtp.c, /: Bind RTCP to the same IP as RTP

	* /, channels/chan_sip.c: Issue #7869 - Stop retransmission of 302
	  redirects (imported from 1.2)

	* /, channels/chan_sip.c: Issue #7608 - Notifications sent with
	  wrong content-type (imported from 1.2, modified)

	* channels/chan_sip.c, CHANGES: Backport of patch for #7828 that
	  was reported for trunk, but obviously exists in 1.4 too.

	* channels/chan_sip.c: Restoring the old logic, since working
	  around it and fixing it seemed too complicated. - The
	  SIP_OUTGOING flag indicates the direction of the last transaction
	  in the dialog. - The initreq stores the last request in the
	  dialog, the request that opened the latest transaction. Please
	  now retry all the 1.4 bug reports with mixed to/from headers,
	  tags etc in ACK, BYE, CANCEL. Thanks!

	* channels/chan_sip.c: Accepting a message twice may be
	  misinterpreted...

	* channels/chan_sip.c: - 183 is not reliable message... - Error
	  should not have SDP

2006-10-28 16:37 +0000 [r46377]  Joshua Colp <jcolp@digium.com>

	* utils/Makefile: Don't build muted on OpenBSD, it is not
	  supported.

2006-10-27 19:03 +0000 [r46370]  Russell Bryant <russell@digium.com>

	* channels/chan_zap.c: move the copy of the default settings to the
	  global settings back out of process_zap, so that they aren't
	  overwritten when process_zap is called multiple times

2006-10-27 18:29 +0000 [r46367]  Olle Johansson <oej@edvina.net>

	* contrib/asterisk-ng-doxygen: Put some doxygen pressure on
	  Christian :-)

2006-10-27 17:39 +0000 [r46358-46363]  Russell Bryant <russell@digium.com>

	* main/asterisk.c, res/res_agi.c, apps/app_externalivr.c,
	  res/res_musiconhold.c: We should always be using _exit() after a
	  fork() or vfork() instead of exit(). This is because exit() does
	  some extra cleanup which in some implementations of vfork(), for
	  example, can actually modify the state of the parent process,
	  causing very weird bugs or crashes. (issue #7971, Nick Gavrikov)

	* /: Blocked revisions 46361 via svnmerge ........ r46361 | russell
	  | 2006-10-27 12:36:07 -0500 (Fri, 27 Oct 2006) | 5 lines We
	  should always be using _exit() after a fork() or vfork() instead
	  of exit(). This is because exit() does some extra cleanup which
	  in some implementations of vfork(), for example, can actually
	  modify the state of the parent process, causing very weird bugs
	  or crashes. (issue #7971, Nick Gavrikov) ........

	* channels/chan_zap.c: Instead of iterating all of the options once
	  to look for jitterbuffer options, and then again for everything
	  else, move the processing of jitterbuffer options into the main
	  loop so that there are no erroneous messages about ignoring
	  unknown options. (issue #8226)

2006-10-27 10:03 +0000 [r46351-46353]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/misdn/isdn_lib.h,
	  channels/chan_misdn.c, /, channels/misdn/isdn_msg_parser.c:
	  Merged revisions 46350 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r46350 | crichter | 2006-10-27 11:24:01 +0200 (Fr, 27 Okt 2006) |
	  1 line fixed a bug which caused chan_misdn to try to allocate 2
	  times the same channel on high load, which then caused
	  instability of mISDN. removed a useless function from isdn_lib.c
	  ........

	* channels/misdn_config.c: fixed not compile issue, which was just
	  introduced

	* channels/misdn_config.c, channels/chan_misdn.c, /,
	  channels/misdn/chan_misdn_config.h, configs/misdn.conf.sample:
	  Merged revisions 46176 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r46176 | crichter | 2006-10-25 10:41:59 +0200 (Mi, 25 Okt 2006) |
	  1 line added nttimeout option to configure wether we disconnect
	  calls on NT timeouts or not during an overlapdial session
	  ........

2006-10-26 17:57 +0000 [r46335-46340]  Jason Parker <jparker@digium.com>

	* /, contrib/scripts/astgenkey.8: Merged revisions 46337 via
	  svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r46337 | qwell | 2006-10-26 12:47:52 -0500 (Thu, 26 Oct 2006) | 2
	  lines oops - somebody forgot to change this - long ago, probably.
	  ........

	* CHANGES: grammar check

2006-10-26 16:38 +0000 [r46331]  Olle Johansson <oej@edvina.net>

	* CHANGES: Corrections to changes (Multiparking is not included)

2006-10-26 16:31 +0000 [r46329]  Russell Bryant <russell@digium.com>

	* main/translate.c: - If the source has no audio or no video
	  portion, do not call powerof() to get the format index. - Don't
	  run through the audio and video loops if there is no audio or
	  video portion of the source If 0 is passed to powerof, it will
	  return -1. This value of -1 was then being used as an array index
	  in these loops, which caused a crash on some systems. Other than
	  this issue, this code works as we expected it to. If a format is
	  not in the source, and we have to translation path to it, it is
	  not offered in the list of acceptable destination formats. (fixes
	  issue #8231)

2006-10-26 12:15 +0000 [r46317]  Kevin P. Fleming <kpfleming@digium.com>

	* CHANGES: update to reflect G.722 addition

2006-10-26 04:18 +0000 [r46298]  Russell Bryant <russell@digium.com>

	* doc/backtrace.txt: update backtrace documentation to reflect
	  changes in 1.4 (issue #8230, kshumard)

2006-10-26 01:37 +0000 [r46287]  Mark Spencer <markster@digium.com>

	* main/config.c, main/manager.c: Fix config comment code
	  preservation code (thanks murf!)

2006-10-25 20:14 +0000 [r46276]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Old todo note - Don't add Contact header on
	  BYE and Cancel

2006-10-25 19:24 +0000 [r46253-46255]  Russell Bryant <russell@digium.com>

	* configure.ac: fix error output when checking for openh323 to
	  refer to openh323 instead of pwlib (issue #8222, misaksen)

2006-10-25 19:16 +0000 [r46252]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Somewhat ugly code to try to fix issue
	  #7608. Since the problem was not very well defined, the fix is a
	  bit fuzzy too... Thanks to Luigi for accidentally spotting the
	  possible problem!

2006-10-25 19:08 +0000 [r46249]  Russell Bryant <russell@digium.com>

	* apps/app_queue.c: update warning message to include "agi" option
	  (issue #8225, jmls)

2006-10-25 18:13 +0000 [r46237-46248]  Kevin P. Fleming <kpfleming@digium.com>

	* sounds/Makefile: use 1.4.3 extra sounds with corrected silence
	  files

	* sounds/sounds.xml, sounds/Makefile: add support for prebuilt
	  G.722 prompts and music on hold files

2006-10-25 15:56 +0000 [r46214-46216]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: show settings doesn't produce a list of
	  similar objects, it should stay a "show"

2006-10-25 14:32 +0000 [r46200]  Kevin P. Fleming <kpfleming@digium.com>

	* main/cli.c, main/cdr.c, channels/chan_phone.c, pbx/pbx_spool.c,
	  channels/chan_features.c, pbx/pbx_ael.c, channels/chan_h323.c,
	  pbx/pbx_realtime.c, channels/chan_alsa.c, apps/app_sms.c,
	  main/image.c, channels/chan_nbs.c, apps/app_rpt.c, main/db.c,
	  cdr/cdr_custom.c, channels/chan_mgcp.c,
	  apps/app_parkandannounce.c, apps/app_voicemail.c,
	  channels/chan_sip.c, apps/app_softhangup.c, apps/app_record.c,
	  res/res_adsi.c, main/utils.c, apps/app_ices.c,
	  pbx/dundi-parser.c, channels/chan_iax2.c, apps/app_queue.c,
	  apps/app_getcpeid.c: apparently developers are still not aware
	  that they should be use ast_copy_string instead of strncpy... fix
	  up many more users, and fix some bugs in the process

2006-10-25 04:58 +0000 [r46165]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/pbx.c: WaitExten truncates decimals of times to wait,
	  instead of accepting them (Bug 8208)

2006-10-25 00:26 +0000 [r46152-46154]  Kevin P. Fleming <kpfleming@digium.com>

	* main/rtp.c, main/frame.c, main/translate.c, formats/format_pcm.c,
	  channels/chan_h323.c, channels/chan_iax2.c,
	  include/asterisk/frame.h: add passthrough and file format support
	  for G.722 16KHz audio (issue #5084, original patch by andrew,
	  updated by mithraen)

	* channels/chan_sip.c, main/translate.c: code zone experiment:
	  don't offer formats in the outbound INVITE that aren't either
	  passthrough or translatable

	* main/translate.c: if multiple translators are registered for the
	  same source/dest combination, ensure that the lowest-cost one is
	  always inserted earlier in the list

2006-10-24 20:30 +0000 [r46142]  Mark Spencer <markster@digium.com>

	* res/res_agi.c: Fix FastAGI when there is no pid (bug #7628,
	  #8147)

2006-10-24 19:29 +0000 [r46130]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: We need to initialize our scheduler pthread
	  condition... yes.

2006-10-24 08:34 +0000 [r46114-46117]  Luigi Rizzo <rizzo@icir.org>

	* main/http.c: merge 45152 don't leak descriptors in http.c

	* channels/chan_sip.c: merge 45966 refer_to_domain potentially
	  containing options

	* channels/chan_sip.c: merge 46026 improper checks on get_header()
	  return values

	* channels/chan_sip.c: merge 46045 prevent NULL args to
	  ast_strdupa() in chan_sip.c

2006-10-24 05:23 +0000 [r46093]  Russell Bryant <russell@digium.com>

	* Makefile: Restore the ability to remove the firmware directory
	  without causing the installation to fail (issue #8111)

2006-10-24 03:53 +0000 [r46080-46083]  Kevin P. Fleming <kpfleming@digium.com>

	* main/translate.c: ensure that the translation matrix is properly
	  lock-protected every place it is used

	* include/asterisk/translate.h, main/translate.c: add an API call
	  to allow channel drivers to determine which media formats are
	  compatible (passthrough or transcode) with the format an existing
	  channel is already using

	* doc/imapstorage.txt: simplify and correct voicemail IMAP storage
	  build instructions

2006-10-24 03:01 +0000 [r46078]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* main/channel.c: Pass through a frame if we don't know what it is,
	  rather than trying to pass a NULL, which will segfault a channel
	  driver (Bug 8149)

2006-10-24 01:27 +0000 [r45999-46067]  Russell Bryant <russell@digium.com>

	* utils/muted.c, utils/ael_main.c: In muted.c, check the return
	  value of strdup. In ael_main.c, check the return value of calloc.
	  (issue #8157) In passing fix a few minor bugs in ael_main.c. The
	  last argument to strncpy() was a hard-coded 100, where it should
	  have been 99. I changed this to use sizeof() - 1.

	* apps/app_meetme.c: Fix the descriptions of some of the
	  MeetMeAdmin options (issue #8098, mflorell)

	* res/res_jabber.c: don't crash when an incoming message has no
	  "from" (issue #8205, jmls)

2006-10-23 00:27 +0000 [r45928]  Joshua Colp <jcolp@digium.com>

	* /, cdr/cdr_odbc.c: Merged revisions 45927 via svnmerge from
	  https://origsvn.digium.com/svn/asterisk/branches/1.2 ........
	  r45927 | file | 2006-10-22 20:25:28 -0400 (Sun, 22 Oct 2006) | 2
	  lines Don't leak memory mmmk? ........

2006-10-22 21:44 +0000 [r45916]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c, /: Merged revisions 45808 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r45808 | crichter | 2006-10-21 14:35:13 +0200 (Sat, 21
	  Oct 2006) | 1 line fixed issue, that if chan_misdn is loaded and
	  couldn't be initialized it would cause a segfault after 'reload'.
	  Reported by Drew/Matt thx. ........

2006-10-21 18:49 +0000 [r45818]  Russell Bryant <russell@digium.com>

	* res/res_monitor.c: Add a couple missing unregistrations of
	  manager actions and remove duplicate unregistrations of
	  applications. (issue #8194, jmls)

2006-10-21 18:48 +0000 [r45775-45817]  Joshua Colp <jcolp@digium.com>

	* main/loader.c: Don't use promotion on Darwin because it doesn't
	  seem to work quite right in all cases, this should solve the
	  unresolved symbol issue people have been seeing.

	* Makefile: Pass DESTDIR and ASTSBINDIR so that the utilities get
	  installed in the proper location (reported on asterisk-dev
	  mailing list)

2006-10-20 07:44 +0000 [r45741]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Let's understand SIP: - REFER can create
	  dialog, Asterisk does not support it yet - NOTIFY can create
	  dialog in Asterisk's implementation (voicemail) even though we
	  don't support the server side of it. In this case, the standard
	  is a side issue ;-) - Added extened functionality for unsupported
	  methods (PING, PUBLISH) so we don't create PVT's for those
	  either. Russellb needs to judge what to do with this in 1.2, but
	  I think the current implementation n 1.2 is a bug since we're
	  sending bad replies to NOTIFY and REFER outside of dialogs

2006-10-19 17:24 +0000 [r45678-45694]  Joshua Colp <jcolp@digium.com>

	* res/res_jabber.c: Let's remember to unregister JabberStatus too
	  (issue #8184 reported by jmls)

	* /, apps/app_externalivr.c: Merged revisions 45691 via svnmerge
	  from https://origsvn.digium.com/svn/asterisk/branches/1.2
	  ........ r45691 | file | 2006-10-19 13:16:37 -0400 (Thu, 19 Oct
	  2006) | 2 lines Respect language selection when seeing if the
	  file exists (issue #8178 reported by mnicholson) ........

	* channels/chan_sip.c: If the jitterbuffer is forced on then we
	  can't partially bridge (reported by wangster on #asterisk-dev)

2006-10-19 00:59 +0000 [r45622]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Don't leak the actual thread-specific
	  sip_pvt struct

2006-10-18 23:49 +0000 [r45621]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_sip.c: don't leak memory when a chan_sip thread is
	  destroyed that has a thread-local temp_pvt allocated

2006-10-18 21:03 +0000 [r45595]  Joshua Colp <jcolp@digium.com>

	* main/asterisk.c: Don't modify things if we are using vfork as
	  this is very bad and may cause unexpected behavior (issue #7970
	  reported by Nick Gavrikov)

2006-10-18 11:54 +0000 [r45517]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: remove duplicate declarations

2006-10-18 04:09 +0000 [r45464]  Luigi Rizzo <rizzo@icir.org>

	* main/http.c: merge from trunk: move ast_variables_destroy() to a
	  better place in handle_uri() to avoid leaking memory on non
	  existing files.

2006-10-18 03:02 +0000 [r45452]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Don't segfault if you're using a channel driver that
	  doesn't turn RTCP on

2006-10-18 02:41 +0000 [r45439-45441]  Russell Bryant <russell@digium.com>

	* main/channel.c: Don't attempt to access private data members of
	  the pthread_mutex_t object, because this does not work on all
	  linux systems. Instead, just access the reentrancy field in the
	  ast_mutex_info struct when DEBUG_THREADS is enabled. If
	  DEBUG_CHANNEL_LOCKS is enabled, the developer probably has
	  DEBUG_THREADS on as well. (issue #8139, me)

	* configs/sip_notify.conf.sample: update entry to reboot a snom
	  phone (issue #7850, pnlarsson)

2006-10-17  Kevin P. Fleming  <kpfleming@digium.com>

	* Asterisk 1.4.0-beta3 released.

2006-10-17 22:31 +0000 [r45408-45410]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/stringfields.h, main/ast_expr2.c,
	  main/channel.c, channels/chan_sip.c, channels/chan_iax2.c:
	  optimize the 'quick response' code a bit more... no more malloc()
	  or memset() for each response expand stringfields API a bit to
	  allow reusing the stringfield pool on a structure when needed,
	  and remove some unnecessary code when the structure was being
	  freed

2006-10-17 20:38 +0000 [r45378-45381]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Don't create a "real" pvt structure for
	  requests that shouldn't be able to create one. Instead use a
	  temporary pvt and fill it with enough information so we can send
	  a reply.

2006-10-17 17:39 +0000 [r45329]  Olle Johansson <oej@edvina.net>

	* configs/sip.conf.sample: Adding information about Marks
	  direct-RTP hack to the docs...

2006-10-17 17:22 +0000 [r45327]  Kevin P. Fleming <kpfleming@digium.com>

	* LICENSE: provide licensing language for IAXy firmware file

2006-10-16 20:06 +0000 [r45246-45280]  Joshua Colp <jcolp@digium.com>

	* apps/app_dial.c, apps/app_directed_pickup.c: Backport of new
	  directed pickup (BE-85).

2006-10-16 13:59 +0000 [r45196-45213]  Olle Johansson <oej@edvina.net>

	* CREDITS: Adding Inotel to credits for SIP transfers. Thanks for
	  your support!

	* channels/chan_sip.c: Don't destroy dialog for unexpected REFER
	  response...

2006-10-14 04:38 +0000 [r45143]  Steve Murphy <murf@digium.com>

	* funcs/func_rand.c: update the doc string for both AEL and
	  extensions.conf users.

2006-10-13 23:02 +0000 [r45125]  Kevin P. Fleming <kpfleming@digium.com>

	* main/acl.c don't drop the entire permit/deny list when an attempt
	  is made to add an invalid entry (BE-92)

2006-10-13 21:06 +0000 [r45104-45106]  Joshua Colp <jcolp@digium.com>

	* res/res_speech.c: Clear the quiet flag too since we are
	  restarting a recognition again (reported on -dev by Stephan
	  Edelman)

	* res/res_speech.c: Check return value from engine in case of
	  failure (ie: out of licenses) (reported on -dev mailing list)

2006-10-13 20:52 +0000 [r45103]  Steve Murphy <murf@digium.com>

	* pbx/ael/ael-test/ref.ael-vtest17 (added),
	  pbx/ael/ael-test/ael-vtest17/extensions.ael (added),
	  pbx/ael/ael-test/ael-vtest17 (added),
	  pbx/ael/ael-test/ref.ael-test3, pbx/pbx_ael.c: Bug 8128 fixed in
	  this release via these changes

2006-10-13 19:19 +0000 [r45088]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c: avoiding warning, fixing potential bug

2006-10-13 18:42 +0000 [r45051-45079]  Joshua Colp <jcolp@digium.com>

	* codecs/lpc10/placev.c, codecs/lpc10/irc2pc.c,
	  codecs/lpc10/decode.c, codecs/lpc10/dcbias.c,
	  codecs/lpc10/pitsyn.c, codecs/lpc10/voicin.c,
	  codecs/lpc10/difmag.c, codecs/lpc10/hp100.c,
	  codecs/lpc10/synths.c, codecs/lpc10/preemp.c,
	  codecs/lpc10/rcchk.c, codecs/lpc10/lpfilt.c,
	  codecs/lpc10/mload.c, codecs/lpc10/lpcenc.c,
	  codecs/lpc10/vparms.c, codecs/lpc10/dyptrk.c,
	  codecs/lpc10/lpcini.c, codecs/lpc10/random.c,
	  codecs/lpc10/ham84.c, codecs/lpc10/chanwr.c,
	  codecs/lpc10/placea.c, codecs/lpc10/tbdm.c,
	  codecs/lpc10/analys.c, codecs/lpc10/onset.c,
	  codecs/lpc10/energy.c, codecs/lpc10/deemp.c,
	  codecs/lpc10/lpcdec.c, codecs/lpc10/ivfilt.c,
	  codecs/lpc10/median.c, codecs/lpc10/encode.c,
	  codecs/lpc10/bsynz.c, codecs/lpc10/prepro.c,
	  codecs/lpc10/invert.c: And file said... let the compiler warnings
	  STOP!

	* apps/app_chanspy.c: Turn on volume adjustment if it needs to be on (issue #8136
	  reported by mnicholson)

	* apps/app_playback.c: Move say.conf existence check to do_say
	  function since it is called from multiple places (issue #8144
	  reported by kshumard)

2006-10-13 16:19 +0000 [r45049]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_iax2.c: when sending a call to a peer, use the proper socket if
	  we have multiple bindings (reported on asterisk-dev)

2006-10-13 16:01 +0000 [r45031-45040]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Complete merging in RPID screen changes
	  (issue #8101 reported by hristo, patch by oej in revision 44757)

	* main/dnsmgr.c: Pass the right value to usleep for sleeping, and always add
	  the background refresh item back into the scheduler if enabled
	  since it is deleted during reload. (issue #8142 reported by
	  p_lindheimer)

2006-10-13 15:41 +0000 [r45027]  Kevin P. Fleming <kpfleming@digium.com>

	* configure, include/asterisk/autoconfig.h.in, configure.ac,
	  main/utils.c: use a configure script test for PMTU discovery
	  control instead of just assuming it's available on Linux

2006-10-13 14:45 +0000 [r44994-45026]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/chan_misdn.c: fixed some
	  echocandisable issues when bridged. this caused a kernel panic
	  sometimes.. also some minor formatting fixes

	* channels/misdn/isdn_msg_parser.c: fixed issue that the hangupcause
	  got a wrong isdn cause at RELEASE_COMPLETE

2006-10-12 22:07 +0000 [r44992]  Luigi Rizzo <rizzo@icir.org>

	* channels/chan_sip.c: merge formatting and minor code
	  simplifications from trunk

2006-10-12 20:34 +0000 [r44982]  Matt O'Gorman <mogorman@digium.com>

	* channels/chan_gtalk.c: fix for bug 7764.

2006-10-12 19:14 +0000 [r44956-44971]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_sip.c: we can only send one 'a=ptime' attribute per
	  media session, not one for each format

	* main/netsock.c, include/asterisk/utils.h, channels/chan_sip.c,
	  main/utils.c: ensure that IAX2 and SIP sockets allow UDP
	  fragmentation when running on Linux (thanks to Brian Candler on
	  the asterisk-dev list for the tip)

2006-10-12 16:56 +0000 [r44945]  Russell Bryant <russell@digium.com>

	* main/manager.c: fix a silly typo in a comment that I saw while
	  reading the commit list

2006-10-12 16:08 +0000 [r44942]  Joshua Colp <jcolp@digium.com>

	* Makefile: Pass off AUDIO_LIBS so muted can link on OSX (issue
	  #8135 reported by ssokol)

2006-10-12 12:55 +0000 [r44921]  Nadi Sarrar <ns@beronet.com>

	* main/manager.c: append_event must be called while holding the
	  session lock

2006-10-12 10:24 +0000 [r44911]  Russell Bryant <russell@digium.com>

	* res/res_jabber.c: change some debug output to use LOG_DEBUG
	  instead of verbose output

2006-10-11 16:57 +0000 [r44888]  Jason Parker <jparker@digium.com>

	* main/db1-ast/Makefile: These are already set by the parent
	  Makefile.. There is no need to have this here (it doesn't
	  actually work anyways).

2006-10-11 09:18 +0000 [r44854]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c: removed warning because of missing
	  prototype declaration

2006-10-10 19:23 +0000 [r44830]  Olle Johansson <oej@edvina.net>

	* channels/chan_sip.c: Do not set default/global values in the
	  variable declaration, set it in reload_config()

2006-10-10 17:21 +0000 [r44819]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Move some stuff around so that a NOTIFY
	  dialog won't hang around until the end of the world under certain
	  circumstances

2006-10-10 16:44 +0000 [r44809]  Paul Cadach <paul@odt.east.telecom.kz>

	* main/channel.c, funcs/func_channel.c, include/asterisk/channel.h:
	  CHANNEL() function sometime mix parameter and value

2006-10-10 16:42 +0000 [r44808]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* funcs/func_logic.c: Lost of a bit of logic when this was
	  simplified between 1.2 and 1.4 (Bug 8117)

2006-10-10 16:30 +0000 [r44806]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Bail out if we have no refer structure and
	  we get a refer response

2006-10-10 16:21 +0000 [r44805]  Luigi Rizzo <rizzo@icir.org>

	* channels/chan_sip.c: more merge from trunk (comments and change a
	  static function name)

2006-10-10 15:23 +0000 [r44788]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Only set DTMF information if an RTP
	  structure exists

2006-10-10 13:50 +0000 [r44786]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/chan_misdn.c: (re)added
	  support of dynamically enabling hdlc on bchannels

2006-10-10 08:25 +0000 [r44776-44777]  Luigi Rizzo <rizzo@icir.org>

	* channels/chan_sip.c: whitespace changes related to previous
	  commit

	* channels/chan_sip.c: merge a few code simplifications that have
	  gone into trunk during last week, to reduce differences between
	  the two branches and make porting fixes easier.

2006-10-09 16:12 +0000 [r44764]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Fix a problem where phones that go
	  "missing" never got unregistered. Issue #8067, reported by pj,
	  patch by Anthony LaMantia (with minor whitespace modifications)

2006-10-09 15:46 +0000 [r44759-44760]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: iaxs[callno] may go away if we try to avoid
	  the deadlock

	* channels/chan_iax2.c: Properly avoid a collision with iax2_hangup
	  (issue #8115 reported by vazir)

2006-10-08 14:14 +0000 [r44746]  Luigi Rizzo <rizzo@icir.org>

	* channels/chan_sip.c: do not dereference p if we
	  know it is NULL

2006-10-07 14:39 +0000 [r44684]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/ast_h323.cxx, channels/chan_h323.c,
	  channels/h323/ast_h323.h, channels/h323/chan_h323.h: Propagate
	  caller's transfer capability too

2006-10-07 11:37 +0000 [r44650-44665]  Luigi Rizzo <rizzo@icir.org>

	* channels/chan_sip.c: put common code in a
	  function to avoid repetitions.

	* channels/chan_sip.c: remove hardwired usage of 5060, use
	  DEFAULT_SIP_PORT instead

	* channels/chan_sip.c: option_debug checking
	  before printing to debug channel.

	* channels/chan_sip.c: backport simplifications on sip_register,
	  usage of ast_set2_flag(), and fixes to the handling of failed
	  module loading.

	* channels/chan_sip.c: improve and document function
	  get_in_brackets(), introducing a helper function
	  find_closing_quote() of more general use.

2006-10-06 21:28 +0000 [r44629-44631]  Kevin P. Fleming <kpfleming@digium.com>

	* include/asterisk/linkedlists.h: ensure that mutex locks inside
	  list heads are initialized properly on platforms that require
	  constructor initialization (issue #8029, patch from timrobbins)

	* CHANGES: remove Jingle as per mog

2006-10-06 21:08 +0000 [r44628]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Remove the seqno check for RFC2833, the handler is
	  smart enough to not need it.

2006-10-06 21:07 +0000 [r44627]  Kevin P. Fleming <kpfleming@digium.com>

	* CHANGES: various cleanups

2006-10-06 18:46 +0000 [r44581-44605]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: When the sequence number rolls over then reset the
	  recorded sequence number for DTMF (issue #8106 reported by
	  bungalow)

	* main/file.c: Even more frames to treat as though the remote side
	  disappeared (issue #8097 reported by eldadran)

2006-10-06 15:59 +0000 [r44567]  Luigi Rizzo <rizzo@icir.org>

	* main/manager.c, main/http.c: make sure sockets are blocking when
	  they should be blocking.

2006-10-06 12:53 +0000 [r44559-44563]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c: fixed segfault which happens during
	  hold/transfer action

	* channels/chan_misdn.c: if INFORMATION Message come with keypad
	  instead of called party number, we just use the keypad as called
	  party number.

	* channels/misdn/isdn_lib.c, channels/misdn_config.c,
	  channels/misdn/isdn_lib.h, channels/chan_misdn.c,
	  channels/misdn/chan_misdn_config.h, configs/misdn.conf.sample:
	  added the option 'reject_cause' to make it possible to set
	  the RELEASE_COMPLETE - cause on the 3. incoming PMP channel,
	  which is automatically rejected because chan_misdn does not
	  support that kind of callwaiting. Therefore chan_misdn supports
	  now 3 incoming channels on a PMP BRI Port. misdn_lib_get_free_bc
	  now gets the info if the requested channel is incoming or
	  outgoing to make the 3. channel possible

	* channels/misdn/isdn_lib.c, channels/misdn/isdn_lib.h,
	  channels/chan_misdn.c: fixed the hold/retrieve/transfer issues,
	  removed a useless bc field, added setting of frame.delivery fields,
	  some minor code cleanups

2006-10-05 19:57 +0000 [r44502]  Joshua Colp <jcolp@digium.com>

	* main/file.c: Treat busy control frames as hangup in the file streaming
	  core (issue #8097 reported by eldadran)

2006-10-05 18:21 +0000 [r44488]  Steve Murphy <murf@digium.com>

	* pbx/pbx_ael.c: This mod fixes a problem pointed out by dgarstang.
	  Many thanks to Doug!

2006-10-05 18:01 +0000 [r44486]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: One more T.38 fix! Don't leave a reinvite
	  hanging by a thread if the other side is already setup with T.38

2006-10-05 16:10 +0000 [r44476]  Kevin P. Fleming <kpfleming@digium.com>

	* main/app.c: don't segfault when an argument without a close
	  parenthesis is found stop parsing as soon as that situation
	  occurs

2006-10-05 15:22 +0000 [r44465-44466]  Steve Murphy <murf@digium.com>

	* CHANGES: I put the accumulated changes from the commit logs and
	  inspection, into CHANGES. Hope everyone approves!

	* configs/muted.conf.sample, utils/muted.c: Hang on a minute, the
	  install process sticks muted.conf in /etc/asterisk, so that's
	  where muted should look for it, right?

2006-10-05 02:40 +0000 [r44450]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Don't totally bail out if T.38 was
	  negotiated

2006-10-05 01:42 +0000 [r44433-44436]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_sip.c: fix Polycom presence notification again

2006-10-04 22:52 +0000 [r44407-44409]  Luigi Rizzo <rizzo@icir.org>

	* utils/Makefile: as far as i can tell astman only uses newt...

	* Makefile: put linker flags in ASTLDFLAGS where they belong

2006-10-04 21:17 +0000 [r44390-44393]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_sip.c: remove workaround for old Polycom firmware SUBSCRIBE
	  requests add workaround for new Polycom firmware SUBSCRIBE
	  requests (bug is known to exist in 2.0.1 firmware)

	* include/asterisk.h, main/utils.c: make LOW_MEMORY builds actually
	  work

2006-10-04 19:57 +0000 [r44380]  Steve Murphy <murf@digium.com>

	* pbx/ael/ael-test/ref.ael-ntest10, pbx/ael/ael.tab.c,
	  pbx/ael/ael-test/ref.ael-test1, pbx/ael/ael-test/ref.ael-ntest12,
	  pbx/ael/ael-test/ref.ael-test2, pbx/ael/ael-test/ref.ael-test3,
	  pbx/pbx_ael.c, pbx/ael/ael-test/ref.ael-test4,
	  pbx/ael/ael-test/ref.ael-test5, pbx/ael/ael-test/ref.ael-test6,
	  pbx/ael/ael-test/ref.ael-test7, pbx/ael/ael-test/ref.ael-test8,
	  pbx/ael/ael-test/ael-test16/extensions.ael (added),
	  pbx/ael/ael-test/ael-test16 (added), pbx/ael/ael.y,
	  pbx/ael/ael-test/ref.ael-test11, pbx/ael/ael-test/ref.ael-test14,
	  pbx/ael/ael-test/ref.ael-test15, pbx/ael/ael-test/ref.ael-ntest9,
	  pbx/ael/ael-test/ref.ael-test16 (added): These changes fix the
	  problems reported in bug 8090

2006-10-04 19:47 +0000 [r44378]  Kevin P. Fleming <kpfleming@digium.com>

	* channels/chan_oss.c, main/cdr.c, channels/chan_phone.c,
	  main/manager.c, pbx/pbx_spool.c, res/res_smdi.c,
	  channels/chan_skinny.c, channels/chan_h323.c, main/http.c,
	  channels/chan_alsa.c, pbx/pbx_dundi.c, apps/app_mixmonitor.c,
	  main/asterisk.c, channels/chan_mgcp.c, main/autoservice.c,
	  include/asterisk/utils.h, main/dnsmgr.c, channels/chan_zap.c,
	  channels/chan_sip.c, apps/app_meetme.c, res/res_snmp.c,
	  main/devicestate.c, main/utils.c, res/res_musiconhold.c,
	  channels/chan_iax2.c, apps/app_queue.c, res/res_jabber.c: update
	  thread creation code a bit reduce standard thread stack size
	  slightly to allow the pthreads library to allocate the stack+data
	  and not overflow a power-of-2 allocation in the kernel and waste
	  memory/address space add a new stack size for 'background'
	  threads (those that don't handle PBX calls) when LOW_MEMORY is
	  defined

2006-10-04 17:04 +0000 [r44337-44365]  Steve Murphy <murf@digium.com>

	* configs/muted.conf.sample: I've been meaning to add some
	  explanation about muted... here it is

	* configs/manager.conf.sample: CLI reverbification update to this
	  config file

	* apps/app_macro.c: In response to bug 7776, a Warning has been
	  added to the doc string for Macro().

2006-10-04 00:25 +0000 [r44322]  Kevin P. Fleming <kpfleming@digium.com>

	* main/asterisk.c, main/loader.c, main/term.c, Makefile,
	  include/asterisk.h: ensure that local include files are always
	  used avoid a duplicate function name (term_init())

2006-10-03 22:35 +0000 [r44312]  Matt O'Gorman <mogorman@digium.com>

	* channels/chan_gtalk.c, res/res_jabber.c: fix issue with dialing
	  client without resource.

2006-10-03 20:18 +0000 [r44298]  Kevin P. Fleming <kpfleming@digium.com>

	* apps/app_queue.c: fix a logic error in my previous fix to the queue
	  reload code

2006-10-03 18:42 +0000 [r44286]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/ast_h323.cxx: Change default presentation indicator
	  to "user provided not screened" if octet 3a missed in
	  CallingPartyNumber IE

2006-10-03 18:35 +0000 [r44284]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Use VideoSupport instead so it is considered
	  a valid XML attribute name. (issue #8075 reported by renemendoza)

2006-10-03 18:30 +0000 [r44283]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/ast_h323.cxx: Fix preparation of type and
	  presentation of calling number

2006-10-03 00:01 +0000 [r44240]  Matt O'Gorman <mogorman@digium.com>

	* doc/jingle.txt, channels/chan_jingle.c (removed),
	  include/asterisk/jabber.h, configs/jingle.conf.sample (removed),
	  res/res_jabber.c: updated res_jabber for even better component
	  support, soon will be jep-0100 compliant. also removed
	  chan_jingle and infromed info from jingle.txt, chan_gtalk still
	  works and should be used in this version.

2006-10-02 20:11 +0000 [r44199-44215]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Change the fd on the I/O context in case it
	  changed during the reload, which is indeed possible. (issue #7943
	  reported by eclubb)

	* contrib/init.d/rc.redhat.asterisk: We should be using $AST_SBIN
	  instead of hardcoding the path for the error message (issue #7942
	  reported by eclubb)

2006-10-02 18:52 +0000 [r44186]  Paul Cadach <paul@odt.east.telecom.kz>

	* configs/users.conf.sample, pbx/pbx_config.c: Missed part of
	  userconf functionality for chan_h323

2006-10-02 17:25 +0000 [r44169]  Joshua Colp <jcolp@digium.com>

	* main/io.c: Shrink when current_ioc is unused. It is set to -1 when
	  unused, not 0. (issue #7941 reported by eclubb)

2006-10-02 17:16 +0000 [r44166-44167]  Paul Cadach <paul@odt.east.telecom.kz>

	* doc/realtime.txt: Typo fix

	* channels/chan_h323.c: Optimization of oh323_indicate(): less
	  locks - less problems, plus single exit point

2006-10-02 02:38 +0000 [r44146]  Mark Spencer <markster@digium.com>

	* channels/chan_sip.c, channels/chan_iax2.c: Don't use Channel when
	  you're not talking about a channel :)

2006-10-01 19:32 +0000 [r44135]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/chan_h323.c: Do not simulate any audio tones if we got
	  PROGRESS message

2006-10-01 18:30 +0000 [r44111-44125]  Russell Bryant <russell@digium.com>

	* Makefile: Fix a problem that cuased AST_DATA_DIR in defaults.h to
	  be empty. The cause is that since ASTDATADIR is explicitly
	  exported using "export ASTDATADIR" at the top of the Makefile,
	  make no longer considers the variable "undefined", so the
	  Makefile can't use ?= to set ASTDATADIR if not yet set. (issue
	  #8063, reported by akohlsmith, fixed by me)

	* configs/queues.conf.sample: Fix the name of the "eventmemberstatus"
	  option in the sample queues.conf (issue #8065, adamg)

2006-10-01 15:01 +0000 [r44109]  Luigi Rizzo <rizzo@icir.org>

	* channels/chan_sip.c: sync with trunk - move variable declarations
	  to the beginning of a block.

2006-09-30 19:20 +0000 [r44090]  Paul Cadach <paul@odt.east.telecom.kz>

	* main/rtp.c: Allow one-way RTP streams (device->Asterisk)

2006-09-30 16:28 +0000 [r44080]  Luigi Rizzo <rizzo@icir.org>

	* codecs/lpc10/Makefile, Makefile, main/Makefile: fix two recent
	  build problems: - with AST_DEVMODE, building codecs/lpc10 fails
	  because of lots of warnings, and the configure step in editline
	  fails as well. Fix this by removing the -Werror in these steps. -
	  on FreeBSD (but probably on other platforms as well), the final
	  link of asterisk fails because AST_LIBS was not exported to the
	  subdirs Makefiles. Add a proper fix in the top-level Makefile (a
	  possible alternative way is to add "export AST_LIBS" near the
	  beginning of the file). With this fix, i believe that some of the
	  platform-specific conditionals in main/Makefile are redundant
	  (because they should be already dealt with in the top level
	  Makefile) but i don't have a platform to check. Merging to head
	  will happen in a moment.

2006-09-30 16:12 +0000 [r44068-44078]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/chan_sip.c: Fix issue #7928 correctly. Next is a comment
	  of previous fix: Issue #7928 - Don't send both 404 and 503. Fix
	  by phsultan with a small fix by me, myself or I. Thanks,
	  Philippe! (This was caused by my changes to the transaction
	  handling)

	* channels/chan_sip.c: Found some buggy SIP clients (phones Planet
	  VIP-153T firmware 1.0, Linksys PAP2 firmware 3.1.9(LSc)) which
	  sends ACK not on OK message only (when remote party answers) but
	  on RINGING message too, so when we send 200 OK message, we get
	  unidentified ACK message (because INVITE acknowledged on RINGING
	  message already), so 200 OK retransmits within its retransmission
	  interval then call gets dropped. If someone else knows how to
	  provide workaround for such cases, please, fix it in correct way.
	  Thanks to ssh from #asteriskru for provide access to his box to
	  study and fix this case.

2006-09-29 22:51 +0000 [r44055-44057]  Kevin P. Fleming <kpfleming@digium.com>

	* agi, utils: ignore temporary files made by the Makefiles during a
	  build

	* codecs/lpc10/Makefile, main/db1-ast/Makefile, agi/Makefile,
	  codecs/Makefile, utils/Makefile, configure,
	  build_tools/embed_modules.xml, codecs/gsm/Makefile, configure.ac,
	  Makefile.moddir_rules, Makefile.rules, codecs/ilbc/Makefile,
	  pbx/Makefile, res/Makefile, channels/Makefile: fix a few build
	  system bugs, and convert Makefiles to be compatible with GNU make
	  3.80

2006-09-29 22:35 +0000 [r44053]  Jason Parker <jparker@digium.com>

	* main/asterisk.c, main/cli.c: Fix a bug with the removal of
	  'atleast' argument to 'core verbose' and 'core debug'. Add that
	  argument back in.

2006-09-29 21:09 +0000 [r44022-44043]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/ast_h323.cxx: Set TON/PRESENTATION information more
	  carefully when no CallingNumber IE available

	* channels/h323/ast_h323.cxx: Fake display name by called number on
	  incoming calls (until passing connected number/connected name is
	  not implemented)

	* channels/h323/ast_h323.cxx: Ported code refers to H.450 - add
	  includes

	* channels/h323/ast_h323.cxx, channels/h323/ast_h323.h: Properly
	  pass TON/PRESENTATION information - original
	  H323Connection::SendSignalSetup() destroys Q.931 fields.

2006-09-29 18:49 +0000 [r44011-44012]  Kevin P. Fleming <kpfleming@digium.com>

	* main/Makefile: yet another place where we were not using the
	  correct CFLAGS by default

	* main/Makefile: missed one conversion to ASTCFLAGS

2006-09-29 18:30 +0000 [r44009]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/ast_h323.cxx, channels/chan_h323.c,
	  channels/h323/ast_h323.h, channels/h323/chan_h323.h: Pass
	  TON/PRESENTATION information too

2006-09-29 18:25 +0000 [r43952-44008]  Kevin P. Fleming <kpfleming@digium.com>

	* main/db1-ast/Makefile, Makefile, codecs/Makefile, utils/Makefile,
	  main/Makefile, codecs/gsm/Makefile, Makefile.moddir_rules,
	  Makefile.rules, pbx/Makefile, channels/Makefile: don't abuse
	  CFLAGS and LDFLAGS for build of Asterisk components, because they
	  are also then used for non-Asterisk components (like menuselect);
	  use our own variables instead

	* configure, configure.ac: support --without-curl in configure
	  script

	* Makefile.rules: another cross-compile fix

	* Makefile: a couple more environment settings that can't leak into
	  the menuselect build

	* main/cli.c: proper fix for ast_group_t change

	* include/asterisk/lock.h: eliminate compiler warning when
	  DEBUG_CHANNEL_LOCKS is enabled and users of this header file
	  don't also include channel.h

2006-09-28 20:11 +0000 [r43944]  Jason Parker <jparker@digium.com>

	* apps/app_queue.c: Fix incorrect argument order for member names,
	  on persisted members. Issue 8047, patch by jmls.

2006-09-28 18:05 +0000 [r43932-43933]  Joshua Colp <jcolp@digium.com>

	* apps/app_playback.c, res/res_monitor.c,
	  include/asterisk/logger.h, channels/chan_misdn.c, res/res_smdi.c,
	  channels/chan_skinny.c, apps/app_rpt.c, channels/chan_mgcp.c,
	  main/udptl.c, main/frame.c, funcs/func_timeout.c,
	  channels/chan_sip.c, apps/app_festival.c,
	  channels/iax2-provision.c, apps/app_alarmreceiver.c,
	  res/res_musiconhold.c, apps/app_followme.c, channels/chan_iax2.c:
	  Put in missing \ns on the end of ast_logs (issue #7936 reported
	  by wojtekka)

2006-09-28 17:35 +0000 [r43919]  Kevin P. Fleming <kpfleming@digium.com>

	* apps/app_queue.c: fix buggy (and overly complex) loop used during reload
	  of app_queue for static member list updating

2006-09-28 17:34 +0000 [r43918]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/ast_h323.cxx: Extend call establishment timeout

2006-09-28 17:31 +0000 [r43913-43915]  Joshua Colp <jcolp@digium.com>

	* channels/chan_iax2.c: Make sure the pvt exists before accessing
	  it again as it may have gone away (issue #7562 reported by Seb7
	  and issue #7939 reported by sorg)

	* main/cli.c: Warning be gone!

2006-09-28 16:41 +0000 [r43899]  BJ Weschke <bweschke@btwtech.com>

	* apps/app_queue.c: app_queue is comparing the device names incorrectly
	  while checking their statuses. It's internal list of interfaces
	  includes the dial string, while the argument passed to this
	  function does not have the dial string (/n for a local channel).
	  This causes it to ignore the device state changes because it
	  thinks it belongs to none of its members. (#8040 reported and
	  patch by tim_ringenbach)

2006-09-28 16:17 +0000 [r43893]  Joshua Colp <jcolp@digium.com>

	*  apps/app_meetme.c: Stop the stream after waitstream returns so that our
	  formats get restored. (issue #7370 reported by kryptolus)

2006-09-28 15:56 +0000 [r43877]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/ast_h323.cxx: Fix compiler warning

2006-09-28 15:29 +0000 [r43864-43873]  BJ Weschke <bweschke@btwtech.com>

	* apps/app_queue.c: Fix race conditioon crash with get_member_status (#7864 -
	  tim_ringenbach reported and patched)

	* apps/app_queue.c: Autopause not working for queue members. (#8042
	  - jmls reported and patch)

2006-09-28 12:58 +0000 [r43861-43862]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/ast_h323.cxx, channels/h323/ast_h323.h: Force
	  remote side to start media on outgoing PROGRESS message

	* include/asterisk/compiler.h: Put attribute tag at correct place

2006-09-28 11:03 +0000 [r43852]  Christian Richter <christian.richter@beronet.com>

	* channels/misdn/isdn_lib.c, channels/misdn/isdn_lib.h,
	  channels/chan_misdn.c: fixed a bug which led to chan_list zombies,
	  when the call could not be properly established in misdn_call.
	  also removed the ACK_HDLC stuff which is not really needed.

2006-09-28 10:51 +0000 [r43843-43846]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/ast_h323.cxx: Do not open transmit channel until
	  TCS is received

	* main/file.c: Don't warn on HOLD/UNHOLD control frames

	* main/file.c: Don't treat unknown control frames as voice

2006-09-27 20:21 +0000 [r43816]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c: Avoid inability to lock directory log message by
	  creating the directory ahead of time. (Issue 7631)

2006-09-27 19:44 +0000 [r43801-43803]  Jason Parker <jparker@digium.com>

	* apps/app_playback.c, main/pbx.c: Fix an issue with PLAYBACKSTATUS
	  not being set under certain circumstances. Fix a minor issue, to
	  make it use the filenames that were parsed, instead of the entire
	  argument string. Fix Background() to return -1 like Playback(),
	  if no args are specified.

2006-09-27 19:10 +0000 [r43783-43798]  Joshua Colp <jcolp@digium.com>

	* main/rtp.c: Compensate for out of order packets better if RFC2833
	  compensation is turned on.

	* channels/chan_iax2.c: Get rid of two functions from a time now
	  past (we THINK these are from pre-recursive lock time) that may
	  be contributing to two open issues on the bug tracker (7562/7939)
	  and that has the potential to just make bad things happen if the
	  timing is right.

2006-09-27 16:55 +0000 [r43779]  Russell Bryant <russell@digium.com>

	* main/channel.c,res/res_features.c: Fix a problem that occurred if
	  a user entered a digit
	  that matched a bridge feature that was configured using multiple
	  digits, and the digit that was pressed timed out in the feature
	  digit timeout period. For example, if blind transfer is
	  configured as '##', and a user presses just '#'. In this
	  situation, the call would lock up and no longer pass any frames.
	  (issue #7977 reported by festr, and issue #7982 reported by
	  michaels and valuable input provided by mneuhauser and kuj. Fixed
	  by me, with testing help and peer review from Joshua Colp). There
	  are a couple of issues involved in this fix: 1) When
	  ast_generic_bridge determines that there has been a timeout, it
	  returned AST_BRIDGE_RETRY. Then, when ast_channel_bridge gets
	  this result, it calls ast_generic_bridge over again with the same
	  timestamp for the next event. This results in an endless loop of
	  nothing until the call is terminated. This is resolved by simply
	  changing ast_generic_bridge to return AST_BRIDGE_COMPLETE when it
	  sees a timeout. 2) I also changed ast_channel_bridge such that if
	  in the process of calculating the time until the next event, it
	  knows a timeout has already occured, to immediately return
	  AST_BRIDGE_COMPLETE instead of attempting to bridge the channels
	  anyway. 3) In the process of testing the previous two changes, I
	  ran into a problem in res_features where ast_channel_bridge would
	  return because it determined that there was a timeout. However,
	  ast_bridge_call in res_features would then determine by its own
	  calculation that there was still 1 ms before the timeout really
	  occurs. It would then proceed, and since the bridge broke out and
	  did *not* return a frame, it interpreted this as the call was
	  over and hung up the channels. The reason for this was because
	  ast_bridge_call in res_features and ast_channel_bridge in
	  channel.c were using different times for their calculations.
	  channel.c uses the start_time on the bridge config, which is the
	  time that the feature digit was recieved. However, res_features
	  had another time, 'start', which was set right before calling
	  ast_channel_bridge. 'start' will always be slightly after
	  start_time in the bridge config, and sometimes enough to round up
	  to one ms. This is fixed by making ast_bridge_call use the same
	  time as ast_channel_bridge for the timeout calculation. ........

2006-09-27 16:24 +0000 [r43775]  Christian Richter <christian.richter@beronet.com>

	* channels/chan_misdn.c, channels/Makefile: removed the chan_misdn
	  versioning, since Asterisk has it's own

2006-09-27 16:23 +0000 [r43774]  Joshua Colp <jcolp@digium.com>

	* channels/chan_sip.c: Make rfc2833compensate a global option.

2006-09-27 04:35 +0000 [r43756]  Russell Bryant <russell@digium.com>

	* apps/app_voicemail.c: Backport revision 43754 from the trunk,
	  which removes an unused buffer from mm_login to close bug 8038,
	  as well as addresses some formatting and coding guidelines issues
	  in passing. Originally, I did not commit this to 1.4 since it is
	  not necessarily fixing a bug. However, since the IMAP storage
	  code is brand new, I decided it would be better to make the
	  change here as well, in case someone has to work on this code to
	  address issues in the very near future. I don't want to make
	  unnecessary merge problems going to the trunk.

2006-09-27 02:32 +0000 [r43739]  Steve Murphy <murf@digium.com>

	* configs/extensions.ael.sample: This change to extensions.ael was
	  to fix bug 8031; the install scripts are causing it to be copied
	  to /etc/asterisk/extensions.ael, and because it is a fairly
	  direct conversion of the original extensions.conf, the macro and
	  context names clash with the existing extensions.conf. So, I put
	  an ael- in front of all macros and contexts, and checked every
	  goto and macro call. Also, this file compiles under aelparse.

2006-09-26 20:56 +0000 [r43710]  Russell Bryant <russell@digium.com>

	* main/asterisk.c: Back in revision 4798, this message was changed from
	  using ast_cli() to directly calling write(). During this change,
	  checking if this was a remote console was removed. This caused
	  this message about using "exit" or "quit" to exit an Asterisk
	  console to come up in times where it did not make sense. This
	  change restores the check to see if this is a remote console
	  before printing the message. (fixes BE-65)

2006-09-26 20:47 +0000 [r43707]  Joshua Colp <jcolp@digium.com>

	* .cleancount, main/cli.c, channels/chan_sip.c,
	  include/asterisk/channel.h: Use proper type to represent the group variable
	  (issue #8025 reported by makoto)

2006-09-26 20:30 +0000 [r43700-43703]  Russell Bryant <russell@digium.com>

	* channels/chan_sip.c: Add missing newline character in the warning
	  message about deprecated TOS values in configuration.

	* apps/app_voicemail.c: When parsing the sections of voicemail.conf that contain
	  mailbox definitions, don't introduce a length limit on the
	  definition by using a 256 byte temporary storage buffer. Instead,
	  make the temporary buffer just as big as it needs to be to hold
	  the entire mailbox definition. (fixes BE-68)

2006-09-26 20:19 +0000 [r43695-43697]  Joshua Colp <jcolp@digium.com>

	* channels/chan_local.c: Strip options off the argument passed for
	  devicestate in chan_local. (issue #8034 reported by pcardozo)

	* apps/app_chanspy.c, main/channel.c, main/slinfactory.c: Slight
	  overhaul of the whisper support. 1. We need to duplicate the
	  frame from ast_translate 2. We need to ensure we always have
	  signed linear coming in for signed linear combining. 3. We need
	  to ensure we are always feeding signed linear out. 4. Properly
	  store and restore write format when beeping on the channel we are
	  whispering on. 5. Properly discontinue the stream on the channel
	  for the beep. (issue #8019 reported by timkelly1980)

2006-09-26 18:34 +0000 [r43676]  Kevin P. Fleming <kpfleming@digium.com>

	* sounds/Makefile: update to use 1.4.3 core sounds, with corrected
	  beep/beeperr/tt-monkeys files

2006-09-26 18:08 +0000 [r43650-43674]  Jason Parker <jparker@digium.com>

	* doc/rtp-packetization.txt, main/frame.c: Issue #8015, patch by
	  Dan Austin. Maximum values were incorrect, which is why this is
	  being put in 1.4

	* channels/chan_skinny.c: Add proper codec support to chan_skinny.
	  Works with at least ulaw, alaw, and g729a. This is technically a
	  "new feature", but there are justifications for it. I found a bug
	  with the recent rtp packetization changes, which caused the media
	  setup to fail under certain circumstances, particularly when
	  using allow=all, or having no allow= statements (globally or on
	  the device). I could have either removed the rtp packetization
	  features, or I could add proper codec support (which, without, I
	  think most people would consider to be a bug anyways).

2006-09-25 22:07 +0000 [r43640-43642]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_voicemail.c: Should have moved these lines up in the
	  merge, instead of removing them

	* apps/app_voicemail.c: Two bugs when forwarding voicemail (Issue 7824): 1)
	  delete=yes was ignored 2) maxmessages was ignored

2006-09-25 21:26 +0000 [r43626-43635]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/cisco-h225.cxx, channels/h323/cisco-h225.h,
	  channels/h323/cisco-h225.asn: Fix ASN1 description of
	  non-standard Cisco extensions

	* channels/h323/ast_h323.cxx, channels/chan_h323.c: Backport
	  changes of trunk: 1) r43540: Avoid possible deadlock on channel
	  destruction 2) r43590: Disable fastStart if requested by remote
	  side

2006-09-25 15:23 +0000 [r43616]  Jason Parker <jparker@digium.com>

	* sounds/Makefile: One more fix for sounds installation - this time
	  for portability. Reported to asterisk-dev mailing list.

2006-09-25 14:52 +0000 [r43605]  Steve Murphy <murf@digium.com>

	* formats/format_ogg_vorbis.c: This tiny fix prevents asterisk from
	  crashing if trying to play an OGG moh file.

2006-09-25 06:15 +0000 [r43582]  Paul Cadach <paul@odt.east.telecom.kz>

	* channels/h323/caps_h323.cxx, channels/h323/compat_h323.h,
	  channels/chan_h323.c: Merged revisions 43472,43495 from trunk

2006-09-24 14:58 +0000 [r43553-43564]  Russell Bryant <russell@digium.com>

	* channels/iax2-provision.c: Fix a CLI command registration issue
	  where an erroneous message claiming that "iax2 show provisioning"
	  was already registered. This was because this command was
	  registering itself as both the command, as well as the command it
	  is deprecating. (issue #8022, reported by bjweeks, fixed by
	  myself)

	* channels/chan_iax2.c:Check to see if the channel that is activating the
	  IAXPEER function is actually an IAX2 channel before proceeding to
	  process it to avoid crashing. (issue #8017, reported by admott,
	  fixed by myself)

2006-09-22 23:44 +0000 [r43524]  Kevin P. Fleming <kpfleming@digium.com>

	* Makefile: don't output the 'build complete' message when the
	  target being run is already going to do an installation

2006-09-22 22:12 +0000 [r43518]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: Allow chan_skinny.so to be unloaded
	  properly. Remove reload support, since it doesn't
	  actually...work.

2006-09-22 21:36 +0000 [r43505-43508]  Steve Murphy <murf@digium.com>

	* pbx/pbx_ael.c: This commits a change to return
	  MODULE_LOAD_FAILURE on error, and SUCCESS (instead of 0) when all
	  goes well for bug 8004

	* pbx/pbx_ael.c: If the extensions.ael file not found, or
	  unreadable, we return AST_MODULE_LOAD_DECLINE, as per bug # 8004.

2006-09-22 17:25 +0000 [r43492]  Jason Parker <jparker@digium.com>

	* main/cli.c: Make sure we explicitly set the CLI command to not be
	  deprecated, if it isn't.

2006-09-22 16:42 +0000 [r43486-43489]  Kevin P. Fleming <kpfleming@digium.com>

	* sounds/Makefile: use rebuilt extra sounds

	* main/channel.c: all the Linux systems I have don't use
	  '__m_count' for this field, so I don't know where this came
	  from...

2006-09-22 15:47 +0000 [r43477-43484]  Russell Bryant <russell@digium.com>

	* include/asterisk/threadstorage.h: backport the compatability fix
	  to use attribute_malloc instaed of __attribute__ ((malloc))

	* channels/chan_misdn.c: return AST_MODULE_LOAD_DECLIDE if mISDN
	  could not be configured (issue #8006, Mithraen)

	* main/frame.c: Suppress a compiler warning about the use of a
	  potentially uninitialized variable. It couldn't actually happen,
	  though.

2006-09-22 03:01 +0000 [r43469]  Jason Parker <jparker@digium.com>

	* channels/chan_skinny.c: First shot at unload_module in
	  chan_skinny.. More to come.

2006-09-21 23:50 +0000 [r43466]  Matt O'Gorman <mogorman@digium.com>

	* include/asterisk/jabber.h, channels/chan_gtalk.c,
	  res/res_jabber.c: updates for better compontent support

2006-09-21 23:24 +0000 [r43464]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* res/res_odbc.c, configs/res_odbc.conf.sample: Twould help if we
	  actually documented how the new features in res_odbc actually
	  work. (Oops)

2006-09-21 22:21 +0000 [r43454-43456]  Joshua Colp <jcolp@digium.com>

	* channels/chan_oss.c: Some more clean up in the load function for
	  chan_oss (issue #8002 reported by Mithraen with minor mods by
	  moi)

	* channels/chan_mgcp.c: Clean up chan_mgcp's module load function
	  (issue #8001 reported by Mithraen with mods by moi)

2006-09-21 21:21 +0000 [r43450]  Kevin P. Fleming <kpfleming@digium.com>

	* main/Makefile, build_tools/strip_nonapi (added): add another
	  attempt to strip non-API symbols from the final binary... script
	  will need to be extended to work on non-Linux systems

2006-09-21 20:22 +0000 [r43410-43445]  Tilghman Lesher <tilghman@mail.jeffandtilghman.com>

	* apps/app_url.c: Fix documentation to reflect how Url() really
	  works

	* cdr/cdr_tds.c, configure, configure.ac: TDS 0.64 updates

2006-09-21  Kevin P. Fleming  <kpfleming@digium.com>

	* Asterisk 1.4.0-beta2 released.

2006-09-21 16:08 +0000 [r43404-43405]  Kevin P. Fleming <kpfleming@digium.com>

	* main/Makefile: remove this change... it requires binutils 2.17

2006-09-20 23:19 +0000 [r43396]  Jason Parker <jparker@digium.com>

	* build_tools/make_version: fix minor typo in the way version is
	  handled

2006-09-20  Kevin P. Fleming  <kpfleming@digium.com>

	* Asterisk 1.4.0-beta1 released.
